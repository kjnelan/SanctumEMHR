import{u as f,r as n,j as e,N as u,t as l}from"./index-BekmzJbY.js";import{h as p,i as g}from"./PortalService-CisPuOln.js";function v(){const r=f(),[s,m]=n.useState(null),[i,d]=n.useState(!0);return n.useEffect(()=>{async function c(){try{if(!localStorage.getItem("portalClient")){r("/mycare/login");return}const a=await p();a&&a.id?m({id:a.id,firstName:a.firstName,lastName:a.lastName,fullName:a.fullName,email:a.email,phone:a.phone,dateOfBirth:a.dateOfBirth,providerName:a.providerName,forcePasswordChange:a.forcePasswordChange,initials:(a.firstName?.[0]||"")+(a.lastName?.[0]||"")}):(localStorage.removeItem("portalClient"),r("/mycare/login"))}catch(t){console.log("Portal session check failed:",t.message),localStorage.removeItem("portalClient"),r("/mycare/login")}finally{d(!1)}}c()},[]),{client:s,loading:i}}function j({children:r}){const{client:s,loading:m}=v(),[i,d]=n.useState(0),c=n.useRef(!1);if(m)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-mental",children:e.jsxs("div",{className:"sanctum-glass-main p-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 mx-auto",style:{border:"3px solid rgba(107, 154, 196, 0.3)",borderTopColor:"rgba(107, 154, 196, 0.9)"}}),e.jsx("p",{className:"text-label mt-4 text-center",children:"Loading..."})]})});if(!s)return null;if(s.forcePasswordChange)return e.jsx(u,{to:"/mycare/change-password",replace:!0});const t=window.location.hash?.replace("#/mycare/","")||"dashboard";return n.useEffect(()=>{if(c.current)return;c.current=!0;const a=async()=>{try{const o=await fetch("/custom/api/portal/messages/get_unread_count.php",{credentials:"include"});if(o.ok){const x=await o.json();x.success&&d(x.unreadCount||0)}}catch(o){console.error("Failed to fetch unread count:",o)}};a();const h=setInterval(a,3e4);return()=>clearInterval(h)},[]),e.jsxs("div",{className:"min-h-screen bg-gradient-mental",children:[e.jsx("nav",{className:"sticky top-0 z-50 px-4 py-3",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs("div",{className:"sanctum-glass-main px-6 py-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[l.logoUrl?e.jsx("img",{src:l.logoUrl,alt:l.companyName,className:"h-8 w-auto"}):e.jsx("span",{className:"text-xl font-bold text-gray-800",children:l.logoText}),e.jsx("span",{className:"text-sm font-semibold text-gray-500",children:"Client Portal"})]}),e.jsxs("div",{className:"hidden md:flex items-center gap-1",children:[e.jsx("a",{href:"#/mycare/dashboard",className:t==="dashboard"?"nav-main-active":"nav-main-inactive",children:"Dashboard"}),e.jsx("a",{href:"#/mycare/appointments",className:t==="appointments"?"nav-main-active":"nav-main-inactive",children:"Appointments"}),e.jsxs("a",{href:"#/mycare/messages",className:`relative ${t==="messages"?"nav-main-active":"nav-main-inactive"}`,children:["Messages",i>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center",children:i>99?"99+":i})]}),e.jsx("a",{href:"#/mycare/profile",className:t==="profile"?"nav-main-active":"nav-main-inactive",children:"My Profile"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-right hidden sm:block",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-800",children:s.fullName}),s.providerName&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Provider: ",s.providerName]})]}),e.jsx("div",{className:"w-9 h-9 rounded-full bg-gradient-to-br from-blue-400 to-blue-600 flex items-center justify-center text-white text-sm font-bold",children:s.initials}),e.jsx("button",{onClick:g,className:"text-sm text-gray-600 hover:text-gray-800 font-medium",children:"Sign Out"})]})]}),e.jsxs("div",{className:"flex md:hidden items-center gap-1 mt-3 pt-3 border-t border-white/30",children:[e.jsx("a",{href:"#/mycare/dashboard",className:`flex-1 text-center text-sm py-2 rounded-lg font-semibold ${t==="dashboard"?"nav-main-active":"nav-main-inactive"}`,children:"Dashboard"}),e.jsx("a",{href:"#/mycare/appointments",className:`flex-1 text-center text-sm py-2 rounded-lg font-semibold ${t==="appointments"?"nav-main-active":"nav-main-inactive"}`,children:"Appointments"}),e.jsx("a",{href:"#/mycare/messages",className:`flex-1 text-center text-sm py-2 rounded-lg font-semibold ${t==="messages"?"nav-main-active":"nav-main-inactive"}`,children:"Messages"}),e.jsx("a",{href:"#/mycare/profile",className:`flex-1 text-center text-sm py-2 rounded-lg font-semibold ${t==="profile"?"nav-main-active":"nav-main-inactive"}`,children:"Profile"})]})]})})}),e.jsx("main",{className:"max-w-6xl mx-auto px-4 py-6",children:r}),e.jsx("footer",{className:"text-center py-6",children:e.jsxs("p",{className:"text-gray-500 text-xs",children:["Â© ",new Date().getFullYear()," ",l.companyName,". All rights reserved."]})})]})}export{j as P,v as u};
