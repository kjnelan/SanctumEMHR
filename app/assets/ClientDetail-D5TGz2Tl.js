import{c as Oe,u as _e,j as e,r as x,E as ne,F as X,R as ie,S as Ce,P as le,g as ke,a as Se,b as re,d as ue,e as Me,f as ze,s as Be,h as Z,i as De,k as $e,l as We,m as qe,n as Pe,o as Ue,p as He,A as Ge,q as Ve}from"./index-CtrGWXat.js";import{M as me,E as ce,G as Ye,a as de}from"./ErrorInline-BSH7uwlG.js";import{R as Je}from"./index-BHHrUtzw.js";const Xe=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Qe=Oe("chevron-down",Xe);function Ke({client:s}){const o=_e();if(!s)return null;const d=m=>{if(!m)return"bg-gray-500 text-white";const l=m.toLowerCase();return l==="active"?"bg-green-500 text-white":l==="inactive"?"bg-yellow-500 text-white":"bg-gray-500 text-white"},i=m=>m?m.charAt(0).toUpperCase()+m.slice(1).toLowerCase():"Unknown",t=m=>m?`${m} years old`:"",u=m=>{if(!m)return"";const[l,c,b]=m.split("-");return new Date(l,c-1,b).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},a=m=>{if(!m)return"";const[l,c,b]=m.split("-");return new Date(l,c-1,b).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})};return e.jsx("div",{className:"card-main mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>o("/dashboard"),className:"flex items-center gap-2 px-3 py-2 bg-white/60 hover:bg-white/80 text-gray-700 rounded-lg transition-colors font-medium border border-gray-200",title:"Back to Dashboard",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),e.jsx("span",{children:"Back"})]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-800",children:[s.fname," ",s.mname&&s.mname+" ",s.lname]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-gray-600",children:[e.jsx("span",{children:t(s.age)}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:["DOB: ",u(s.DOB)]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:["ID: ",s.pid]}),s.client_since&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:["Client Since: ",a(s.client_since)]})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[s.protection_indicator_code==="YES"&&e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx("svg",{className:"w-5 h-5 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsx("span",{className:"text-sm font-semibold text-red-800",children:"Risk Factors Documented"})]}),e.jsx("span",{className:`px-4 py-2 rounded-full text-sm font-medium ${d(s.care_team_status)}`,children:i(s.care_team_status)})]})]})})}function Ze({activeTab:s,onTabChange:o,permissions:d={}}){const i=[{id:"summary",label:"Summary",requiresPermission:null},{id:"demographics",label:"Demographics",requiresPermission:null},{id:"insurance",label:"Insurance",requiresPermission:null},{id:"encounters",label:"Sessions",requiresPermission:null,hideForSocialWorker:!0},{id:"clinical",label:"Notes",requiresPermission:"canAccessNotes"},{id:"documents",label:"Documents",requiresPermission:null},{id:"billing",label:"Billing",requiresPermission:null,adminOnly:!0},{id:"admin",label:"Admin Notes",requiresPermission:null}],t=d.canViewClinicalNotes||d.canCreateCaseNotes,u=i.filter(a=>a.adminOnly&&!d.isAdmin||a.hideForSocialWorker&&d.isSocialWorker&&!d.isAdmin?!1:a.requiresPermission==="canAccessNotes"?t:a.requiresPermission?d[a.requiresPermission]!==!1:!0);return e.jsx("div",{className:"tab-nav mb-6",children:e.jsx("div",{className:"flex gap-2",children:u.map(a=>e.jsx("button",{onClick:()=>o(a.id),className:s===a.id?"nav-tab-active":"nav-tab-inactive",children:a.label},a.id))})})}const ge={primary_clinician:"Primary Clinician",clinician:"Clinician",social_worker:"Social Worker",supervisor:"Supervisor",intern:"Intern"},Ne={primary_clinician:"bg-blue-100 text-blue-700",clinician:"bg-green-100 text-green-700",social_worker:"bg-purple-100 text-purple-700",supervisor:"bg-orange-100 text-orange-700",intern:"bg-gray-100 text-gray-700"};function es({clientId:s,isAdmin:o,providers:d=[]}){const[i,t]=x.useState([]),[u,a]=x.useState(!0),[m,l]=x.useState(null),[c,b]=x.useState(!1),[g,n]=x.useState({provider_id:"",role:"clinician",notes:""}),[p,r]=x.useState(!1);x.useEffect(()=>{s&&v()},[s]);const v=async()=>{try{a(!0);const h=await fetch(`/custom/api/client_providers.php?client_id=${s}`,{credentials:"include"});if(!h.ok)throw new Error("Failed to load assigned providers");const y=await h.json();t(y.providers||[])}catch(h){console.error("Failed to load assigned providers:",h),l(h.message)}finally{a(!1)}},N=async()=>{if(!g.provider_id){l("Please select a provider");return}try{r(!0),l(null);const h=await fetch("/custom/api/client_providers.php",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"add",client_id:s,provider_id:parseInt(g.provider_id),role:g.role,notes:g.notes||null})}),y=await h.json();if(!h.ok||!y.success)throw new Error(y.error||"Failed to add provider");await v(),b(!1),n({provider_id:"",role:"clinician",notes:""})}catch(h){l(h.message)}finally{r(!1)}},f=async(h,y)=>{if(confirm(`Remove ${y} from this client's care team?`))try{const R=await fetch("/custom/api/client_providers.php",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"remove",assignment_id:h})}),j=await R.json();if(!R.ok||!j.success)throw new Error(j.error||"Failed to remove provider");await v()}catch(R){l(R.message)}},_=async(h,y)=>{try{const R=await fetch("/custom/api/client_providers.php",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"update_role",assignment_id:h,role:y})}),j=await R.json();if(!R.ok||!j.success)throw new Error(j.error||"Failed to update role");await v()}catch(R){l(R.message)}},k=d.filter(h=>!i.some(y=>y.provider_id===h.value));return u?e.jsx("div",{className:"text-gray-500 text-sm",children:"Loading care team..."}):e.jsxs("div",{children:[m&&e.jsx(ne,{className:"mb-4",children:m}),e.jsx("div",{className:"space-y-2",children:i.length===0?e.jsx("div",{className:"text-gray-500 text-sm italic",children:"No providers assigned"}):i.map(h=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-gray-900",children:[h.provider_name,h.credentials&&e.jsxs("span",{className:"text-gray-500 text-sm ml-1",children:[", ",h.credentials]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[o?e.jsx("select",{value:h.role,onChange:y=>_(h.id,y.target.value),className:`text-xs px-2 py-1 rounded-full border-0 cursor-pointer ${Ne[h.role]||"bg-gray-100"}`,children:Object.entries(ge).map(([y,R])=>e.jsx("option",{value:y,children:R},y))}):e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${Ne[h.role]||"bg-gray-100"}`,children:ge[h.role]||h.role}),e.jsxs("span",{className:"text-xs text-gray-500",children:["since ",new Date(h.assigned_at).toLocaleDateString()]})]})]})}),o&&e.jsx("button",{onClick:()=>f(h.id,h.provider_name),className:"text-red-600 hover:text-red-800 text-sm",title:"Remove from care team",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},h.id))}),o&&e.jsxs("button",{onClick:()=>b(!0),className:"mt-3 text-sm text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Provider"]}),e.jsx(me,{isOpen:c,onClose:()=>b(!1),title:"Add Provider to Care Team",size:"md",children:e.jsxs("div",{className:"space-y-4",children:[m&&e.jsx(ne,{children:m}),e.jsxs("div",{children:[e.jsxs(X,{children:["Provider ",e.jsx(ie,{})]}),e.jsxs("select",{value:g.provider_id,onChange:h=>n({...g,provider_id:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select a provider..."}),k.map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))]})]}),e.jsxs("div",{children:[e.jsxs(X,{children:["Role ",e.jsx(ie,{})]}),e.jsx("select",{value:g.role,onChange:h=>n({...g,role:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:Object.entries(ge).map(([h,y])=>e.jsx("option",{value:h,children:y},h))})]}),e.jsxs("div",{children:[e.jsx(X,{children:"Notes (Optional)"}),e.jsx("textarea",{value:g.notes,onChange:h=>n({...g,notes:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:2,placeholder:"Reason for assignment, special instructions, etc."})]}),e.jsxs(me.Footer,{children:[e.jsx(Ce,{onClick:()=>b(!1),disabled:p,children:"Cancel"}),e.jsx(le,{onClick:N,disabled:p||!g.provider_id,children:p?"Adding...":"Add to Care Team"})]})]})})]})}function ss({data:s}){const[o,d]=x.useState([]),[i,t]=x.useState(null);if(x.useEffect(()=>{const r=async()=>{try{const N=await ke();d(N.providers||[])}catch(N){console.error("Failed to load providers:",N)}},v=async()=>{try{const N=Se();t(N)}catch(N){console.error("Failed to load current user:",N)}};r(),v()},[]),!s)return e.jsx("div",{className:"text-gray-700 text-center py-8",children:"Loading client data..."});const{patient:u,upcomingAppointments:a,recentAppointments:m,problems:l,medications:c,encounters:b}=s,g=r=>{if(!r)return"";const[v,N,f]=r.split(/[-T]/);return new Date(v,N-1,f).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},n=r=>{if(!r)return"";const[v,N]=r.split(":"),f=parseInt(v),_=f>=12?"PM":"AM";return`${f%12||12}:${N} ${_}`},p=r=>{if(!r)return"";const v=r.split(/\s{3,}/);return v.length>1?v[1].trim():r.trim()};return e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"flex-1 grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card-main",children:[e.jsx("h2",{className:"card-header",children:"Contact Information"}),e.jsx("div",{className:"bg-white/80 rounded-xl p-4 border border-gray-200",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"field-label",children:"Email:"}),e.jsx("div",{className:"field-value",children:u.email||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"field-label",children:"Cell Phone:"}),e.jsx("div",{className:"field-value",children:u.phone_cell||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"field-label",children:"Home Phone:"}),e.jsx("div",{className:"field-value",children:u.phone_home||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"field-label",children:"Address:"}),e.jsx("div",{className:"field-value",children:u.street&&u.city?e.jsxs(e.Fragment,{children:[u.street,e.jsx("br",{}),u.city,", ",u.state," ",u.postal_code]}):"Not provided"})]}),u.contact_relationship&&e.jsxs("div",{children:[e.jsx("span",{className:"field-label",children:"Emergency Contact:"}),e.jsx("div",{className:"field-value",children:u.contact_relationship})]})]})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card-main",children:[e.jsx("h2",{className:"card-header",children:e.jsx("span",{className:"flex items-center gap-2",children:"ðŸ¥ Diagnosis"})}),l&&l.length>0?e.jsx("div",{className:"space-y-3",children:l.map(r=>e.jsx("div",{className:"card-inner border-l-4 border-blue-400",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-mono text-sm font-semibold text-blue-700 bg-blue-100 px-2 py-0.5 rounded",children:r.diagnosis}),r.enddate&&e.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-0.5 rounded",children:"Retired"})]}),e.jsx("div",{className:"item-title text-gray-800",children:p(r.title)}),e.jsxs("div",{className:"item-tertiary mt-1",children:["Started: ",g(r.begdate),r.enddate&&` â€¢ Ended: ${g(r.enddate)}`]})]})})},r.id))}):e.jsx("div",{className:"empty-state",children:"No active diagnoses recorded"})]}),e.jsxs("div",{className:"card-main",children:[e.jsx("h2",{className:"card-header",children:"Care Team"}),e.jsx(es,{clientId:u.pid,isAdmin:i?.admin,providers:o})]}),e.jsxs("div",{className:"card-main",children:[e.jsx("h2",{className:"card-header",children:e.jsx("span",{className:"flex items-center gap-2",children:"ðŸ’Š Current Medications"})}),c&&c.length>0?e.jsx("div",{className:"space-y-3",children:c.map((r,v)=>e.jsxs("div",{className:"card-inner border-l-4 border-green-400",children:[e.jsx("div",{className:"item-title text-gray-900",children:r.name}),r.dosage&&e.jsxs("div",{className:"item-secondary text-green-700 font-semibold",children:[r.dosage,r.frequency&&` - ${r.frequency}`]}),r.purpose&&e.jsxs("div",{className:"item-tertiary",children:["For: ",r.purpose]}),r.prescriber&&e.jsxs("div",{className:"item-tertiary",children:["Prescribed by: ",r.prescriber]})]},v))}):e.jsx("div",{className:"empty-state",children:"No active medications"})]})]})]}),e.jsxs("div",{className:"w-80 flex-shrink-0 space-y-6",children:[e.jsxs("div",{className:"card-main",children:[e.jsx("h2",{className:"card-header",children:"Appointments"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"section-header",children:"Upcoming"}),a&&a.length>0?e.jsx("div",{className:"space-y-3",children:a.map(r=>e.jsxs("div",{className:"card-inner",children:[e.jsx("div",{className:"appt-date",children:g(r.pc_eventDate)}),e.jsxs("div",{className:"appt-time",children:[n(r.pc_startTime)," - ",n(r.pc_endTime)]}),e.jsx("div",{className:"appt-type",children:r.pc_catname||"Appointment"})]},r.pc_eid))}):e.jsx("div",{className:"text-muted",children:"No upcoming appointments"})]}),e.jsxs("div",{className:"mb-6 pb-6 border-b border-gray-200",children:[e.jsx("h3",{className:"section-header",children:"Recurring"}),e.jsx("div",{className:"text-muted",children:"No recurring appointments"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"section-header",children:"Recent Past"}),m&&m.length>0?e.jsx("div",{className:"space-y-3",children:m.slice(0,6).map(r=>e.jsxs("div",{className:"card-inner",children:[e.jsx("div",{className:"appt-date",children:g(r.pc_eventDate)}),e.jsxs("div",{className:"appt-time",children:[n(r.pc_startTime)," - ",n(r.pc_endTime)]}),e.jsx("div",{className:"appt-type",children:r.pc_catname||"Appointment"})]},r.pc_eid))}):e.jsx("div",{className:"text-muted",children:"No recent appointments"})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsx("h2",{className:"card-header",children:"Portal Access"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsx("p",{className:"alert-header text-gray-700",children:"Portal Status"}),e.jsx("p",{className:"text-caption text-gray-600",children:"Patient Portal Not Enabled. Admin Can Enable Patient Portal."})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("p",{className:"alert-header text-gray-700 mb-2",children:"Credentials"}),e.jsx("button",{className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"+ Create"})]})]})]})]})]})}function as(s=[]){const[o,d]=x.useState({}),[i,t]=x.useState(!0),[u,a]=x.useState(null);return x.useEffect(()=>{(async()=>{if(s.length===0){t(!1);return}try{t(!0),a(null);const l=s.map(async g=>{const n=await fetch(`/custom/api/reference_lists.php?type=${g}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(!n.ok)throw new Error(`Failed to fetch ${g}`);const p=await n.json();return{type:g,items:p.items||[]}}),c=await Promise.all(l),b={};c.forEach(({type:g,items:n})=>{b[g]=n.filter(p=>p.active!==!1).map(p=>({value:p.id,label:p.name,description:p.description}))}),d(b)}catch(l){console.error("Error fetching reference lists:",l),a(l.message)}finally{t(!1)}})()},[JSON.stringify(s)]),{data:o,loading:i,error:u}}function rs({data:s,onDataUpdate:o}){const[d,i]=x.useState(!1),[t,u]=x.useState({}),[a,m]=x.useState(!1),[l,c]=x.useState(null),[b,g]=x.useState({}),[n,p]=x.useState([]),[r,v]=x.useState([]),[N,f]=x.useState(!1),[_,k]=x.useState(null),{data:h,loading:y}=as(["sexual-orientation","gender-identity","marital-status","client-status","ethnicity","race"]);x.useEffect(()=>{!y&&h&&g({...b,sexual_orientation:h["sexual-orientation"]||[],gender_identity:h["gender-identity"]||[],marital_status:h["marital-status"]||[],status:h["client-status"]||[],ethnicity:h.ethnicity||[],race:h.race||[]})},[h,y]),x.useEffect(()=>{const E=async()=>{try{const[M,H,V]=await Promise.all([re("sex"),re("state"),re("payment_type")]);g(C=>({...C,sex:M.options||[],state:H.options||[],payment_type:V.options||[]}))}catch(M){console.error("Failed to load dropdown options:",M)}},z=async()=>{try{const M=await ke();p(M.providers||[])}catch(M){console.error("Failed to load providers:",M)}};E(),z()},[]),x.useEffect(()=>{(async()=>{if(s&&s.patient&&s.patient.age<18)try{const z=await ue(s.patient.pid);v(z.related_persons||[])}catch(z){console.error("Failed to load guardians:",z)}})()},[s]);const R=E=>{if(!E)return"";const[z,M,H]=E.split(/[-T]/);return new Date(z,M-1,H).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})};if(!s)return e.jsx("div",{className:"empty-state",children:"Loading demographic data..."});const{patient:j}=s,J=()=>{u({fname:j.fname||"",mname:j.mname||"",lname:j.lname||"",preferred_name:j.preferred_name||"",DOB:j.DOB||"",sex:j.sex||"",gender_identity:j.gender_identity||"",sexual_orientation:j.sexual_orientation||"",marital_status:j.marital_status||"",ethnicity:j.ethnicity||"",race:j.race||"",ss:j.ss||"",street:j.street||"",street_line_2:j.street_line_2||"",city:j.city||"",state:j.state||"",postal_code:j.postal_code||"",county:j.county||"",contact_relationship:j.contact_relationship||"",phone_contact:j.phone_contact||"",phone_home:j.phone_home||"",phone_cell:j.phone_cell||"",phone_biz:j.phone_biz||"",email:j.email||"",status:j.status||j.care_team_status||"active",payment_type:j.payment_type||"insurance",custom_session_fee:j.custom_session_fee||"",provider_id:j.provider_id||j.providerID||"",allow_patient_portal:j.allow_patient_portal||"",cmsportal_login:j.cmsportal_login||""}),i(!0),c(null)},G=()=>{i(!1),u({}),c(null)},W=(E,z)=>{u(M=>({...M,[E]:z}))},ee=async()=>{m(!0),c(null);try{if(!t.fname||!t.lname)throw new Error("First name and last name are required");if(!t.email)throw new Error("Trusted Email is required");if(t.email&&!t.email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/))throw new Error("Invalid email format");if(!t.phone_cell)throw new Error("Mobile Phone is required");if(!t.status)throw new Error("Client Status is required");if(!t.payment_type)throw new Error("Payment Type is required");await Me(j.pid,t),o&&await o(),i(!1),u({})}catch(E){c(E.message||"Failed to save changes")}finally{m(!1)}},I=()=>{k(null),f(!0)},P=E=>{k(E),f(!0)},T=async E=>{if(window.confirm(`Are you sure you want to remove ${E.first_name} ${E.last_name} as a guardian?`))try{await ze(E.relation_id);const z=await ue(j.pid);v(z.related_persons||[])}catch(z){c(z.message||"Failed to delete guardian")}},L=async E=>{try{await Be({patient_id:j.pid,person_id:_?.id,...E});const z=await ue(j.pid);v(z.related_persons||[]),f(!1),k(null)}catch(z){throw new Error(z.message||"Failed to save guardian")}},A=(E,z,M,H="text",V=null,C=!1)=>{const O=C?"form-field-label required-field-label":"form-field-label";if(d&&M)return V?e.jsxs("div",{className:"form-field",children:[e.jsxs("div",{className:O,children:[E,C&&e.jsx(ie,{})]}),e.jsx("select",{value:t[M]||"",onChange:F=>W(M,F.target.value),className:"input-md",required:C,children:V.map(F=>e.jsx("option",{value:F.value,children:F.label},F.value))})]}):e.jsxs("div",{className:"form-field",children:[e.jsxs("div",{className:O,children:[E,C&&e.jsx(ie,{})]}),e.jsx("input",{type:H,value:t[M]||"",onChange:F=>W(M,F.target.value),className:"input-md",required:C})]});{let F=z||"";if(V&&z){const D=V.find(Q=>Q.value===z);D&&(F=D.label)}return e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:E}),e.jsx("div",{className:"form-field-value",children:F})]})}};return e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-end mb-4 space-x-2",children:d?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:G,disabled:a,className:"btn-solid btn-solid-gray disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:ee,disabled:a,className:"btn-solid btn-solid-green disabled:opacity-50",children:a?"Saving...":"Save Changes"})]}):e.jsx("button",{onClick:J,className:"btn-solid btn-solid-blue",children:"Edit Demographics"})}),l&&e.jsx("div",{className:"error-message mb-4",children:l}),d&&e.jsx("div",{className:"mb-4 px-4 py-2 bg-purple-50 border-l-4 border-purple-700 rounded",children:e.jsxs("p",{className:"text-sm text-purple-900",children:[e.jsx("span",{className:"required-field-label",children:"*"})," Required fields are marked with an asterisk and displayed in ",e.jsx("span",{className:"required-field-label",children:"purple"})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card-main",children:[e.jsx("h2",{className:"card-header",children:"Personal Information"}),e.jsx("div",{className:"card-inner",children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:d?e.jsxs(e.Fragment,{children:[A("First Name",t.fname,"fname","text",null,!0),A("Middle Name",t.mname,"mname"),A("Last Name",t.lname,"lname","text",null,!0),A("Preferred Name",t.preferred_name,"preferred_name"),A("DOB",t.DOB,"DOB","date"),A("Legal Sex (For billing purposes ONLY)",t.sex,"sex","text",b.sex&&b.sex.length>0?[{value:"",label:"Select..."},...b.sex]:[{value:"",label:"Select..."},{value:"Male",label:"Male"},{value:"Female",label:"Female"}]),A("Gender Identity",t.gender_identity,"gender_identity","text",b.gender_identity&&b.gender_identity.length>0?[{value:"",label:"Select..."},...b.gender_identity]:null),A("Sexual Orientation",t.sexual_orientation,"sexual_orientation","text",b.sexual_orientation&&b.sexual_orientation.length>0?[{value:"",label:"Select..."},...b.sexual_orientation]:null),A("Marital Status",t.marital_status,"marital_status","text",b.marital_status&&b.marital_status.length>0?[{value:"",label:"Select..."},...b.marital_status]:null),A("Ethnicity",t.ethnicity,"ethnicity","text",b.ethnicity&&b.ethnicity.length>0?[{value:"",label:"Select..."},...b.ethnicity]:null),A("Race",t.race,"race","text",b.race&&b.race.length>0?[{value:"",label:"Select..."},...b.race]:null),e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"S.S."}),e.jsx("input",{type:"text",value:t.ss||"",onChange:E=>W("ss",E.target.value),placeholder:"XXX-XX-XXXX",maxLength:"11",className:"input-md"})]})]}):e.jsxs(e.Fragment,{children:[A("First Name",j.fname),A("Middle Name",j.mname),A("Last Name",j.lname),A("Preferred Name",j.preferred_name),A("DOB",R(j.DOB)),A("Legal Sex (For billing purposes ONLY)",j.sex,null,"text",[{value:"male",label:"Male"},{value:"female",label:"Female"},{value:"other",label:"Other"},{value:"unknown",label:"Unknown"}]),A("Gender Identity",j.gender_identity_text||j.gender_identity),A("Sexual Orientation",j.sexual_orientation_text||j.sexual_orientation),A("Marital Status",j.marital_status_text||j.marital_status),A("Ethnicity",j.ethnicity_text||j.ethnicity),A("Race",j.race_text||j.race),e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"S.S."}),e.jsx("div",{className:"form-field-value",children:j.ss?"***-**-"+j.ss.slice(-4):""})]})]})})})]}),j.age<18&&e.jsxs("div",{className:"card-main",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"card-header",children:"Guardian Information"}),e.jsx("button",{onClick:I,className:"btn-solid btn-solid-green btn-sm",children:"+ Add Guardian"})]}),e.jsx("div",{className:"card-inner",children:r.length===0?e.jsx("div",{className:"empty-state",children:'No guardians added yet. Click "Add Guardian" to add one.'}):e.jsx("div",{className:"space-y-4",children:r.map((E,z)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"item-title",children:[E.first_name," ",E.middle_name," ",E.last_name]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>P(E),className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"Edit"}),e.jsx("button",{onClick:()=>T(E),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Remove"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"field-label",children:"Relationship:"})," ",E.role]}),E.phone&&e.jsxs("div",{children:[e.jsx("span",{className:"field-label",children:"Phone:"})," ",E.phone]}),E.email&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"field-label",children:"Email:"})," ",E.email]}),E.street&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"field-label",children:"Address:"})," ",E.street,E.city&&`, ${E.city}`,E.state&&`, ${E.state}`,E.postal_code&&` ${E.postal_code}`]})]})]},E.id))})})]}),e.jsxs("div",{className:"card-main",children:[e.jsx("h2",{className:"card-header",children:"Contact Information"}),e.jsx("div",{className:"card-inner",children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("div",{className:"col-span-2",children:A("Address",j.street,"street")}),A("Address Line 2",j.street_line_2,"street_line_2"),A("City",j.city,"city"),A("State",j.state,"state","text",b.state&&b.state.length>0?[{value:"",label:"Select..."},...b.state]:null),A("Postal Code",j.postal_code,"postal_code"),A("County",j.county,"county"),A("Emergency Contact",j.contact_relationship,"contact_relationship"),A("Emergency Phone",j.phone_contact,"phone_contact","tel"),A("Home Phone",j.phone_home,"phone_home","tel"),A("Mobile Phone",j.phone_cell,"phone_cell","tel",null,!0),A("Work Phone",j.phone_biz,"phone_biz","tel"),A("Trusted Email",j.email,"email","email",null,!0),!d&&j.additional_addresses&&e.jsxs("div",{className:"col-span-2 form-field",children:[e.jsx("div",{className:"form-field-label",children:"Additional Addresses"}),e.jsx("div",{className:"form-field-value",children:j.additional_addresses})]})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card-main",children:[e.jsx("h2",{className:"card-header",children:"Client Status"}),e.jsx("div",{className:"card-inner",children:d?e.jsxs("div",{className:"space-y-3",children:[A("Client Status",t.status,"status","text",[{value:"",label:"Select..."},{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"discharged",label:"Discharged"},{value:"deceased",label:"Deceased"}],!0),A("Payment Type",t.payment_type,"payment_type","text",[{value:"",label:"Select..."},{value:"insurance",label:"Insurance"},{value:"self-pay",label:"Self-Pay"},{value:"pro-bono",label:"Pro Bono"}],!0),t.payment_type==="self-pay"&&A("Custom Session Fee ($)",t.custom_session_fee,"custom_session_fee","number",null,{step:"0.01",placeholder:"120.00"})]}):e.jsxs("div",{className:"space-y-3",children:[A("Client Status",j.status,null,"text",[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"discharged",label:"Discharged"},{value:"deceased",label:"Deceased"}]),A("Payment Type",j.payment_type,null,"text",[{value:"insurance",label:"Insurance"},{value:"self-pay",label:"Self-Pay"},{value:"pro-bono",label:"Pro Bono"}]),j.payment_type==="self-pay"&&j.custom_session_fee&&e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"Custom Session Fee"}),e.jsxs("div",{className:"form-field-value",children:["$",parseFloat(j.custom_session_fee).toFixed(2)]})]})]})})]}),e.jsxs("div",{className:"card-main",children:[e.jsx("h2",{className:"card-header",children:"Portal Settings"}),e.jsx("div",{className:"card-inner",children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:d?e.jsxs(e.Fragment,{children:[A("Allow Client Portal",t.allow_patient_portal,"allow_patient_portal","text",[{value:"",label:"Select..."},{value:"NO",label:"NO"},{value:"YES",label:"YES"}]),A("CMS Portal Login",t.cmsportal_login,"cmsportal_login")]}):e.jsxs(e.Fragment,{children:[A("Allow Client Portal",j.allow_patient_portal),A("CMS Portal Login",j.cmsportal_login)]})})})]})]})]}),N&&e.jsx(ts,{guardian:_,stateOptions:b.state||[],onSave:L,onCancel:()=>{f(!1),k(null)}})]})}function ts({guardian:s,stateOptions:o,onSave:d,onCancel:i}){const[t,u]=x.useState({first_name:s?.first_name||"",middle_name:s?.middle_name||"",last_name:s?.last_name||"",role:s?.role||"",phone:s?.phone||"",email:s?.email||"",street:s?.street||"",city:s?.city||"",state:s?.state||"",postal_code:s?.postal_code||"",notes:s?.notes||""}),[a,m]=x.useState(null),[l,c]=x.useState(!1),b=(n,p)=>{u(r=>({...r,[n]:p}))},g=async n=>{n.preventDefault(),m(null),c(!0);try{if(!t.first_name||!t.last_name||!t.role)throw new Error("First name, last name, and relationship are required");if(t.email&&!t.email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/))throw new Error("Invalid email format");await d(t)}catch(p){m(p.message)}finally{c(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto m-4",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"card-header text-2xl",children:s?"Edit Guardian":"Add Guardian"}),a&&e.jsx("div",{className:"error-message mb-4",children:a}),e.jsxs("form",{onSubmit:g,children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"form-field",children:[e.jsx("label",{className:"form-field-label",children:"First Name *"}),e.jsx("input",{type:"text",value:t.first_name,onChange:n=>b("first_name",n.target.value),className:"input-md",required:!0})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("label",{className:"form-field-label",children:"Middle Name"}),e.jsx("input",{type:"text",value:t.middle_name,onChange:n=>b("middle_name",n.target.value),className:"input-md"})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("label",{className:"form-field-label",children:"Last Name *"}),e.jsx("input",{type:"text",value:t.last_name,onChange:n=>b("last_name",n.target.value),className:"input-md",required:!0})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("label",{className:"form-field-label",children:"Relationship *"}),e.jsxs("select",{value:t.role,onChange:n=>b("role",n.target.value),className:"input-md",required:!0,children:[e.jsx("option",{value:"",children:"Select..."}),e.jsx("option",{value:"Mother",children:"Mother"}),e.jsx("option",{value:"Father",children:"Father"}),e.jsx("option",{value:"Grandmother",children:"Grandmother"}),e.jsx("option",{value:"Grandfather",children:"Grandfather"}),e.jsx("option",{value:"Aunt",children:"Aunt"}),e.jsx("option",{value:"Uncle",children:"Uncle"}),e.jsx("option",{value:"Foster Parent",children:"Foster Parent"}),e.jsx("option",{value:"Legal Guardian",children:"Legal Guardian"}),e.jsx("option",{value:"Other",children:"Other"})]})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("label",{className:"form-field-label",children:"Phone"}),e.jsx("input",{type:"tel",value:t.phone,onChange:n=>b("phone",n.target.value),className:"input-md"})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("label",{className:"form-field-label",children:"Email"}),e.jsx("input",{type:"email",value:t.email,onChange:n=>b("email",n.target.value),className:"input-md"})]}),e.jsxs("div",{className:"col-span-2 form-field",children:[e.jsx("label",{className:"form-field-label",children:"Street Address"}),e.jsx("input",{type:"text",value:t.street,onChange:n=>b("street",n.target.value),className:"input-md"})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("label",{className:"form-field-label",children:"City"}),e.jsx("input",{type:"text",value:t.city,onChange:n=>b("city",n.target.value),className:"input-md"})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("label",{className:"form-field-label",children:"State"}),e.jsxs("select",{value:t.state,onChange:n=>b("state",n.target.value),className:"input-md",children:[e.jsx("option",{value:"",children:"Select..."}),o.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))]})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("label",{className:"form-field-label",children:"Postal Code"}),e.jsx("input",{type:"text",value:t.postal_code,onChange:n=>b("postal_code",n.target.value),className:"input-md"})]}),e.jsxs("div",{className:"col-span-2 form-field",children:[e.jsx("label",{className:"form-field-label",children:"Notes"}),e.jsx("textarea",{value:t.notes,onChange:n=>b("notes",n.target.value),className:"input-md",rows:"3"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[e.jsx("button",{type:"button",onClick:i,disabled:l,className:"btn-solid btn-solid-gray",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:l,className:"btn-solid btn-solid-green",children:l?"Saving...":"Save Guardian"})]})]})]})})})}async function pe(s){return console.log("NoteService: Creating clinical note:",s),Z("/custom/api/notes/create_note.php",{method:"POST",body:JSON.stringify(s)})}async function ls(s,o={}){console.log("NoteService: Fetching patient notes for ID:",s);const d=new URLSearchParams({patient_id:s});return o.note_type&&d.append("note_type",o.note_type),o.status&&d.append("status",o.status),o.start_date&&d.append("start_date",o.start_date),o.end_date&&d.append("end_date",o.end_date),Z(`/custom/api/notes/get_patient_notes.php?${d.toString()}`)}async function Ae(s,o=!1){console.log("NoteService: Fetching note:",s);const d=o?`note_uuid=${s}`:`note_id=${s}`;return Z(`/custom/api/notes/get_note.php?${d}`)}async function ye(s,o){return console.log("NoteService: Updating note:",s),Z("/custom/api/notes/update_note.php",{method:"POST",body:JSON.stringify({noteId:s,...o})})}async function ns(s){return Z("/custom/api/notes/autosave_note.php",{method:"POST",body:JSON.stringify(s)})}async function Ee(s,o=null){return console.log("NoteService: Signing note:",s),Z("/custom/api/notes/sign_note.php",{method:"POST",body:JSON.stringify({noteId:s,signatureData:o})})}async function is(s){return console.log("NoteService: Deleting note:",s),Z("/custom/api/notes/delete_note.php",{method:"DELETE",body:JSON.stringify({note_id:s})})}async function os(s){console.log("NoteService: Fetching draft:",s);const o=new URLSearchParams;return s.note_id&&o.append("note_id",s.note_id),s.appointment_id&&o.append("appointment_id",s.appointment_id),s.patient_id&&o.append("patient_id",s.patient_id),Z(`/custom/api/notes/get_draft.php?${o.toString()}`)}async function cs(s={}){console.log("NoteService: Fetching interventions");const o=new URLSearchParams;s.tier&&o.append("tier",s.tier),s.modality&&o.append("modality",s.modality),s.include_inactive&&o.append("include_inactive",s.include_inactive);const d=o.toString();return Z(`/custom/api/notes/get_interventions.php${d?"?"+d:""}`)}async function be(s,o={}){console.log("NoteService: Fetching treatment goals for patient:",s);const d=new URLSearchParams({patient_id:s});return o.status&&d.append("status",o.status),o.include_all&&d.append("include_all",o.include_all),Z(`/custom/api/notes/get_treatment_goals.php?${d.toString()}`)}async function ds(s,o="ICD10",d=50){console.log("NoteService: Searching codes:",{searchTerm:s,codeType:o,limit:d});const i=new URLSearchParams({search:s,code_type:o,limit:d.toString()});return Z(`/custom/api/search_codes.php?${i.toString()}`)}async function ms(s,o={}){console.log("NoteService: Fetching patient diagnoses:",{patientId:s,options:o});const d=new URLSearchParams({patient_id:s.toString()});return o.activeAsOf&&d.append("active_as_of",o.activeAsOf),o.includeRetired!==void 0&&d.append("include_retired",o.includeRetired?"1":"0"),Z(`/custom/api/get_patient_diagnoses.php?${d.toString()}`)}async function hs(){return console.log("NoteService: Fetching clinical settings"),Z("/custom/api/notes/get_clinical_settings.php")}function fe({selectedInterventions:s=[],onChange:o,riskPresent:d=!1,showFavorites:i=!0}){const[t,u]=x.useState(!0),[a,m]=x.useState(null),[l,c]=x.useState(null),[b,g]=x.useState({}),[n,p]=x.useState("");x.useEffect(()=>{r()},[]);const r=async()=>{try{u(!0);const y=await cs();c(y),m(null)}catch(y){console.error("Error loading interventions:",y),m(y.message)}finally{u(!1)}},v=y=>{const R=s.includes(y);o(R?s.filter(j=>j!==y):[...s,y])},N=y=>{g(R=>({...R,[y]:!R[y]}))};if(t)return e.jsx("div",{className:"text-gray-600",children:"Loading interventions..."});if(a)return e.jsxs(ce,{children:["Error loading interventions: ",a]});if(!l)return e.jsx("div",{className:"text-gray-600",children:"No interventions available"});const{grouped:f,favorites:_}=l,k=[...f.tier1||[],...f.tier3||[],...f.tier4||[],...Object.values(f.tier2||{}).flat()],h=n?k.filter(y=>y.intervention_name.toLowerCase().includes(n.toLowerCase())):null;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{children:e.jsx("input",{type:"text",value:n,onChange:y=>p(y.target.value),placeholder:"Search interventions...",className:"w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white shadow-sm"})}),n&&h&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-label mb-3",children:["Search Results (",h.length,")"]}),h.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:h.map(y=>e.jsxs("label",{className:"flex items-center gap-2 p-2 rounded-lg hover:bg-blue-50 cursor-pointer transition-colors",children:[e.jsx("input",{type:"checkbox",checked:s.includes(y.intervention_name),onChange:()=>v(y.intervention_name),className:"checkbox"}),e.jsx("span",{className:"text-sm text-gray-800",children:y.intervention_name})]},y.id))}):e.jsxs("div",{className:"text-gray-500 text-sm",children:['No interventions found matching "',n,'"']})]}),!n&&e.jsxs(e.Fragment,{children:[i&&_&&_.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-label mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"â­"}),e.jsx("span",{children:"Your Favorites"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:_.map(y=>e.jsxs("label",{className:"flex items-center gap-2 p-2 rounded-lg hover:bg-blue-50 cursor-pointer transition-colors",children:[e.jsx("input",{type:"checkbox",checked:s.includes(y.intervention_name),onChange:()=>v(y.intervention_name),className:"checkbox"}),e.jsx("span",{className:"text-sm text-gray-800",children:y.intervention_name})]},y.id))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-label mb-3",children:"Core Interventions"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:f.tier1.map(y=>e.jsxs("label",{className:"flex items-center gap-2 p-2 rounded-lg hover:bg-blue-50 cursor-pointer transition-colors",children:[e.jsx("input",{type:"checkbox",checked:s.includes(y.intervention_name),onChange:()=>v(y.intervention_name),className:"checkbox"}),e.jsx("span",{className:"text-sm text-gray-800",children:y.intervention_name})]},y.id))})]}),Object.keys(f.tier2).length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-label mb-3",children:"Modality-Specific Interventions"}),e.jsx("div",{className:"space-y-2",children:Object.entries(f.tier2).map(([y,R])=>e.jsxs("div",{className:"card-inner",children:[e.jsxs("button",{onClick:()=>N(y),className:"w-full flex items-center justify-between p-3 text-left hover:bg-gray-50 rounded-lg transition-colors",children:[e.jsx("span",{className:"font-semibold text-gray-800",children:y}),e.jsx(Qe,{className:`w-5 h-5 text-gray-600 transition-transform ${b[y]?"rotate-180":""}`})]}),b[y]&&e.jsx("div",{className:"px-3 pb-3 grid grid-cols-1 md:grid-cols-2 gap-2",children:R.map(j=>e.jsxs("label",{className:"flex items-center gap-2 p-2 rounded-lg hover:bg-blue-50 cursor-pointer transition-colors",children:[e.jsx("input",{type:"checkbox",checked:s.includes(j.intervention_name),onChange:()=>v(j.intervention_name),className:"checkbox"}),e.jsx("span",{className:"text-sm text-gray-800",children:j.intervention_name})]},j.id))})]},y))})]}),d&&f.tier3.length>0&&e.jsxs("div",{className:"border-2 border-orange-200 rounded-lg p-4 bg-orange-50",children:[e.jsxs("h4",{className:"text-sm font-semibold text-orange-800 mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"âš ï¸"}),e.jsx("span",{children:"Crisis/Risk Interventions"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:f.tier3.map(y=>e.jsxs("label",{className:"flex items-center gap-2 p-2 rounded-lg hover:bg-orange-100 cursor-pointer transition-colors",children:[e.jsx("input",{type:"checkbox",checked:s.includes(y.intervention_name),onChange:()=>v(y.intervention_name),className:"w-4 h-4 text-orange-600 rounded focus:ring-orange-500"}),e.jsx("span",{className:"text-sm text-gray-800",children:y.intervention_name})]},y.id))})]}),f.tier4.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-label mb-3",children:"Administrative/Clinical Process"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:f.tier4.map(y=>e.jsxs("label",{className:"flex items-center gap-2 p-2 rounded-lg hover:bg-blue-50 cursor-pointer transition-colors",children:[e.jsx("input",{type:"checkbox",checked:s.includes(y.intervention_name),onChange:()=>v(y.intervention_name),className:"checkbox"}),e.jsx("span",{className:"text-sm text-gray-800",children:y.intervention_name})]},y.id))})]})]}),s.length>0&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[e.jsxs("div",{className:"text-sm font-semibold text-blue-800 mb-2",children:["Selected (",s.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(y=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:[y,e.jsx("button",{onClick:()=>v(y),className:"hover:text-blue-600 focus:outline-none",title:"Remove",children:"Ã—"})]},y))})]})]})}function ve({patientId:s,serviceDate:o,selectedDiagnoses:d=[],onChange:i}){const[t,u]=x.useState([]),[a,m]=x.useState(!0),[l,c]=x.useState(null);x.useEffect(()=>{s&&b()},[s,o]);const b=async()=>{try{m(!0),c(null);const _=await ms(s,{activeAsOf:o,includeRetired:!1});u(_.diagnoses||[])}catch(_){console.error("Error loading diagnoses:",_),c(_.message)}finally{m(!1)}},g=_=>_?_.length>=4?_.slice(0,3)+"."+_.slice(3):_:"",n=_=>{if(!_)return"";const k=_.split(/\s{3,}/);return k.length>1?k[1].trim():_.trim()},p=_=>d.some(k=>k.code===_||k===_),r=()=>{if(!d||d.length===0)return null;const _=d[0];return typeof _=="string"?_:_.code},v=_=>{const k=_.diagnosis;if(p(k)){const y=d.filter(R=>(typeof R=="string"?R:R.code)!==k);i(y)}else{const y={code:k,description:_.title,isPrimary:d.length===0,billable:!0};i([...d,y])}},N=_=>{const k=d.map(h=>({...typeof h=="string"?{code:h}:h,isPrimary:(typeof h=="string"?h:h.code)===_}));i(k)};if(a)return e.jsx("div",{className:"text-sm text-gray-600 italic",children:"Loading active diagnoses..."});if(l)return e.jsxs(ce,{children:["Error loading diagnoses: ",l]});if(!t||t.length===0)return e.jsx("div",{className:"text-sm text-gray-600 bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:"âš ï¸ No active diagnoses found for this patient. Please create a Diagnosis Note first."});const f=r();return e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Select all diagnoses addressed in this session. The first selected diagnosis will be marked as primary for billing purposes."}),e.jsx("div",{className:"space-y-2",children:t.map(_=>{const k=_.diagnosis,h=p(k),y=k===f;return e.jsx("div",{className:`p-3 rounded-lg border-2 transition-all cursor-pointer ${h?"border-blue-400 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300"}`,onClick:()=>v(_),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{type:"checkbox",checked:h,onChange:()=>v(_),onClick:R=>R.stopPropagation(),className:"mt-1 w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-mono text-sm font-semibold text-blue-700 bg-blue-100 px-2 py-0.5 rounded",children:g(k)}),h&&y&&e.jsx("span",{className:"text-xs font-semibold text-green-700 bg-green-100 px-2 py-0.5 rounded",children:"PRIMARY"}),h&&!y&&e.jsx("button",{onClick:R=>{R.stopPropagation(),N(k)},className:"text-xs text-blue-600 hover:text-blue-800 underline",children:"Set as primary"})]}),e.jsx("div",{className:"text-sm text-gray-800",children:n(_.title)}),_.begdate&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Since: ",new Date(_.begdate).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]})]})]})},_.id)})}),d.length>0&&e.jsxs("div",{className:"text-xs text-gray-600 bg-blue-50 border border-blue-200 rounded-lg p-2 mt-2",children:["â„¹ï¸ ",d.length," diagnosis code",d.length!==1?"s":""," selected for this session"]})]})}function xs({note:s,onChange:o,patientId:d,autoSave:i}){const[t,u]=x.useState([]),[a,m]=x.useState(!0),[l,c]=x.useState(s.riskPresent||!1);x.useEffect(()=>{b()},[d]);const b=async()=>{try{m(!0);const r=await be(d,{status:"active"});u(r.goals||[])}catch(r){console.error("Error loading treatment goals:",r)}finally{m(!1)}},g=(r,v)=>{o(r,v),i&&setTimeout(()=>i(),500)},n=r=>{c(r),g("riskPresent",r)},p=r=>{const v=s.goalsAddressed||[];v.includes(r)?g("goalsAddressed",v.filter(f=>f!==r)):g("goalsAddressed",[...v,r])};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card-main bg-blue-50 border-2 border-blue-300",children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ¥"}),e.jsx("span",{children:"Diagnosis Codes for This Session"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Select all diagnoses addressed in this session. Required for billing and clinical documentation."})]}),e.jsx(ve,{patientId:d,serviceDate:s.date_of_service||new Date().toISOString().split("T")[0],selectedDiagnoses:s.diagnosis_codes||[],onChange:r=>g("diagnosis_codes",r)})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("label",{className:"block",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"font-semibold text-gray-800",children:[e.jsx("span",{className:"text-blue-600 mr-2",children:"B"}),"Behavior / What You Observed"]}),e.jsx("span",{className:"text-xs text-gray-500",children:"Client presentation, affect, mood"})]}),e.jsx("textarea",{value:s.behaviorProblem||"",onChange:r=>g("behaviorProblem",r.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none bg-white shadow-sm",rows:"4",placeholder:"Example: Client presented as anxious with tearful affect. Reported difficulty sleeping and increased worry about work performance..."})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-gray-600 mb-2",children:"Quick Tags (Optional)"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["Engaged","Tearful","Anxious","Flat affect","Guarded","Motivated","Resistant","Calm"].map(r=>{const v=(s.clientPresentation||[]).includes(r);return e.jsx("button",{onClick:()=>{const N=s.clientPresentation||[];v?g("clientPresentation",N.filter(f=>f!==r)):g("clientPresentation",[...N,r])},className:`px-3 py-1 rounded-full text-xs font-medium transition-colors ${v?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:r},r)})})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("span",{className:"font-semibold text-gray-800",children:[e.jsx("span",{className:"text-blue-600 mr-2",children:"I"}),"Intervention / What You Did"]})}),e.jsx("textarea",{value:s.intervention||"",onChange:r=>g("intervention",r.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none bg-white shadow-sm",rows:"4",placeholder:"Narrative description of interventions used... (or use checkboxes below for quick selection)"})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsx("div",{className:"text-label mb-3",children:"Select Interventions Used"}),e.jsx(fe,{selectedInterventions:s.interventionsSelected||[],onChange:r=>g("interventionsSelected",r),riskPresent:l})]})]}),e.jsx("div",{className:"card-main",children:e.jsxs("label",{className:"block",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"font-semibold text-gray-800",children:[e.jsx("span",{className:"text-blue-600 mr-2",children:"R"}),"Response / How Client Responded"]}),e.jsx("span",{className:"text-xs text-gray-500",children:"Client's reaction to interventions"})]}),e.jsx("textarea",{value:s.response||"",onChange:r=>g("response",r.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none bg-white shadow-sm",rows:"4",placeholder:"Example: Client engaged well with cognitive restructuring. Reported feeling less overwhelmed after identifying automatic thoughts. Demonstrated understanding of homework assignment..."})]})}),e.jsxs("div",{className:"card-main",children:[e.jsxs("label",{className:"block mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"font-semibold text-gray-800",children:[e.jsx("span",{className:"text-blue-600 mr-2",children:"P"}),"Plan / What's Next"]}),e.jsx("span",{className:"text-xs text-gray-500",children:"Homework, next steps, follow-up"})]}),e.jsx("textarea",{value:s.plan||"",onChange:r=>g("plan",r.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none bg-white shadow-sm",rows:"4",placeholder:"Example: Continue weekly sessions. Homework: Practice thought records daily. Will reassess anxiety levels next session. May refer to psychiatry if no improvement..."})]}),!a&&t.length>0&&e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsx("div",{className:"text-label mb-3",children:"Treatment Goals Addressed This Session"}),e.jsx("div",{className:"space-y-2",children:t.map(r=>e.jsxs("label",{className:"flex items-start gap-3 p-3 rounded-lg hover:bg-blue-50 cursor-pointer transition-colors",children:[e.jsx("input",{type:"checkbox",checked:(s.goalsAddressed||[]).includes(r.id),onChange:()=>p(r.id),className:"mt-0.5 w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm text-gray-800",children:r.goal_text}),r.goal_category&&e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:r.goal_category})]})]},r.id))})]})]}),e.jsxs("div",{className:"card-main bg-orange-50 border-2 border-orange-300",children:[e.jsxs("label",{className:"flex items-center gap-3 mb-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:l,onChange:r=>n(r.target.checked),className:"w-5 h-5 text-orange-600 rounded focus:ring-orange-500"}),e.jsx("span",{className:"font-semibold text-gray-800",children:"âš ï¸ Risk Present (suicide, homicide, self-harm)"})]}),l&&e.jsx("div",{className:"border-t-2 border-orange-200 pt-3",children:e.jsxs("label",{className:"block",children:[e.jsx("div",{className:"text-sm font-semibold text-orange-800 mb-2",children:"Risk Assessment Details (Required when risk is flagged)"}),e.jsx("textarea",{value:s.riskAssessment||"",onChange:r=>g("riskAssessment",r.target.value),className:"w-full px-4 py-3 border-2 border-orange-400 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 resize-none bg-white shadow-sm",rows:"5",placeholder:"Document risk factors, protective factors, safety plan, level of risk, interventions used, follow-up plan...",required:l})]})})]})]})}function us({note:s,onChange:o,patientId:d,autoSave:i}){const[t,u]=x.useState([]),[a,m]=x.useState(!0),[l,c]=x.useState(s.riskPresent||!1);x.useEffect(()=>{b()},[d]);const b=async()=>{try{m(!0);const r=await be(d,{status:"active"});u(r.goals||[])}catch(r){console.error("Error loading treatment goals:",r)}finally{m(!1)}},g=(r,v)=>{o(r,v),i&&setTimeout(()=>i(),500)},n=r=>{c(r),g("riskPresent",r)},p=r=>{const v=s.goalsAddressed||[];v.includes(r)?g("goalsAddressed",v.filter(f=>f!==r)):g("goalsAddressed",[...v,r])};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card-main bg-blue-50 border-2 border-blue-300",children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ¥"}),e.jsx("span",{children:"Diagnosis Codes for This Session"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Select all diagnoses addressed in this session. Required for billing and clinical documentation."})]}),e.jsx(ve,{patientId:d,serviceDate:s.date_of_service||new Date().toISOString().split("T")[0],selectedDiagnoses:s.diagnosis_codes||[],onChange:r=>g("diagnosis_codes",r)})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("label",{className:"block",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"font-semibold text-gray-800",children:[e.jsx("span",{className:"text-purple-600 mr-2",children:"P"}),"Problem / Presenting Issue"]}),e.jsx("span",{className:"text-xs text-gray-500",children:"Chief complaint, reason for session"})]}),e.jsx("textarea",{value:s.behaviorProblem||"",onChange:r=>g("behaviorProblem",r.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 resize-none bg-white shadow-sm",rows:"4",placeholder:"Example: Client reports increased anxiety related to work stress. Difficulty concentrating, racing thoughts, sleep disruption. Concerned about upcoming performance review..."})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-gray-600 mb-2",children:"Quick Tags (Optional)"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["Anxiety","Depression","Stress","Trauma","Grief","Relationship Issues","Work Stress","Sleep Issues","Anger","Self-Esteem"].map(r=>{const v=(s.clientPresentation||[]).includes(r);return e.jsx("button",{onClick:()=>{const N=s.clientPresentation||[];v?g("clientPresentation",N.filter(f=>f!==r)):g("clientPresentation",[...N,r])},className:`px-3 py-1 rounded-full text-xs font-medium transition-colors ${v?"bg-purple-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:r},r)})})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("span",{className:"font-semibold text-gray-800",children:[e.jsx("span",{className:"text-purple-600 mr-2",children:"I"}),"Intervention / What You Did"]})}),e.jsx("textarea",{value:s.intervention||"",onChange:r=>g("intervention",r.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 resize-none bg-white shadow-sm",rows:"4",placeholder:"Narrative description of interventions used... (or use checkboxes below for quick selection)"})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsx("div",{className:"text-label mb-3",children:"Select Interventions Used"}),e.jsx(fe,{selectedInterventions:s.interventionsSelected||[],onChange:r=>g("interventionsSelected",r),riskPresent:l})]})]}),e.jsx("div",{className:"card-main",children:e.jsxs("label",{className:"block",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"font-semibold text-gray-800",children:[e.jsx("span",{className:"text-purple-600 mr-2",children:"R"}),"Response / How Client Responded"]}),e.jsx("span",{className:"text-xs text-gray-500",children:"Client's reaction to interventions"})]}),e.jsx("textarea",{value:s.response||"",onChange:r=>g("response",r.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 resize-none bg-white shadow-sm",rows:"4",placeholder:"Example: Client reported feeling validated after reframing negative thoughts. Expressed willingness to practice relaxation techniques. Appeared more hopeful by end of session..."})]})}),e.jsxs("div",{className:"card-main",children:[e.jsxs("label",{className:"block mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"font-semibold text-gray-800",children:[e.jsx("span",{className:"text-purple-600 mr-2",children:"P"}),"Plan / What's Next"]}),e.jsx("span",{className:"text-xs text-gray-500",children:"Homework, next steps, follow-up"})]}),e.jsx("textarea",{value:s.plan||"",onChange:r=>g("plan",r.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 resize-none bg-white shadow-sm",rows:"4",placeholder:"Example: Continue weekly sessions. Homework: Practice deep breathing 3x daily. Client will monitor anxiety levels in journal. Follow up on work situation next session..."})]}),!a&&t.length>0&&e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsx("div",{className:"text-label mb-3",children:"Treatment Goals Addressed This Session"}),e.jsx("div",{className:"space-y-2",children:t.map(r=>e.jsxs("label",{className:"flex items-start gap-3 p-3 rounded-lg hover:bg-purple-50 cursor-pointer transition-colors",children:[e.jsx("input",{type:"checkbox",checked:(s.goalsAddressed||[]).includes(r.id),onChange:()=>p(r.id),className:"mt-0.5 w-4 h-4 text-purple-600 rounded focus:ring-purple-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm text-gray-800",children:r.goal_text}),r.goal_category&&e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:r.goal_category})]})]},r.id))})]})]}),e.jsxs("div",{className:"card-main bg-orange-50 border-2 border-orange-300",children:[e.jsxs("label",{className:"flex items-center gap-3 mb-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:l,onChange:r=>n(r.target.checked),className:"w-5 h-5 text-orange-600 rounded focus:ring-orange-500"}),e.jsx("span",{className:"font-semibold text-gray-800",children:"âš ï¸ Risk Present (suicide, homicide, self-harm)"})]}),l&&e.jsx("div",{className:"border-t-2 border-orange-200 pt-3",children:e.jsxs("label",{className:"block",children:[e.jsx("div",{className:"text-sm font-semibold text-orange-800 mb-2",children:"Risk Assessment Details (Required when risk is flagged)"}),e.jsx("textarea",{value:s.riskAssessment||"",onChange:r=>g("riskAssessment",r.target.value),className:"w-full px-4 py-3 border-2 border-orange-400 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 resize-none bg-white shadow-sm",rows:"5",placeholder:"Document risk factors, protective factors, safety plan, level of risk, interventions used, follow-up plan...",required:l})]})})]})]})}function gs({note:s,onChange:o,patientId:d,autoSave:i}){const[t,u]=x.useState([]),[a,m]=x.useState(!0),[l,c]=x.useState(s.riskPresent||!1);x.useEffect(()=>{b()},[d]);const b=async()=>{try{m(!0);const r=await be(d,{status:"active"});u(r.goals||[])}catch(r){console.error("Error loading treatment goals:",r)}finally{m(!1)}},g=(r,v)=>{o(r,v),i&&setTimeout(()=>i(),500)},n=r=>{c(r),g("riskPresent",r)},p=r=>{const v=s.goalsAddressed||[];v.includes(r)?g("goalsAddressed",v.filter(f=>f!==r)):g("goalsAddressed",[...v,r])};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card-main bg-blue-50 border-2 border-blue-300",children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ¥"}),e.jsx("span",{children:"Diagnosis Codes for This Session"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Select all diagnoses addressed in this session. Required for billing and clinical documentation."})]}),e.jsx(ve,{patientId:d,serviceDate:s.date_of_service||new Date().toISOString().split("T")[0],selectedDiagnoses:s.diagnosis_codes||[],onChange:r=>g("diagnosis_codes",r)})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("label",{className:"block",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"font-semibold text-gray-800",children:[e.jsx("span",{className:"text-green-600 mr-2",children:"S"}),"Subjective / What Client Reports"]}),e.jsx("span",{className:"text-xs text-gray-500",children:"Client's symptoms, feelings, history"})]}),e.jsx("textarea",{value:s.subjective||"",onChange:r=>g("subjective",r.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 resize-none bg-white shadow-sm",rows:"4",placeholder:"Example: Client reports feeling 'overwhelmed and anxious' over the past two weeks. States difficulty sleeping, racing thoughts, and increased irritability. Denies changes in appetite. Reports work stress as primary trigger..."})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-gray-600 mb-2",children:"Reported Symptoms (Optional)"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["Anxiety","Depression","Sleep Issues","Appetite Changes","Fatigue","Racing Thoughts","Irritability","Hopelessness","Difficulty Concentrating","Social Withdrawal"].map(r=>{const v=(s.reportedSymptoms||[]).includes(r);return e.jsx("button",{onClick:()=>{const N=s.reportedSymptoms||[];v?g("reportedSymptoms",N.filter(f=>f!==r)):g("reportedSymptoms",[...N,r])},className:`px-3 py-1 rounded-full text-xs font-medium transition-colors ${v?"bg-green-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:r},r)})})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("label",{className:"block",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"font-semibold text-gray-800",children:[e.jsx("span",{className:"text-green-600 mr-2",children:"O"}),"Objective / Clinical Observations"]}),e.jsx("span",{className:"text-xs text-gray-500",children:"Mental status, appearance, behavior"})]}),e.jsx("textarea",{value:s.objective||"",onChange:r=>g("objective",r.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 resize-none bg-white shadow-sm",rows:"4",placeholder:"Example: Client arrived on time, appropriately dressed. Appeared anxious with fidgeting and rapid speech. Affect congruent with stated mood. Eye contact intermittent. Thought process organized. No evidence of psychosis..."})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-gray-600 mb-2",children:"Presentation Tags (Optional)"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["Engaged","Cooperative","Tearful","Anxious","Flat affect","Guarded","Appropriate dress","Good eye contact","Poor eye contact","Oriented x3"].map(r=>{const v=(s.clientPresentation||[]).includes(r);return e.jsx("button",{onClick:()=>{const N=s.clientPresentation||[];v?g("clientPresentation",N.filter(f=>f!==r)):g("clientPresentation",[...N,r])},className:`px-3 py-1 rounded-full text-xs font-medium transition-colors ${v?"bg-green-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:r},r)})})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("label",{className:"block mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"font-semibold text-gray-800",children:[e.jsx("span",{className:"text-green-600 mr-2",children:"A"}),"Assessment / Clinical Impression"]}),e.jsx("span",{className:"text-xs text-gray-500",children:"Progress, insights, clinical judgment"})]}),e.jsx("textarea",{value:s.assessment||"",onChange:r=>g("assessment",r.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 resize-none bg-white shadow-sm",rows:"4",placeholder:"Example: Client presents with symptoms consistent with Generalized Anxiety Disorder. Symptoms appear to be exacerbated by work stress. Making progress on coping skills but requires continued support..."})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsx("div",{className:"text-label mb-3",children:"Interventions Used This Session"}),e.jsx(fe,{selectedInterventions:s.interventionsSelected||[],onChange:r=>g("interventionsSelected",r),riskPresent:l})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("label",{className:"block mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"font-semibold text-gray-800",children:[e.jsx("span",{className:"text-green-600 mr-2",children:"P"}),"Plan / Treatment Plan"]}),e.jsx("span",{className:"text-xs text-gray-500",children:"Next steps, homework, referrals"})]}),e.jsx("textarea",{value:s.plan||"",onChange:r=>g("plan",r.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 resize-none bg-white shadow-sm",rows:"4",placeholder:"Example: Continue weekly therapy sessions. Homework: Practice relaxation techniques daily, complete thought log. Consider medication consultation if symptoms persist. Follow up on sleep hygiene next session..."})]}),!a&&t.length>0&&e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsx("div",{className:"text-label mb-3",children:"Treatment Goals Addressed This Session"}),e.jsx("div",{className:"space-y-2",children:t.map(r=>e.jsxs("label",{className:"flex items-start gap-3 p-3 rounded-lg hover:bg-green-50 cursor-pointer transition-colors",children:[e.jsx("input",{type:"checkbox",checked:(s.goalsAddressed||[]).includes(r.id),onChange:()=>p(r.id),className:"mt-0.5 w-4 h-4 text-green-600 rounded focus:ring-green-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm text-gray-800",children:r.goal_text}),r.goal_category&&e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:r.goal_category})]})]},r.id))})]})]}),e.jsxs("div",{className:"card-main bg-orange-50 border-2 border-orange-300",children:[e.jsxs("label",{className:"flex items-center gap-3 mb-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:l,onChange:r=>n(r.target.checked),className:"w-5 h-5 text-orange-600 rounded focus:ring-orange-500"}),e.jsx("span",{className:"font-semibold text-gray-800",children:"Risk Present (suicide, homicide, self-harm)"})]}),l&&e.jsx("div",{className:"border-t-2 border-orange-200 pt-3",children:e.jsxs("label",{className:"block",children:[e.jsx("div",{className:"text-sm font-semibold text-orange-800 mb-2",children:"Risk Assessment Details (Required when risk is flagged)"}),e.jsx("textarea",{value:s.riskAssessment||"",onChange:r=>g("riskAssessment",r.target.value),className:"w-full px-4 py-3 border-2 border-orange-400 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 resize-none bg-white shadow-sm",rows:"5",placeholder:"Document risk factors, protective factors, safety plan, level of risk, interventions used, follow-up plan...",required:l})]})})]})]})}function ps({note:s,onChange:o,autoSave:d}){const i=(l,c)=>{o(l,c),d&&setTimeout(()=>d(),500)},t=l=>{const c=s.servicesProvided||[];c.includes(l)?i("servicesProvided",c.filter(g=>g!==l)):i("servicesProvided",[...c,l])},u=[{value:"in_person",label:"In-Person Meeting"},{value:"phone",label:"Phone Call"},{value:"video",label:"Video Call"},{value:"email",label:"Email"},{value:"text",label:"Text Message"},{value:"collateral",label:"Collateral Contact"},{value:"home_visit",label:"Home Visit"},{value:"community",label:"Community Visit"}],a=[{title:"Resource Coordination",color:"blue",services:["Housing assistance","Food/nutrition resources","Transportation assistance","Utility assistance","Clothing/personal items","Financial assistance"]},{title:"Referrals & Linkages",color:"purple",services:["Medical referral","Psychiatric referral","Substance abuse treatment","Legal services","Employment services","Educational services","Childcare services","Domestic violence resources"]},{title:"Advocacy & Support",color:"green",services:["Benefits application","Insurance navigation","Appointment coordination","Care team communication","Family support","Crisis intervention","Discharge planning","System navigation"]},{title:"Documentation & Administrative",color:"gray",services:["Assessment completion","Care plan review","Progress monitoring","Release of information","Records request","Report preparation"]}],m=["Client engaged and receptive","Client declined services","Unable to reach client","Left voicemail","Referral accepted","Referral pending","Follow-up needed","Goal completed","No answer"];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card-main bg-teal-50 border-2 border-teal-300",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center gap-2 mb-4",children:[e.jsx("span",{children:"ðŸ“ž"}),e.jsx("span",{children:"Contact Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Contact Type"}),e.jsxs("select",{value:s.contactType||"",onChange:l=>i("contactType",l.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 bg-white",children:[e.jsx("option",{value:"",children:"Select contact type..."}),u.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Duration (minutes)"}),e.jsx("input",{type:"number",value:s.duration||"",onChange:l=>i("duration",l.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 bg-white",placeholder:"e.g., 30",min:"1"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Contact With"}),e.jsx("input",{type:"text",value:s.contactWith||"",onChange:l=>i("contactWith",l.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 bg-white",placeholder:"e.g., Client, Family member (relationship), Agency name, etc."})]})]})]}),e.jsx("div",{className:"card-main",children:e.jsxs("label",{className:"block",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Purpose of Contact"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Why this contact was made"})]}),e.jsx("textarea",{value:s.purposeOfContact||"",onChange:l=>i("purposeOfContact",l.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 resize-none bg-white shadow-sm",rows:"3",placeholder:"Example: Follow-up on housing application submitted last week. Check in on client's overall well-being and current needs..."})]})}),e.jsxs("div",{className:"card-main",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-4",children:"Services Provided"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:a.map(l=>e.jsxs("div",{children:[e.jsx("div",{className:`text-sm font-semibold text-${l.color}-700 mb-2`,children:l.title}),e.jsx("div",{className:"space-y-2",children:l.services.map(c=>{const b=(s.servicesProvided||[]).includes(c);return e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-1 rounded",children:[e.jsx("input",{type:"checkbox",checked:b,onChange:()=>t(c),className:"w-4 h-4 text-teal-600 rounded focus:ring-teal-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:c})]},c)})})]},l.title))}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Other Services (not listed above)"}),e.jsx("input",{type:"text",value:s.otherServices||"",onChange:l=>i("otherServices",l.target.value),className:"mt-1 w-full px-4 py-2 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 bg-white",placeholder:"Describe any other services provided..."})]})})]}),e.jsx("div",{className:"card-main",children:e.jsxs("label",{className:"block",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Narrative / Details"}),e.jsx("span",{className:"text-xs text-gray-500",children:"What happened during the contact"})]}),e.jsx("textarea",{value:s.narrative||"",onChange:l=>i("narrative",l.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 resize-none bg-white shadow-sm",rows:"5",placeholder:"Example: Spoke with client regarding housing application. Client reported they received a call from the housing authority and have an interview scheduled for next Tuesday. Reviewed what documents to bring. Client expressed feeling hopeful about the process. Discussed backup plans if this application is not approved..."})]})}),e.jsxs("div",{className:"card-main",children:[e.jsxs("label",{className:"block mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Client Status / Response"}),e.jsx("span",{className:"text-xs text-gray-500",children:"How client is doing, their response"})]}),e.jsx("textarea",{value:s.clientStatus||"",onChange:l=>i("clientStatus",l.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 resize-none bg-white shadow-sm",rows:"3",placeholder:"Example: Client was engaged and receptive during our conversation. Reports feeling more stable since starting new medication. Mood appeared improved from last contact..."})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-gray-600 mb-2",children:"Contact Outcome (Optional)"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:m.map(l=>{const c=(s.contactOutcome||[]).includes(l);return e.jsx("button",{onClick:()=>{const b=s.contactOutcome||[];c?i("contactOutcome",b.filter(g=>g!==l)):i("contactOutcome",[...b,l])},className:`px-3 py-1 rounded-full text-xs font-medium transition-colors ${c?"bg-teal-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:l},l)})})]})]}),e.jsxs("div",{className:"card-main bg-yellow-50 border-2 border-yellow-300",children:[e.jsxs("label",{className:"block",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("span",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ“‹"}),"Follow-up Plan / Next Steps"]})}),e.jsx("textarea",{value:s.followUpPlan||"",onChange:l=>i("followUpPlan",l.target.value),className:"w-full px-4 py-3 border-2 border-yellow-400 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500 resize-none bg-white shadow-sm",rows:"3",placeholder:"Example: Will call client Thursday to follow up on housing interview. Need to research additional food bank options in client's new neighborhood. Schedule care team meeting for next month..."})]}),e.jsx("div",{className:"mt-3",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Next Follow-up Date:"}),e.jsx("input",{type:"date",value:s.followUpDate||"",onChange:l=>i("followUpDate",l.target.value),className:"px-3 py-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500"})]})})]}),e.jsx("div",{className:"card-main",children:e.jsxs("label",{className:"block",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Barriers / Concerns (Optional)"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Challenges or obstacles noted"})]}),e.jsx("textarea",{value:s.barriers||"",onChange:l=>i("barriers",l.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 resize-none bg-white shadow-sm",rows:"2",placeholder:"Example: Client lacks transportation to attend housing interview. Language barrier making it difficult to navigate benefits application..."})]})})]})}function bs({note:s,onChange:o,autoSave:d}){const[i,t]=x.useState(s.riskPresent||!1),u=(g,n)=>{o(g,n),d&&setTimeout(()=>d(),500)},a=g=>{t(g),u("riskPresent",g)},m=g=>(s.mentalStatusExam||{})[g]||"",l=(g,n)=>{const p=s.mentalStatusExam||{};u("mentalStatusExam",{...p,[g]:n})},c=({label:g,field:n,options:p})=>e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:g}),e.jsxs("select",{value:m(n),onChange:r=>l(n,r.target.value),className:"w-full px-3 py-2 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 bg-white shadow-sm",children:[e.jsx("option",{value:"",children:"Select..."}),p.map(r=>e.jsx("option",{value:r,children:r},r))]})]})}),b=({label:g,field:n,placeholder:p,rows:r=3})=>e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:g}),e.jsx("textarea",{value:m(n),onChange:v=>l(n,v.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 resize-none bg-white shadow-sm",rows:r,placeholder:p})]})});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-teal",children:[e.jsx("span",{className:"mr-2",children:"ðŸ‘¤"}),"Appearance & Grooming"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(c,{label:"General Appearance",field:"appearance",options:["Well-groomed","Disheveled","Unkempt","Bizarre","Appropriate","Casual"]}),e.jsx(c,{label:"Hygiene",field:"hygiene",options:["Good","Fair","Poor","Malodorous"]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(b,{label:"Additional Notes",field:"appearanceNotes",placeholder:"Additional observations about appearance...",rows:2})})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-teal",children:[e.jsx("span",{className:"mr-2",children:"ðŸƒ"}),"Behavior & Motor Activity"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(c,{label:"Psychomotor Activity",field:"psychomotorActivity",options:["Normal","Agitated","Retarded","Restless","Hyperactive","Lethargic"]}),e.jsx(c,{label:"Eye Contact",field:"eyeContact",options:["Good","Fair","Poor","Avoidant","Intense/Staring"]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(b,{label:"Additional Behavioral Observations",field:"behaviorNotes",placeholder:"Tics, tremors, mannerisms, gait, posture...",rows:2})})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-teal",children:[e.jsx("span",{className:"mr-2",children:"ðŸ’¬"}),"Speech"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(c,{label:"Rate",field:"speechRate",options:["Normal","Slow","Rapid","Pressured"]}),e.jsx(c,{label:"Volume",field:"speechVolume",options:["Normal","Loud","Soft","Whispered"]}),e.jsx(c,{label:"Tone",field:"speechTone",options:["Normal","Monotone","Varied","Flat"]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(b,{label:"Speech Characteristics",field:"speechNotes",placeholder:"Slurred, stuttering, articulation issues...",rows:2})})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-teal",children:[e.jsx("span",{className:"mr-2",children:"ðŸ˜Š"}),"Mood & Affect"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Mood (subjective)"}),e.jsx("input",{type:"text",value:m("mood"),onChange:g=>l("mood",g.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 bg-white shadow-sm",placeholder:"Client's own words (e.g., 'sad', 'anxious')"})]})}),e.jsx(c,{label:"Affect (objective)",field:"affect",options:["Appropriate","Flat","Blunted","Labile","Restricted","Congruent","Incongruent"]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(b,{label:"Mood & Affect Details",field:"moodNotes",placeholder:"Congruence, range, reactivity...",rows:2})})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-teal",children:[e.jsx("span",{className:"mr-2",children:"ðŸ§©"}),"Thought Process"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(c,{label:"Organization",field:"thoughtProcess",options:["Logical","Goal-directed","Tangential","Circumstantial","Loose associations","Flight of ideas","Thought blocking"]}),e.jsx(c,{label:"Flow",field:"thoughtFlow",options:["Normal","Rapid","Slow","Interrupted"]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(b,{label:"Additional Observations",field:"thoughtProcessNotes",placeholder:"Racing thoughts, ruminations, perseverations...",rows:2})})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-teal",children:[e.jsx("span",{className:"mr-2",children:"ðŸ’­"}),"Thought Content"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex flex-wrap gap-3",children:["Suicidal ideation","Homicidal ideation","Delusions","Obsessions","Phobias","Paranoia"].map(g=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:(m("thoughtContent")||[]).includes(g),onChange:n=>{const p=m("thoughtContent")||[],r=n.target.checked?[...p,g]:p.filter(v=>v!==g);l("thoughtContent",r)},className:"w-4 h-4 text-teal-600 rounded focus:ring-teal-500"}),e.jsx("span",{className:"checkbox-label",children:g})]},g))}),e.jsx(b,{label:"Thought Content Details",field:"thoughtContentNotes",placeholder:"Describe any concerning thought content, including intent, plan, means...",rows:3})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-teal",children:[e.jsx("span",{className:"mr-2",children:"ðŸ‘ï¸"}),"Perception"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex flex-wrap gap-3",children:["No perceptual disturbances","Auditory hallucinations","Visual hallucinations","Tactile hallucinations","Illusions","Depersonalization","Derealization"].map(g=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:(m("perception")||[]).includes(g),onChange:n=>{const p=m("perception")||[],r=n.target.checked?[...p,g]:p.filter(v=>v!==g);l("perception",r)},className:"w-4 h-4 text-teal-600 rounded focus:ring-teal-500"}),e.jsx("span",{className:"checkbox-label",children:g})]},g))}),e.jsx(b,{label:"Perception Details",field:"perceptionNotes",placeholder:"Describe any perceptual disturbances...",rows:2})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-teal",children:[e.jsx("span",{className:"mr-2",children:"ðŸ§ "}),"Cognition"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(c,{label:"Orientation",field:"orientation",options:["Oriented x4","Oriented x3","Oriented x2","Oriented x1","Disoriented"]}),e.jsx(c,{label:"Memory",field:"memory",options:["Intact","Impaired recent","Impaired remote","Impaired both"]}),e.jsx(c,{label:"Concentration",field:"concentration",options:["Good","Fair","Poor","Distractible"]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(b,{label:"Cognitive Details",field:"cognitionNotes",placeholder:"Attention, abstract thinking, calculations...",rows:2})})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-teal",children:[e.jsx("span",{className:"mr-2",children:"ðŸ’¡"}),"Insight & Judgment"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(c,{label:"Insight",field:"insight",options:["Good","Fair","Poor","Absent"]}),e.jsx(c,{label:"Judgment",field:"judgment",options:["Good","Fair","Poor","Impaired"]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(b,{label:"Insight & Judgment Details",field:"insightJudgmentNotes",placeholder:"Awareness of illness, decision-making capacity...",rows:2})})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-teal",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“‹"}),"Clinical Summary & Impressions"]}),e.jsx(b,{label:"Summary",field:"summary",placeholder:"Overall clinical impression, diagnostic considerations, recommendations...",rows:5})]}),e.jsxs("div",{className:"card-main bg-orange-50 border-2 border-orange-300",children:[e.jsxs("label",{className:"flex items-center gap-3 mb-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i,onChange:g=>a(g.target.checked),className:"w-5 h-5 text-orange-600 rounded focus:ring-orange-500"}),e.jsx("span",{className:"font-semibold text-gray-800",children:"âš ï¸ Risk Present (suicide, homicide, self-harm)"})]}),i&&e.jsx("div",{className:"border-t-2 border-orange-200 pt-3",children:e.jsxs("label",{className:"block",children:[e.jsx("div",{className:"text-sm font-semibold text-orange-800 mb-2",children:"Risk Assessment Details (Required when risk is flagged)"}),e.jsx("textarea",{value:s.riskAssessment||"",onChange:g=>u("riskAssessment",g.target.value),className:"w-full px-4 py-3 border-2 border-orange-400 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 resize-none bg-white shadow-sm",rows:"5",placeholder:"Document risk factors, protective factors, safety plan, level of risk, interventions used, follow-up plan...",required:i})]})})]})]})}function fs({medications:s=[],onChange:o}){const[d,i]=x.useState(!1),[t,u]=x.useState(null),[a,m]=x.useState({name:"",dosage:"",frequency:"",prescriber:"",purpose:""}),l=()=>{m({name:"",dosage:"",frequency:"",prescriber:"",purpose:""}),i(!1),u(null)},c=()=>{if(!a.name.trim())return;const p={...a},r=[...s,p];o(r),l()},b=p=>{m(s[p]),u(p),i(!0)},g=()=>{if(!a.name.trim())return;const p=[...s];p[t]={...a},o(p),l()},n=p=>{const r=s.filter((v,N)=>N!==p);o(r)};return e.jsxs("div",{className:"space-y-4",children:[s.length>0&&e.jsx("div",{className:"space-y-2",children:s.map((p,r)=>e.jsx("div",{className:"p-3 bg-white border-2 border-gray-300 rounded-lg hover:border-indigo-400 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-semibold text-gray-900",children:[p.name,p.dosage&&e.jsx("span",{className:"ml-2 text-indigo-600",children:p.dosage})]}),p.frequency&&e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["Frequency: ",p.frequency]}),p.prescriber&&e.jsxs("div",{className:"text-sm text-gray-600",children:["Prescribed by: ",p.prescriber]}),p.purpose&&e.jsxs("div",{className:"text-sm text-gray-600",children:["For: ",p.purpose]})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsx("button",{onClick:()=>b(r),className:"text-sm text-indigo-600 hover:text-indigo-800 underline",children:"Edit"}),e.jsx("button",{onClick:()=>n(r),className:"text-sm text-red-600 hover:text-red-800 underline",children:"Remove"})]})]})},r))}),d?e.jsxs("div",{className:"p-4 bg-indigo-50 border-2 border-indigo-300 rounded-lg space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsxs("span",{className:"text-sm font-semibold text-gray-700 mb-1 block",children:["Medication Name ",e.jsx(ie,{})]}),e.jsx("input",{type:"text",value:a.name,onChange:p=>m({...a,name:p.target.value}),className:"w-full px-3 py-2 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"e.g., Sertraline, Adderall XR",autoFocus:!0})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700 mb-1 block",children:"Dosage"}),e.jsx("input",{type:"text",value:a.dosage,onChange:p=>m({...a,dosage:p.target.value}),className:"w-full px-3 py-2 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"e.g., 50mg, 20mg XR"})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700 mb-1 block",children:"Frequency"}),e.jsx("input",{type:"text",value:a.frequency,onChange:p=>m({...a,frequency:p.target.value}),className:"w-full px-3 py-2 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"e.g., Once daily, Twice daily"})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700 mb-1 block",children:"Prescriber"}),e.jsx("input",{type:"text",value:a.prescriber,onChange:p=>m({...a,prescriber:p.target.value}),className:"w-full px-3 py-2 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"e.g., Dr. Smith, Psychiatrist"})]})}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700 mb-1 block",children:"What it's for"}),e.jsx("input",{type:"text",value:a.purpose,onChange:p=>m({...a,purpose:p.target.value}),className:"w-full px-3 py-2 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"e.g., Depression, ADHD, Anxiety"})]})})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx("button",{onClick:t!==null?g:c,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-medium",children:t!==null?"Update Medication":"Add Medication"}),e.jsx("button",{onClick:l,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 font-medium",children:"Cancel"})]})]}):e.jsx("button",{onClick:()=>i(!0),className:"w-full px-4 py-3 border-2 border-dashed border-indigo-400 rounded-lg text-indigo-700 font-medium hover:bg-indigo-50 transition-colors",children:"+ Add Medication"}),s.length===0&&!d&&e.jsx("div",{className:"text-sm text-gray-500 italic text-center py-2",children:"No medications documented yet"})]})}function vs({note:s,onChange:o,autoSave:d}){const[i,t]=x.useState(s.riskPresent||!1),u=(c,b)=>{o(c,b),d&&setTimeout(()=>d(),500)},a=c=>{t(c),u("riskPresent",c)},m=c=>(s.presentingConcerns||{})[c]||"",l=(c,b)=>{const g=s.presentingConcerns||{};u("presentingConcerns",{...g,[c]:b})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-indigo",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“‹"}),"Presenting Problem / Chief Complaint"]}),e.jsx("textarea",{value:s.behaviorProblem||"",onChange:c=>u("behaviorProblem",c.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none bg-white shadow-sm",rows:"5",placeholder:"In client's own words: What brings you in today? What are you hoping to work on?"})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-indigo",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“–"}),"History of Present Illness"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Duration & Onset"}),e.jsx("textarea",{value:m("duration"),onChange:c=>l("duration",c.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none bg-white shadow-sm",rows:"2",placeholder:"When did symptoms begin? What was happening at that time?"})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Frequency & Severity"}),e.jsx("textarea",{value:m("frequency"),onChange:c=>l("frequency",c.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none bg-white shadow-sm",rows:"2",placeholder:"How often? How severe? What makes it better/worse?"})]})})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-indigo",children:[e.jsx("span",{className:"mr-2",children:"ðŸ¥"}),"Previous Mental Health Treatment"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Prior Therapy/Counseling"}),e.jsx("textarea",{value:m("priorTherapy"),onChange:c=>l("priorTherapy",c.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none bg-white shadow-sm",rows:"2",placeholder:"When? With whom? What was helpful/not helpful?"})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Psychiatric Hospitalizations"}),e.jsx("textarea",{value:m("hospitalizations"),onChange:c=>l("hospitalizations",c.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none bg-white shadow-sm",rows:"2",placeholder:"Dates, reasons, outcomes..."})]})})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-indigo",children:[e.jsx("span",{className:"mr-2",children:"ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦"}),"Family History"]}),e.jsx("textarea",{value:m("familyHistory"),onChange:c=>l("familyHistory",c.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none bg-white shadow-sm",rows:"3",placeholder:"Mental health diagnoses, substance use, suicide attempts in family members..."})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-indigo",children:[e.jsx("span",{className:"mr-2",children:"ðŸº"}),"Substance Use"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Alcohol Use"}),e.jsx("textarea",{value:m("alcoholUse"),onChange:c=>l("alcoholUse",c.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none bg-white shadow-sm",rows:"2",placeholder:"Frequency, amount, history of abuse..."})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Drug Use (Recreational/Prescription)"}),e.jsx("textarea",{value:m("drugUse"),onChange:c=>l("drugUse",c.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none bg-white shadow-sm",rows:"2",placeholder:"Substances, frequency, history..."})]})})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-indigo",children:[e.jsx("span",{className:"mr-2",children:"âš•ï¸"}),"Medical History"]}),e.jsx("textarea",{value:m("medicalHistory"),onChange:c=>l("medicalHistory",c.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none bg-white shadow-sm",rows:"3",placeholder:"Chronic conditions, surgeries, head injuries, neurological issues..."})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-indigo",children:[e.jsx("span",{className:"mr-2",children:"ðŸ’Š"}),"Current Medications"]}),e.jsx("div",{className:"text-sm text-gray-600 mb-4",children:"Document all medications the client is currently taking (psychiatric, medical, OTC, supplements). This includes medications prescribed by psychiatrists, PCPs, and other providers."}),e.jsx(fs,{medications:s.currentMedications||[],onChange:c=>u("currentMedications",c)})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-indigo",children:[e.jsx("span",{className:"mr-2",children:"ðŸŒ±"}),"Social & Developmental History"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Childhood/Development"}),e.jsx("textarea",{value:m("childhood"),onChange:c=>l("childhood",c.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none bg-white shadow-sm",rows:"2",placeholder:"Developmental milestones, childhood experiences, trauma..."})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Education & Employment"}),e.jsx("textarea",{value:m("education"),onChange:c=>l("education",c.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none bg-white shadow-sm",rows:"2",placeholder:"Highest education, current employment, work history..."})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Relationships & Support System"}),e.jsx("textarea",{value:m("relationships"),onChange:c=>l("relationships",c.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none bg-white shadow-sm",rows:"2",placeholder:"Marital status, children, family support, friends..."})]})})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-indigo",children:[e.jsx("span",{className:"mr-2",children:"âš¡"}),"Current Functioning"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Sleep"}),e.jsx("input",{type:"text",value:m("sleep"),onChange:c=>l("sleep",c.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 bg-white shadow-sm",placeholder:"Hours per night, quality, difficulties..."})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Appetite/Eating"}),e.jsx("input",{type:"text",value:m("appetite"),onChange:c=>l("appetite",c.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 bg-white shadow-sm",placeholder:"Changes, patterns, concerns..."})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Energy Level"}),e.jsx("input",{type:"text",value:m("energy"),onChange:c=>l("energy",c.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 bg-white shadow-sm",placeholder:"Fatigue, motivation, activity level..."})]})})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-indigo",children:[e.jsx("span",{className:"mr-2",children:"ðŸŽ¯"}),"Treatment Goals"]}),e.jsx("textarea",{value:s.plan||"",onChange:c=>u("plan",c.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none bg-white shadow-sm",rows:"4",placeholder:"What does the client hope to achieve? What are the initial treatment goals? Recommended frequency of sessions?"})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-indigo",children:[e.jsx("span",{className:"mr-2",children:"ðŸ’¡"}),"Clinical Impressions & Diagnostic Considerations"]}),e.jsx("textarea",{value:m("impressions"),onChange:c=>l("impressions",c.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none bg-white shadow-sm",rows:"4",placeholder:"Initial clinical formulation, provisional diagnoses, treatment recommendations..."})]}),e.jsxs("div",{className:"card-main bg-orange-50 border-2 border-orange-300",children:[e.jsxs("label",{className:"flex items-center gap-3 mb-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i,onChange:c=>a(c.target.checked),className:"w-5 h-5 text-orange-600 rounded focus:ring-orange-500"}),e.jsx("span",{className:"font-semibold text-gray-800",children:"âš ï¸ Risk Present (suicide, homicide, self-harm)"})]}),i&&e.jsx("div",{className:"border-t-2 border-orange-200 pt-3",children:e.jsxs("label",{className:"block",children:[e.jsx("div",{className:"text-sm font-semibold text-orange-800 mb-2",children:"Risk Assessment Details (Required when risk is flagged)"}),e.jsx("textarea",{value:s.riskAssessment||"",onChange:c=>u("riskAssessment",c.target.value),className:"w-full px-4 py-3 border-2 border-orange-400 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 resize-none bg-white shadow-sm",rows:"5",placeholder:"Document risk factors, protective factors, safety plan, level of risk, interventions used, follow-up plan...",required:i})]})})]})]})}function js({note:s,onChange:o,autoSave:d}){const i=(a,m)=>{o(a,m),d&&setTimeout(()=>d(),500)},t=a=>(s.clinicalObservations||{})[a]||"",u=(a,m)=>{const l=s.clinicalObservations||{};i("clinicalObservations",{...l,[a]:m})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-emerald",children:[e.jsx("span",{className:"mr-2",children:"âœ…"}),"Reason for Discharge"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex flex-wrap gap-3",children:["Treatment goals achieved","Client request","Mutual agreement","Client no-show","Administrative discharge","Transfer to another provider","Other"].map(a=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"dischargeReason",value:a,checked:t("dischargeReason")===a,onChange:m=>u("dischargeReason",m.target.value),className:"w-4 h-4 text-emerald-600"}),e.jsx("span",{className:"checkbox-label",children:a})]},a))}),e.jsx("textarea",{value:t("dischargeReasonDetails"),onChange:a=>u("dischargeReasonDetails",a.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 resize-none bg-white shadow-sm",rows:"2",placeholder:"Additional details..."})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-emerald",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“‹"}),"Treatment Summary"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Dates of Treatment"}),e.jsx("input",{type:"text",value:t("treatmentDates"),onChange:a=>u("treatmentDates",a.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 bg-white shadow-sm",placeholder:"From [date] to [date] - Total of X sessions"})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Presenting Problem (at intake)"}),e.jsx("textarea",{value:s.behaviorProblem||"",onChange:a=>i("behaviorProblem",a.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 resize-none bg-white shadow-sm",rows:"3",placeholder:"What brought client to treatment..."})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Diagnosis/Diagnoses"}),e.jsx("textarea",{value:t("diagnoses"),onChange:a=>u("diagnoses",a.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 resize-none bg-white shadow-sm",rows:"2",placeholder:"Primary and secondary diagnoses..."})]})})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-emerald",children:[e.jsx("span",{className:"mr-2",children:"ðŸ› ï¸"}),"Interventions & Treatment Modalities"]}),e.jsx("textarea",{value:s.intervention||"",onChange:a=>i("intervention",a.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 resize-none bg-white shadow-sm",rows:"4",placeholder:"CBT, DBT, EMDR, supportive counseling, psychoeducation, medication management..."})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-emerald",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“ˆ"}),"Progress & Treatment Outcomes"]}),e.jsx("textarea",{value:s.response||"",onChange:a=>i("response",a.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 resize-none bg-white shadow-sm",rows:"5",placeholder:"Describe client progress toward treatment goals, symptom reduction, skill development, behavioral changes..."})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-emerald",children:[e.jsx("span",{className:"mr-2",children:"ðŸŽ¯"}),"Current Status at Discharge"]}),e.jsx("textarea",{value:t("currentStatus"),onChange:a=>u("currentStatus",a.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 resize-none bg-white shadow-sm",rows:"4",placeholder:"Current symptoms, functioning level, remaining challenges, strengths..."})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-emerald",children:[e.jsx("span",{className:"mr-2",children:"ðŸ’¡"}),"Recommendations & Follow-Up Plan"]}),e.jsx("textarea",{value:s.plan||"",onChange:a=>i("plan",a.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 resize-none bg-white shadow-sm",rows:"5",placeholder:"Future treatment recommendations, referrals, follow-up care, relapse prevention strategies, resources provided..."})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-emerald",children:[e.jsx("span",{className:"mr-2",children:"ðŸ”®"}),"Prognosis"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex gap-4",children:["Excellent","Good","Fair","Guarded","Poor"].map(a=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"prognosis",value:a,checked:t("prognosis")===a,onChange:m=>u("prognosis",m.target.value),className:"w-4 h-4 text-emerald-600"}),e.jsx("span",{className:"checkbox-label",children:a})]},a))}),e.jsx("textarea",{value:t("prognosisDetails"),onChange:a=>u("prognosisDetails",a.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 resize-none bg-white shadow-sm",rows:"2",placeholder:"Additional prognosis details..."})]})]})]})}function Ns({note:s,onChange:o,autoSave:d}){const i=(t,u)=>{o(t,u),d&&setTimeout(()=>d(),500)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card-main bg-red-50 border-2 border-red-400",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"text-3xl",children:"âš ï¸"}),e.jsx("h3",{className:"text-xl font-bold text-red-800",children:"Crisis/Emergency Documentation"})]}),e.jsx("p",{className:"text-sm text-red-700",children:"Document all crisis assessments, interventions, and safety planning thoroughly."})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-red",children:[e.jsx("span",{className:"mr-2",children:"ðŸš¨"}),"Crisis Presentation"]}),e.jsx("textarea",{value:s.behaviorProblem||"",onChange:t=>i("behaviorProblem",t.target.value),className:"w-full px-4 py-3 border-2 border-red-400 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 resize-none bg-white shadow-sm",rows:"5",placeholder:"Describe the crisis situation: What happened? When? Who was involved? Client's presentation and immediate concerns...",required:!0})]}),e.jsxs("div",{className:"card-main bg-orange-50 border-2 border-orange-400",children:[e.jsxs("h3",{className:"text-lg font-semibold text-orange-800 mb-4",children:[e.jsx("span",{className:"mr-2",children:"âš ï¸"}),"Risk Assessment (REQUIRED)"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-semibold text-orange-800 mb-2 block",children:"Risk Level"}),e.jsx("div",{className:"flex gap-4",children:["Low","Moderate","High","Imminent"].map(t=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"riskLevel",value:t,className:"w-4 h-4 text-orange-600"}),e.jsx("span",{className:`text-sm font-medium ${t==="Imminent"||t==="High"?"text-red-700":"text-gray-700"}`,children:t})]},t))})]})}),e.jsx("textarea",{value:s.riskAssessment||"",onChange:t=>i("riskAssessment",t.target.value),className:"w-full px-4 py-3 border-2 border-orange-400 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 resize-none bg-white shadow-sm",rows:"6",placeholder:`DETAILED RISK ASSESSMENT REQUIRED:
- Suicidal ideation (intent, plan, means, timeline)?
- Homicidal ideation (intent, plan, means, target)?
- Self-harm behaviors?
- Substance use/intoxication?
- Risk factors vs. protective factors
- Access to lethal means
- Support system availability
- History of attempts`,required:!0})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-red",children:[e.jsx("span",{className:"mr-2",children:"ðŸ›Ÿ"}),"Crisis Interventions Provided"]}),e.jsx("textarea",{value:s.intervention||"",onChange:t=>i("intervention",t.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 resize-none bg-white shadow-sm",rows:"5",placeholder:"What interventions were used? (e.g., crisis counseling, de-escalation, safety planning, referrals, emergency contacts, medication evaluation, hospitalization consideration...)",required:!0})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-red",children:[e.jsx("span",{className:"mr-2",children:"ðŸ’¬"}),"Client Response to Intervention"]}),e.jsx("textarea",{value:s.response||"",onChange:t=>i("response",t.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 resize-none bg-white shadow-sm",rows:"4",placeholder:"How did client respond to interventions? Mood/affect changes? Willingness to engage in safety planning?",required:!0})]}),e.jsxs("div",{className:"card-main bg-green-50 border-2 border-green-400",children:[e.jsxs("h3",{className:"text-lg font-semibold text-green-800 mb-4",children:[e.jsx("span",{className:"mr-2",children:"ðŸ›¡ï¸"}),"Safety Plan (REQUIRED)"]}),e.jsx("textarea",{value:s.plan||"",onChange:t=>i("plan",t.target.value),className:"w-full px-4 py-3 border-2 border-green-400 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 resize-none bg-white shadow-sm",rows:"6",placeholder:`DETAILED SAFETY PLAN REQUIRED:
- Warning signs/triggers identified
- Internal coping strategies
- People/places for distraction
- Support contacts (names & numbers)
- Professional resources (crisis line, emergency services)
- Means restriction (removing lethal means)
- Follow-up plan
- Emergency numbers provided (988, local crisis line, etc.)`,required:!0})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-red",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“"}),"Disposition & Follow-Up Plan"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Disposition"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:["Returned home with safety plan","Emergency contact notified","Referred to higher level of care","Voluntary hospitalization","Involuntary commitment initiated","Police/EMS contacted","Other"].map(t=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"w-4 h-4 text-red-600 rounded"}),e.jsx("span",{className:"checkbox-label",children:t})]},t))})]})}),e.jsx("textarea",{className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 resize-none bg-white shadow-sm",rows:"3",placeholder:"Follow-up plan: Next appointment scheduled? Emergency contacts? Referrals made?"})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-red",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“ž"}),"Collateral Contacts (if any)"]}),e.jsx("textarea",{className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 resize-none bg-white shadow-sm",rows:"3",placeholder:"Document any contact with family, emergency services, other providers, etc."})]})]})}function ys({note:s,onChange:o,autoSave:d}){const i=s.riskAssessment||{suicidalIdeation:{present:!1,frequency:"None",intentLevel:"No intent",planDetails:"",accessToMeans:"",timeline:"",previousAttempts:""},homicidalIdeation:{present:!1,details:""},selfHarm:{present:!1,details:""},riskFactors:"",protectiveFactors:"",overallRiskLevel:"Low",safetyPlan:"",dispositionRecommendations:""},t=(a,m)=>{o(a,m),d&&setTimeout(()=>d(),500)},u=(a,m)=>{const l={...i},c=a.split(".");let b=l;for(let g=0;g<c.length-1;g++)b=b[c[g]];b[c[c.length-1]]=m,t("riskAssessment",l)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card-main bg-orange-50 border-2 border-orange-400",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"text-3xl",children:"ðŸ›¡ï¸"}),e.jsx("h3",{className:"text-xl font-bold text-orange-800",children:"Comprehensive Risk Assessment"})]}),e.jsx("p",{className:"text-sm text-orange-700",children:"Thorough evaluation of suicide, homicide, and self-harm risk with safety planning."})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-orange",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“‹"}),"Reason for Assessment"]}),e.jsx("textarea",{value:s.behaviorProblem||"",onChange:a=>t("behaviorProblem",a.target.value),className:"w-full px-4 py-3 border-2 border-orange-400 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 resize-none bg-white shadow-sm",rows:"3",placeholder:"What prompted this risk assessment?"})]}),e.jsxs("div",{className:"card-main bg-red-50 border-2 border-red-300",children:[e.jsxs("h3",{className:"text-lg font-semibold text-red-800 mb-4",children:[e.jsx("span",{className:"mr-2",children:"âš ï¸"}),"Suicidal Ideation Assessment"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-3 mb-2",children:[e.jsx("input",{type:"checkbox",className:"w-5 h-5 text-red-600 rounded",checked:i.suicidalIdeation.present,onChange:a=>u("suicidalIdeation.present",a.target.checked)}),e.jsx("span",{className:"font-semibold text-red-800",children:"Current suicidal ideation present"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Ideation Frequency"}),e.jsxs("select",{className:"w-full px-3 py-2 border-2 border-gray-400 rounded-lg bg-white shadow-sm",value:i.suicidalIdeation.frequency,onChange:a=>u("suicidalIdeation.frequency",a.target.value),children:[e.jsx("option",{children:"None"}),e.jsx("option",{children:"Rare (few times/year)"}),e.jsx("option",{children:"Occasional (monthly)"}),e.jsx("option",{children:"Frequent (weekly)"}),e.jsx("option",{children:"Daily"}),e.jsx("option",{children:"Constant"})]})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Intent Level"}),e.jsxs("select",{className:"w-full px-3 py-2 border-2 border-gray-400 rounded-lg bg-white shadow-sm",value:i.suicidalIdeation.intentLevel,onChange:a=>u("suicidalIdeation.intentLevel",a.target.value),children:[e.jsx("option",{children:"No intent"}),e.jsx("option",{children:"Low (passive wishes)"}),e.jsx("option",{children:"Moderate (some intent)"}),e.jsx("option",{children:"High (strong intent)"}),e.jsx("option",{children:"Imminent"})]})]})})]}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Plan Details"}),e.jsx("textarea",{className:"w-full px-4 py-3 border-2 border-red-400 rounded-lg focus:ring-2 focus:ring-red-500 resize-none bg-white shadow-sm",rows:"2",placeholder:"Is there a plan? How specific? How lethal?",value:i.suicidalIdeation.planDetails,onChange:a=>u("suicidalIdeation.planDetails",a.target.value)})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Access to Means"}),e.jsx("textarea",{className:"w-full px-4 py-3 border-2 border-red-400 rounded-lg focus:ring-2 focus:ring-red-500 resize-none bg-white shadow-sm",rows:"2",placeholder:"Does client have access to lethal means (firearms, medications, etc.)?",value:i.suicidalIdeation.accessToMeans,onChange:a=>u("suicidalIdeation.accessToMeans",a.target.value)})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Timeline"}),e.jsx("input",{type:"text",className:"w-full px-4 py-3 border-2 border-red-400 rounded-lg focus:ring-2 focus:ring-red-500 bg-white shadow-sm",placeholder:"When? Immediate? Within days/weeks?",value:i.suicidalIdeation.timeline,onChange:a=>u("suicidalIdeation.timeline",a.target.value)})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Previous Attempts"}),e.jsx("textarea",{className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-red-500 resize-none bg-white shadow-sm",rows:"2",placeholder:"History of suicide attempts? When? Method? Outcome?",value:i.suicidalIdeation.previousAttempts,onChange:a=>u("suicidalIdeation.previousAttempts",a.target.value)})]})})]})]}),e.jsxs("div",{className:"card-main bg-red-50 border-2 border-red-300",children:[e.jsxs("h3",{className:"text-lg font-semibold text-red-800 mb-4",children:[e.jsx("span",{className:"mr-2",children:"ðŸ”´"}),"Homicidal/Violence Risk Assessment"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-3 mb-2",children:[e.jsx("input",{type:"checkbox",className:"w-5 h-5 text-red-600 rounded",checked:i.homicidalIdeation.present,onChange:a=>u("homicidalIdeation.present",a.target.checked)}),e.jsx("span",{className:"font-semibold text-red-800",children:"Homicidal ideation or violence risk present"})]})}),e.jsx("textarea",{className:"w-full px-4 py-3 border-2 border-red-400 rounded-lg focus:ring-2 focus:ring-red-500 resize-none bg-white shadow-sm",rows:"4",placeholder:"Target identified? Plan? Access to weapons? History of violence? Duty to warn considerations?",value:i.homicidalIdeation.details,onChange:a=>u("homicidalIdeation.details",a.target.value)})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-orange",children:[e.jsx("span",{className:"mr-2",children:"ðŸ©¹"}),"Self-Harm Assessment"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-3 mb-2",children:[e.jsx("input",{type:"checkbox",className:"w-5 h-5 text-orange-600 rounded",checked:i.selfHarm.present,onChange:a=>u("selfHarm.present",a.target.checked)}),e.jsx("span",{className:"font-semibold text-gray-700",children:"Non-suicidal self-injury present"})]})}),e.jsx("textarea",{className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-orange-500 resize-none bg-white shadow-sm",rows:"3",placeholder:"Methods? Frequency? Function (emotion regulation, punishment, etc.)?",value:i.selfHarm.details,onChange:a=>u("selfHarm.details",a.target.value)})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-orange",children:[e.jsx("span",{className:"mr-2",children:"âš–ï¸"}),"Risk & Protective Factors"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-semibold text-red-700 mb-2 block",children:"Risk Factors"}),e.jsx("textarea",{className:"w-full px-4 py-3 border-2 border-red-400 rounded-lg focus:ring-2 focus:ring-red-500 resize-none bg-white shadow-sm",rows:"5",placeholder:`- Recent losses
- Substance use
- Social isolation
- Hopelessness
- Impulsivity
- Access to means
- Mental health symptoms
- Financial/legal problems`,value:i.riskFactors,onChange:a=>u("riskFactors",a.target.value)})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-semibold text-green-700 mb-2 block",children:"Protective Factors"}),e.jsx("textarea",{className:"w-full px-4 py-3 border-2 border-green-400 rounded-lg focus:ring-2 focus:ring-green-500 resize-none bg-white shadow-sm",rows:"5",placeholder:`- Strong support system
- Reasons for living
- Engaged in treatment
- Coping skills
- Religious/spiritual beliefs
- Future goals
- Responsibility to others
- Problem-solving ability`,value:i.protectiveFactors,onChange:a=>u("protectiveFactors",a.target.value)})]})})]})]}),e.jsxs("div",{className:"card-main bg-orange-100 border-2 border-orange-400",children:[e.jsxs("h3",{className:"text-lg font-semibold text-orange-800 mb-4",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“Š"}),"Overall Risk Level"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex flex-wrap gap-4",children:["Low","Low-Moderate","Moderate","Moderate-High","High","Imminent"].map(a=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"overallRisk",value:a,className:"w-4 h-4 text-orange-600",checked:i.overallRiskLevel===a,onChange:m=>u("overallRiskLevel",m.target.value)}),e.jsx("span",{className:`text-sm font-medium ${a.includes("High")||a==="Imminent"?"text-red-700":"text-gray-700"}`,children:a})]},a))}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Clinical Rationale"}),e.jsx("textarea",{value:i.dispositionRecommendations,onChange:a=>u("dispositionRecommendations",a.target.value),className:"w-full px-4 py-3 border-2 border-orange-400 rounded-lg focus:ring-2 focus:ring-orange-500 resize-none bg-white shadow-sm",rows:"4",placeholder:"Clinical rationale for risk level determination...",required:!0})]})})]})]}),e.jsxs("div",{className:"card-main bg-green-50 border-2 border-green-400",children:[e.jsxs("h3",{className:"text-lg font-semibold text-green-800 mb-4",children:[e.jsx("span",{className:"mr-2",children:"ðŸ›¡ï¸"}),"Interventions & Safety Plan"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Interventions Provided"}),e.jsx("textarea",{value:s.intervention||"",onChange:a=>t("intervention",a.target.value),className:"w-full px-4 py-3 border-2 border-green-400 rounded-lg focus:ring-2 focus:ring-green-500 resize-none bg-white shadow-sm",rows:"3",placeholder:"Crisis counseling, means restriction, emergency contacts, referrals..."})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Safety Plan"}),e.jsx("textarea",{value:s.plan||"",onChange:a=>t("plan",a.target.value),className:"w-full px-4 py-3 border-2 border-green-400 rounded-lg focus:ring-2 focus:ring-green-500 resize-none bg-white shadow-sm",rows:"6",placeholder:`Detailed safety plan:
- Warning signs
- Coping strategies
- Distraction activities
- Support contacts (names & numbers)
- Professional resources
- Crisis line numbers (988)
- Means restriction plan
- Follow-up schedule`,required:!0})]})})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-orange",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“…"}),"Follow-Up Plan & Recommendations"]}),e.jsx("textarea",{className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-orange-500 resize-none bg-white shadow-sm",rows:"3",placeholder:"Next appointment? Frequency of contact? Collateral involvement? Referrals? Hospitalization? Level of care recommendations?",value:i.safetyPlan,onChange:a=>u("safetyPlan",a.target.value)})]})]})}function ws({note:s,onChange:o,autoSave:d}){const i=(t,u)=>{o(t,u),d&&setTimeout(()=>d(),500)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-4",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“‹"}),"Type of Administrative Note"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:["Care coordination","Consultation with colleague","Phone contact","Email correspondence","Collateral contact","Documentation review","Treatment planning","Case management","Supervision notes","Peer review","Quality assurance","Insurance coordination","Referral coordination","Records request","Other"].map(t=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"w-4 h-4 text-gray-600 rounded"}),e.jsx("span",{className:"checkbox-label",children:t})]},t))})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-4",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“"}),"Details"]}),e.jsx("textarea",{value:s.behaviorProblem||"",onChange:t=>i("behaviorProblem",t.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 resize-none bg-white shadow-sm",rows:"8",placeholder:`Document the administrative activity:

- Date and time
- Who was involved (names, roles)
- Purpose of contact/activity
- Information discussed or exchanged
- Decisions made
- Follow-up needed
- Documents generated or reviewed`})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-4",children:[e.jsx("span",{className:"mr-2",children:"ðŸ‘¥"}),"Participants/Contacts"]}),e.jsx("textarea",{value:s.intervention||"",onChange:t=>i("intervention",t.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 resize-none bg-white shadow-sm",rows:"3",placeholder:"Who was involved? (Names, organizations, roles)"})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-4",children:[e.jsx("span",{className:"mr-2",children:"âœ…"}),"Outcome & Actions Taken"]}),e.jsx("textarea",{value:s.response||"",onChange:t=>i("response",t.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 resize-none bg-white shadow-sm",rows:"4",placeholder:"What was accomplished? Any decisions or agreements?"})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-4",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“Œ"}),"Follow-Up Required"]}),e.jsx("textarea",{value:s.plan||"",onChange:t=>i("plan",t.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 resize-none bg-white shadow-sm",rows:"3",placeholder:"Next steps? Who is responsible? Timeline?"})]}),e.jsxs("div",{className:"card-main bg-gray-50",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-4",children:[e.jsx("span",{className:"mr-2",children:"ðŸ’­"}),"Additional Notes"]}),e.jsx("textarea",{className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 resize-none bg-white shadow-sm",rows:"3",placeholder:"Any other relevant information..."})]}),e.jsxs("div",{className:"card-main bg-blue-50 border-2 border-blue-300",children:[e.jsxs("h3",{className:"section-header-blue",children:[e.jsx("span",{className:"mr-2",children:"â±ï¸"}),"Time Documentation"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Duration (minutes)"}),e.jsx("input",{type:"number",className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white shadow-sm",placeholder:"0",min:"0"})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Billable?"}),e.jsxs("select",{className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white shadow-sm",children:[e.jsx("option",{children:"Yes"}),e.jsx("option",{children:"No"}),e.jsx("option",{children:"To be determined"})]})]})})]})]})]})}const _s=["Mild","Moderate","Severe","In partial remission","In full remission","With psychotic features","Unspecified"],we=s=>!s||s.length<4?s:s.slice(0,3)+"."+s.slice(3);function Cs({selectedCodes:s=[],onChange:o,maxBillable:d=4,showBillableToggle:i=!0,showPrimarySelector:t=!0,showSeveritySelector:u=!0,disabled:a=!1}){const[m,l]=x.useState(""),[c,b]=x.useState([]),[g,n]=x.useState(!1),[p,r]=x.useState(!1),[v,N]=x.useState(null),[f,_]=x.useState({top:0,left:0,width:0}),k=x.useRef(null),h=x.useRef(null),y=x.useRef(null);x.useEffect(()=>{if(k.current&&clearTimeout(k.current),m.length<2){b([]),r(!1);return}return k.current=setTimeout(async()=>{n(!0),N(null);try{const P=await ds(m,"ICD10",50);b(P.codes||[]),r(!0)}catch(P){console.error("Error searching codes:",P),N("Failed to search codes. Please try again."),b([])}finally{n(!1)}},300),()=>{k.current&&clearTimeout(k.current)}},[m]),x.useEffect(()=>{if(p&&y.current){const P=y.current.getBoundingClientRect();_({top:P.bottom+window.scrollY,left:P.left+window.scrollX,width:P.width})}},[p]),x.useEffect(()=>{const P=T=>{h.current&&!h.current.contains(T.target)&&r(!1)};return document.addEventListener("mousedown",P),()=>document.removeEventListener("mousedown",P)},[]);const R=P=>{if(s.some(A=>A.code===P.code)){N(`${P.code} is already selected`);return}const T=s.filter(A=>A.billable).length,L={code:P.code,description:P.description,billable:T<d,primary:s.length===0,severity:null};o([...s,L]),l(""),r(!1),N(null)},j=P=>{const T=s.filter(L=>L.code!==P);s.find(L=>L.code===P)?.primary&&T.length>0&&(T[0].primary=!0),o(T)},J=(P,T,L)=>{const A=s.map(E=>{if(E.code===P){const z={...E,[T]:L};return z}return T==="primary"&&L===!0?{...E,primary:!1}:E});if(T==="billable"&&L===!0&&A.filter(z=>z.billable).length>d){N(`Maximum ${d} billable diagnoses allowed`);return}o(A),N(null)},G=P=>{if(P===0)return;const T=[...s];[T[P-1],T[P]]=[T[P],T[P-1]],o(T)},W=P=>{if(P===s.length-1)return;const T=[...s];[T[P],T[P+1]]=[T[P+1],T[P]],o(T)},ee=s.filter(P=>P.billable).length,I=()=>{if(!p)return null;const P=e.jsx("div",{ref:h,style:{position:"absolute",top:`${f.top}px`,left:`${f.left}px`,width:`${f.width}px`,zIndex:9999},className:"mt-2 bg-white border-2 border-gray-200 rounded-lg shadow-xl max-h-96 overflow-y-auto",children:c.length>0?c.map((T,L)=>e.jsxs("button",{onClick:()=>R(T),className:"w-full px-4 py-3 text-left hover:bg-blue-50 border-b border-gray-100 last:border-b-0 transition-colors",children:[e.jsx("div",{className:"font-semibold text-gray-900",children:we(T.code)}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:T.description})]},L)):!g&&m.length>=2&&e.jsxs("div",{className:"p-4 text-center text-gray-500",children:['No codes found matching "',m,'"']})});return Je.createPortal(P,document.body)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsxs(X,{children:["Search ICD-10 Codes",e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",ee,"/",d," billable selected)"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:y,type:"text",value:m,onChange:P=>l(P.target.value),placeholder:"Search by code or description (e.g., F41.1 or anxiety)...",disabled:a,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white shadow-sm disabled:bg-gray-100 disabled:cursor-not-allowed"}),g&&e.jsx("div",{className:"absolute right-3 top-3",children:e.jsx("div",{className:"animate-spin h-5 w-5 border-2 border-blue-500 border-t-transparent rounded-full"})})]})]}),I(),v&&e.jsx(ne,{children:v}),s.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-700",children:["Selected Diagnoses (",s.length,")"]}),s.map((P,T)=>e.jsx("div",{className:`bg-white border-2 rounded-lg p-4 ${P.primary?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-bold text-gray-900",children:we(P.code)}),P.primary&&e.jsx("span",{className:"px-2 py-0.5 bg-blue-500 text-white text-xs font-semibold rounded",children:"PRIMARY"}),P.billable&&e.jsx("span",{className:"px-2 py-0.5 bg-green-500 text-white text-xs font-semibold rounded",children:"BILLABLE"})]}),e.jsx("p",{className:"checkbox-label",children:P.description}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-3",children:[i&&e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:P.billable,onChange:L=>J(P.code,"billable",L.target.checked),disabled:a||!P.billable&&ee>=d,className:"checkbox"}),e.jsx("span",{className:"checkbox-label",children:"Billable"})]}),t&&e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"primary-diagnosis",checked:P.primary,onChange:()=>J(P.code,"primary",!0),disabled:a,className:"w-4 h-4 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"checkbox-label",children:"Primary"})]}),u&&e.jsxs("select",{value:P.severity||"",onChange:L=>J(P.code,"severity",L.target.value||null),disabled:a,className:"text-sm border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"-- Severity --"}),_s.map(L=>e.jsx("option",{value:L,children:L},L))]})]})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("button",{onClick:()=>G(T),disabled:a||T===0,className:"p-1 text-gray-500 hover:text-gray-700 disabled:opacity-30 disabled:cursor-not-allowed",title:"Move up",children:"â–²"}),e.jsx("button",{onClick:()=>W(T),disabled:a||T===s.length-1,className:"p-1 text-gray-500 hover:text-gray-700 disabled:opacity-30 disabled:cursor-not-allowed",title:"Move down",children:"â–¼"}),e.jsx("button",{onClick:()=>j(P.code),disabled:a,className:"p-1 text-red-500 hover:text-red-700 disabled:opacity-30 disabled:cursor-not-allowed",title:"Remove",children:"âœ•"})]})]})},P.code))]}),s.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:"No diagnoses selected. Search and select ICD-10 codes above."})]})}function ks({note:s,onChange:o,disabled:d=!1}){const i=(a,m)=>{o(a,m)},t=a=>{i("diagnosis_codes",JSON.stringify(a))};let u=[];try{if(s.diagnosis_codes)if(typeof s.diagnosis_codes=="string"){const a=s.diagnosis_codes.trim();a.length>0&&(u=JSON.parse(a))}else Array.isArray(s.diagnosis_codes)&&(u=s.diagnosis_codes)}catch(a){console.error("Failed to parse diagnosis_codes, using empty array:",a,s.diagnosis_codes),u=[]}return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 border-2 border-purple-200 rounded-xl p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Diagnosis Assessment"}),e.jsx("p",{className:"text-sm text-gray-600",children:"This diagnosis note serves as the clinical source of truth and will automatically sync billable codes to the billing system when signed."})]}),e.jsxs("div",{className:"card-main",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"ICD-10 Diagnosis Codes"}),e.jsx("div",{className:"card-inner",children:e.jsx(Cs,{selectedCodes:u,onChange:t,maxBillable:4,showBillableToggle:!0,showPrimarySelector:!0,showSeveritySelector:!0,disabled:d})})]}),e.jsxs("div",{className:"card-main",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Clinical Assessment"}),e.jsxs("div",{className:"card-inner space-y-6",children:[e.jsxs("div",{children:[e.jsxs(X,{children:["Symptoms Reported by Client",e.jsx("span",{className:"ml-2 text-gray-500 font-normal",children:"(What the client describes)"})]}),e.jsx("textarea",{value:s.symptoms_reported||"",onChange:a=>i("symptoms_reported",a.target.value),disabled:d,rows:4,placeholder:"Document symptoms as reported by the client in their own words...",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none disabled:bg-gray-100 disabled:cursor-not-allowed"})]}),e.jsxs("div",{children:[e.jsxs(X,{children:["Symptoms Observed by Clinician",e.jsx("span",{className:"ml-2 text-gray-500 font-normal",children:"(What you directly observe)"})]}),e.jsx("textarea",{value:s.symptoms_observed||"",onChange:a=>i("symptoms_observed",a.target.value),disabled:d,rows:4,placeholder:"Document observable symptoms, behavioral indicators, presentation...",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none disabled:bg-gray-100 disabled:cursor-not-allowed"})]}),e.jsxs("div",{children:[e.jsx(X,{children:"Duration of Symptoms"}),e.jsx("textarea",{value:s.duration_of_symptoms||"",onChange:a=>i("duration_of_symptoms",a.target.value),disabled:d,rows:2,placeholder:"How long have symptoms been present? When did they begin?",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none disabled:bg-gray-100 disabled:cursor-not-allowed"})]})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Diagnostic Reasoning"}),e.jsxs("div",{className:"card-inner space-y-6",children:[e.jsxs("div",{children:[e.jsxs(X,{children:["Clinical Justification",e.jsx("span",{className:"ml-2 text-gray-500 font-normal",children:"(Why this diagnosis?)"})]}),e.jsx("textarea",{value:s.clinical_justification||"",onChange:a=>i("clinical_justification",a.target.value),disabled:d,rows:5,placeholder:"Explain the clinical reasoning for this diagnosis. Include DSM-5 criteria met, frequency/intensity of symptoms, impact on functioning...",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none disabled:bg-gray-100 disabled:cursor-not-allowed"})]}),e.jsxs("div",{children:[e.jsxs(X,{children:["Differential Diagnosis",e.jsx("span",{className:"ml-2 text-gray-500 font-normal",children:"(What else was considered and ruled out?)"})]}),e.jsx("textarea",{value:s.differential_diagnosis||"",onChange:a=>i("differential_diagnosis",a.target.value),disabled:d,rows:4,placeholder:"Document other diagnoses considered and reasons they were ruled out...",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none disabled:bg-gray-100 disabled:cursor-not-allowed"})]}),e.jsxs("div",{children:[e.jsxs(X,{children:["Severity & Specifiers",e.jsx("span",{className:"ml-2 text-gray-500 font-normal",children:"(Additional clinical details)"})]}),e.jsx("textarea",{value:s.severity_specifiers||"",onChange:a=>i("severity_specifiers",a.target.value),disabled:d,rows:3,placeholder:"Document severity level, course specifiers, additional features (e.g., 'with anxious distress', 'in partial remission')...",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none disabled:bg-gray-100 disabled:cursor-not-allowed"})]})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Functional Impact"}),e.jsxs("div",{className:"card-inner",children:[e.jsxs(X,{children:["Functional Impairment",e.jsx("span",{className:"ml-2 text-gray-500 font-normal",children:"(How symptoms affect daily life and functioning)"})]}),e.jsx("textarea",{value:s.functional_impairment||"",onChange:a=>i("functional_impairment",a.target.value),disabled:d,rows:4,placeholder:"Document impact on work, relationships, self-care, social functioning, occupational performance...",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none disabled:bg-gray-100 disabled:cursor-not-allowed"})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Diagnosis History"}),e.jsxs("div",{className:"card-inner",children:[e.jsxs(X,{children:["Previous Diagnoses",e.jsx("span",{className:"ml-2 text-gray-500 font-normal",children:"(Prior diagnostic history and changes)"})]}),e.jsx("textarea",{value:s.previous_diagnoses||"",onChange:a=>i("previous_diagnoses",a.target.value),disabled:d,rows:3,placeholder:"Document previous diagnoses, when they were assigned, by whom, and any changes or revisions...",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none disabled:bg-gray-100 disabled:cursor-not-allowed"})]})]}),e.jsxs("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-xl p-6",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"ðŸ“‹ Billing Integration"}),e.jsx("p",{className:"text-sm text-blue-800",children:"When you sign this diagnosis note, the following will happen automatically:"}),e.jsxs("ul",{className:"list-disc list-inside text-sm text-blue-800 mt-2 space-y-1",children:[e.jsxs("li",{children:["Billable diagnoses (",u.filter(a=>a.billable).length," selected) will be added to the billing system"]}),e.jsx("li",{children:"Previous diagnoses will be marked as inactive"}),e.jsx("li",{children:"This note becomes the source of truth for all clinical documentation"}),e.jsx("li",{children:"Other notes will reference these diagnoses automatically"})]})]})]})}function Ss({note:s,onChange:o,autoSave:d}){const i=(a,m)=>{o(a,m),d&&setTimeout(()=>d(),500)},t=a=>(s.treatmentPlan||{})[a]||"",u=(a,m)=>{const l=s.treatmentPlan||{};i("treatmentPlan",{...l,[a]:m})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-blue",children:[e.jsx("span",{className:"mr-2",children:"ðŸŽ¯"}),"Treatment Goals"]}),e.jsx("div",{className:"text-sm text-gray-600 mb-3",children:"What are the primary goals of treatment? What does the client hope to achieve?"}),e.jsx("textarea",{value:t("goals"),onChange:a=>u("goals",a.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none bg-white shadow-sm",rows:"5",placeholder:`Example:
1. Reduce anxiety symptoms to manageable levels
2. Develop healthy coping strategies for stress
3. Improve relationships with family members
4. Return to work/school functioning`})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-blue",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“"}),"Target Behaviors & Objectives"]}),e.jsx("div",{className:"text-sm text-gray-600 mb-3",children:"Specific, measurable objectives. What behaviors or symptoms will change?"}),e.jsx("textarea",{value:t("objectives"),onChange:a=>u("objectives",a.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none bg-white shadow-sm",rows:"5",placeholder:`Example:
- Client will identify and challenge 3 cognitive distortions per week
- Client will practice deep breathing exercises daily
- Client will attend all scheduled sessions
- Client will report anxiety level of 5 or below (0-10 scale) within 8 weeks`})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-blue",children:[e.jsx("span",{className:"mr-2",children:"ðŸ› ï¸"}),"Interventions & Treatment Modalities"]}),e.jsx("div",{className:"text-sm text-gray-600 mb-3",children:"What therapeutic approaches, techniques, or interventions will be used?"}),e.jsx("textarea",{value:t("interventions"),onChange:a=>u("interventions",a.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none bg-white shadow-sm",rows:"5",placeholder:`Example:
- Cognitive Behavioral Therapy (CBT)
- Dialectical Behavior Therapy (DBT) skills training
- Mindfulness and relaxation techniques
- EMDR for trauma processing
- Family therapy sessions (as needed)
- Psychoeducation about anxiety/depression`})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-blue",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“…"}),"Treatment Frequency & Expected Duration"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Session Frequency"}),e.jsx("textarea",{value:t("frequency"),onChange:a=>u("frequency",a.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none bg-white shadow-sm",rows:"2",placeholder:"Example: Weekly 50-minute sessions, with option to increase to twice weekly if needed"})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Expected Duration of Treatment"}),e.jsx("textarea",{value:t("duration"),onChange:a=>u("duration",a.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none bg-white shadow-sm",rows:"2",placeholder:"Example: 12-16 weeks of weekly therapy, with ongoing reassessment of progress"})]})})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-blue",children:[e.jsx("span",{className:"mr-2",children:"âš ï¸"}),"Potential Barriers & Mitigation Strategies"]}),e.jsx("div",{className:"text-sm text-gray-600 mb-3",children:"What might interfere with treatment success? How will barriers be addressed?"}),e.jsx("textarea",{value:t("barriers"),onChange:a=>u("barriers",a.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none bg-white shadow-sm",rows:"4",placeholder:`Example:
- Transportation issues â†’ Offer telehealth options
- Work schedule conflicts â†’ Offer early morning or evening appointments
- Financial concerns â†’ Sliding scale fee, connect with financial assistance resources
- Language barriers â†’ Provide interpreter services`})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-blue",children:[e.jsx("span",{className:"mr-2",children:"âœ…"}),"Discharge Criteria & Success Indicators"]}),e.jsx("div",{className:"text-sm text-gray-600 mb-3",children:"How will we know treatment has been successful? What indicates readiness for discharge?"}),e.jsx("textarea",{value:t("dischargeCriteria"),onChange:a=>u("dischargeCriteria",a.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none bg-white shadow-sm",rows:"4",placeholder:`Example:
- Client reports anxiety symptoms manageable without therapy support
- Client demonstrates consistent use of coping skills
- Client feels confident managing stressors independently
- Client has achieved treatment goals
- Client expresses readiness to discontinue therapy`})]}),e.jsxs("div",{className:"card-main bg-blue-50 border-2 border-blue-300",children:[e.jsxs("h3",{className:"section-header-blue",children:[e.jsx("span",{className:"mr-2",children:"ðŸ¤"}),"Client Agreement & Collaboration"]}),e.jsx("div",{className:"text-sm text-gray-600 mb-3",children:"Document client's understanding, agreement, and input on the treatment plan"}),e.jsx("textarea",{value:t("clientAgreement"),onChange:a=>u("clientAgreement",a.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none bg-white shadow-sm",rows:"3",placeholder:"Example: Client reviewed treatment plan and expressed agreement with goals and proposed interventions. Client voiced concerns about time commitment, and we agreed to reassess frequency after 4 weeks."})]})]})}function Ds({note:s,onChange:o,autoSave:d}){const i=(a,m)=>{o(a,m),d&&setTimeout(()=>d(),500)},t=[{value:"noshow",label:"No Show",description:"Client did not attend, no notice given"},{value:"late_cancel",label:"Late Cancellation",description:"Canceled within 24 hours of appointment"},{value:"cancel",label:"Cancellation",description:"Canceled with adequate notice"},{value:"late_arrival",label:"Late Arrival",description:"Client arrived late to session"}],u=s.appointmentStatus||"noshow";return t.find(a=>a.value===u),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card-main bg-gray-50",children:[e.jsxs("h3",{className:"section-header-gray",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“…"}),"Appointment Status"]}),e.jsx("div",{className:"space-y-3",children:t.map(a=>e.jsxs("label",{className:`flex items-start gap-3 p-4 rounded-lg border-2 cursor-pointer transition-all ${u===a.value?"border-blue-500 bg-blue-50":"border-gray-300 bg-white hover:border-gray-400"}`,children:[e.jsx("input",{type:"radio",name:"appointmentStatus",value:a.value,checked:u===a.value,onChange:m=>i("appointmentStatus",m.target.value),className:"mt-1 w-4 h-4 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-gray-900",children:a.label}),e.jsx("div",{className:"text-sm text-gray-600",children:a.description})]})]},a.value))})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-gray",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“"}),"Reason / Additional Details"]}),e.jsx("textarea",{value:s.statusReason||"",onChange:a=>i("statusReason",a.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none bg-white shadow-sm",rows:"4",placeholder:"Provide additional context: Why did the client cancel? When were you notified? Any relevant circumstances?"})]}),e.jsxs("div",{className:"card-main bg-yellow-50 border-2 border-yellow-300",children:[e.jsxs("h3",{className:"section-header-gray",children:[e.jsx("span",{className:"mr-2",children:"ðŸ’°"}),"Billing Impact"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:s.chargeApplied||!1,onChange:a=>i("chargeApplied",a.target.checked),className:"checkbox"}),e.jsx("span",{className:"checkbox-label",children:"Late cancellation/no-show charge applied"})]}),s.chargeApplied&&e.jsx("textarea",{value:s.chargeDetails||"",onChange:a=>i("chargeDetails",a.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none bg-white shadow-sm",rows:"2",placeholder:"Charge amount and details..."})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-gray",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“ž"}),"Follow-up Action"]}),e.jsx("textarea",{value:s.followUpAction||"",onChange:a=>i("followUpAction",a.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none bg-white shadow-sm",rows:"3",placeholder:"What follow-up is needed? Call client to reschedule? Send reminder? Review cancellation policy?"})]})]})}function Ps({note:s,onChange:o,autoSave:d}){const i=(a,m)=>{o(a,m),d&&setTimeout(()=>d(),500)},t=[{value:"phone",label:"ðŸ“ž Phone Call",icon:"ðŸ“ž"},{value:"email",label:"ðŸ“§ Email",icon:"ðŸ“§"},{value:"text",label:"ðŸ’¬ Text Message",icon:"ðŸ’¬"},{value:"portal",label:"ðŸŒ Patient Portal",icon:"ðŸŒ"},{value:"voicemail",label:"ðŸŽ™ï¸ Voicemail",icon:"ðŸŽ™ï¸"}],u=s.contactMethod||"phone";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card-main bg-blue-50",children:[e.jsxs("h3",{className:"section-header-gray",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“ž"}),"Contact Method"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:t.map(a=>e.jsxs("label",{className:`flex flex-col items-center gap-2 p-4 rounded-lg border-2 cursor-pointer transition-all ${u===a.value?"border-blue-500 bg-blue-100":"border-gray-300 bg-white hover:border-gray-400"}`,children:[e.jsx("input",{type:"radio",name:"contactMethod",value:a.value,checked:u===a.value,onChange:m=>i("contactMethod",m.target.value),className:"sr-only"}),e.jsx("div",{className:"text-3xl",children:a.icon}),e.jsx("div",{className:"text-sm font-semibold text-gray-800 text-center",children:a.label.replace(/^.+ /,"")})]},a.value))})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-gray",children:[e.jsx("span",{className:"mr-2",children:"ðŸ•"}),"Date & Time of Contact"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Date"}),e.jsx("input",{type:"date",value:s.contactDate||"",onChange:a=>i("contactDate",a.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white shadow-sm"})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:"Time"}),e.jsx("input",{type:"time",value:s.contactTime||"",onChange:a=>i("contactTime",a.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white shadow-sm"})]})})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-gray",children:[e.jsx("span",{className:"mr-2",children:"â“"}),"Reason for Contact"]}),e.jsx("textarea",{value:s.contactReason||"",onChange:a=>i("contactReason",a.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none bg-white shadow-sm",rows:"3",placeholder:"Why did the client reach out? What did they need or want to discuss?"})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-gray",children:[e.jsx("span",{className:"mr-2",children:"ðŸ’¬"}),"Summary of Communication"]}),e.jsx("textarea",{value:s.communicationSummary||"",onChange:a=>i("communicationSummary",a.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none bg-white shadow-sm",rows:"5",placeholder:"Summarize the content of the communication. What was discussed? What information was provided?"})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"section-header-gray",children:[e.jsx("span",{className:"mr-2",children:"âœ…"}),"Action Taken / Response Provided"]}),e.jsx("textarea",{value:s.actionTaken||"",onChange:a=>i("actionTaken",a.target.value),className:"w-full px-4 py-3 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none bg-white shadow-sm",rows:"4",placeholder:"How did you respond? What actions were taken? Any referrals or resources provided? Follow-up needed?"})]}),e.jsxs("div",{className:"card-main bg-orange-50 border-2 border-orange-300",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.urgentFlag||!1,onChange:a=>i("urgentFlag",a.target.checked),className:"w-5 h-5 text-orange-600 rounded focus:ring-orange-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"âš ï¸ Urgent or Crisis-Related Contact"}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Check if this contact involved safety concerns, crisis, or urgent clinical needs"})]})]}),s.urgentFlag&&e.jsx("div",{className:"mt-4",children:e.jsx("textarea",{value:s.urgentDetails||"",onChange:a=>i("urgentDetails",a.target.value),className:"w-full px-4 py-3 border-2 border-orange-400 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 resize-none bg-white shadow-sm",rows:"3",placeholder:"Describe the urgent nature of the contact and actions taken to address safety/crisis concerns..."})})]})]})}function As({noteType:s,patientId:o,appointmentId:d=null,serviceDate:i,onSave:t,onCancel:u}){const[a,m]=x.useState(""),[l,c]=x.useState(!1),[b,g]=x.useState(""),[n,p]=x.useState(""),[r,v]=x.useState(!1),[N,f]=x.useState(!0),[_,k]=x.useState(!1),[h,y]=x.useState(null),R=s==="noshow",j=s==="cancel",J=async G=>{G.preventDefault(),k(!0),y(null);try{let W="";R?(W=`CLIENT DID NOT ATTEND SCHEDULED APPOINTMENT

`,a&&(W+=`Reason (if known): ${a}

`),l?(W+=`Contact Attempted: Yes
`,W+=`Method: ${b}
`,W+=`Result: ${n}

`):W+=`Contact Attempted: No

`,W+=`Plan: ${r?"Billable no-show fee applies.":"No-show fee waived."} Will follow up to reschedule.`):j&&(W=`APPOINTMENT CANCELLED

`,a&&(W+=`Reason: ${a}

`),W+="Plan: Will reschedule as needed.");const I=await pe({patientId:o,appointmentId:d,noteType:s,serviceDate:i,templateType:"quick",plan:W,status:N?"signed":"draft"});N&&I.noteId&&await Ee(I.noteId),t&&t(I)}catch(W){console.error("Error saving quick note:",W),y(W.message||"Failed to save note")}finally{k(!1)}};return e.jsx("div",{className:"max-w-2xl mx-auto p-6",children:e.jsxs("div",{className:"card-main",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-2",children:R?"âŒ No-Show Note":"ðŸš« Cancellation Note"}),e.jsxs("p",{className:"text-gray-600",children:["Quick documentation for ",R?"missed appointment":"cancelled session"]})]}),h&&e.jsx(ne,{children:h}),e.jsxs("form",{onSubmit:J,className:"space-y-6",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-label block mb-2",children:R?"Reason (if known)":"Reason for Cancellation"}),e.jsx("textarea",{value:a,onChange:G=>m(G.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:"3",placeholder:R?"e.g., Client called to report illness":"e.g., Family emergency"})]})}),R&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[e.jsxs("label",{className:"flex items-center gap-3 mb-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:l,onChange:G=>c(G.target.checked),className:"checkbox"}),e.jsx("span",{className:"font-semibold text-gray-800",children:"Attempted to contact client"})]}),l&&e.jsxs("div",{className:"space-y-3 ml-8",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700 mb-1 block",children:"Contact Method"}),e.jsxs("select",{value:b,onChange:G=>g(G.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select method..."}),e.jsx("option",{value:"Phone",children:"Phone"}),e.jsx("option",{value:"Email",children:"Email"}),e.jsx("option",{value:"Text/SMS",children:"Text/SMS"}),e.jsx("option",{value:"Patient Portal",children:"Patient Portal"})]})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700 mb-1 block",children:"Result"}),e.jsxs("select",{value:n,onChange:G=>p(G.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select result..."}),e.jsx("option",{value:"Left voicemail",children:"Left voicemail"}),e.jsx("option",{value:"Spoke with client",children:"Spoke with client"}),e.jsx("option",{value:"No answer",children:"No answer"}),e.jsx("option",{value:"Message sent",children:"Message sent"}),e.jsx("option",{value:"Awaiting response",children:"Awaiting response"})]})]})})]})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r,onChange:G=>v(G.target.checked),className:"checkbox"}),e.jsx("span",{className:"font-semibold text-gray-800",children:"Apply no-show fee (billable)"})]})})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:N,onChange:G=>f(G.target.checked),className:"checkbox"}),e.jsx("span",{className:"font-semibold text-gray-800",children:"Sign and lock note immediately"})]}),e.jsx("p",{className:"text-xs text-gray-600 ml-8 mt-1",children:"Recommended for simple administrative notes"})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:u,disabled:_,className:"flex-1 px-6 py-3 bg-gray-500 text-white font-semibold rounded-xl hover:bg-gray-600 transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:_,className:"flex-1 px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white font-semibold rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:_?"Saving...":"Save Note"})]})]})]})})}function Es({patient:s,provider:o,serviceInfo:d,diagnosis:i,serviceDate:t}){const u=l=>{if(!l)return"N/A";const[c,b,g]=l.split(/[-T]/);return new Date(c,b-1,g).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})},a=l=>{if(!l)return"Not set";const c=Math.floor(l/60),b=l%60;return c>0&&b>0?`${c}h ${b}m`:c>0?`${c}h`:`${b}m`},m=l=>{if(!l)return"";const c=l.split(/\s{3,}/);return c.length>1?c[1].trim():l.trim()};return e.jsxs("div",{className:"card-main mb-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wide mb-3",children:"Patient Information"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Name:"}),e.jsxs("span",{className:"text-base font-semibold text-gray-900",children:[s?.fname," ",s?.mname," ",s?.lname]})]}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"DOB:"}),e.jsxs("span",{className:"text-sm text-gray-800",children:[s?.DOB?u(s.DOB):"N/A",s?.DOB&&e.jsxs("span",{className:"ml-2 text-gray-500",children:["(Age ",new Date().getFullYear()-new Date(s.DOB).getFullYear(),")"]})]})]}),s?.pid&&e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Patient ID:"}),e.jsx("span",{className:"text-sm text-gray-800 font-mono",children:s.pid})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wide mb-3",children:"Service Information"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Provider:"}),e.jsxs("span",{className:"text-base font-semibold text-gray-900",children:[o?.fullName||o?.fname+" "+o?.lname,o?.credentials&&e.jsx("span",{className:"ml-2 text-sm font-normal text-gray-600",children:o.credentials})]})]}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Date:"}),e.jsx("span",{className:"text-sm text-gray-800 font-semibold",children:u(t)})]}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Type:"}),e.jsx("span",{className:"text-sm text-gray-800",children:d?.type||"Individual Therapy"})]}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Location:"}),e.jsx("span",{className:"text-sm text-gray-800",children:d?.location||"Office"})]}),d?.duration&&e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Duration:"}),e.jsx("span",{className:"text-sm text-gray-800",children:a(d.duration)})]})]})]})]}),i&&e.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-600",children:"Primary Diagnosis:"}),e.jsx("span",{className:"text-sm text-gray-900 font-medium",children:m(i)})]})})]})}const Rs=(s,o=null)=>s==="progress"&&o?o:{progress:"BIRP",intake:"Intake",diagnosis:"Diagnosis",treatment_plan:"TreatmentPlan",mse:"MSE",discharge:"Discharge",crisis:"Crisis",risk_assessment:"RiskAssessment",appointment_status:"AppointmentStatus",client_communication:"ClientCommunication",case_management:"CaseManagement",admin:"Administrative",noshow:"AppointmentStatus",cancel:"AppointmentStatus"}[s]||"BIRP";function he({noteId:s=null,patientId:o,appointmentId:d=null,noteType:i,templateFormat:t=null,onClose:u,onSave:a}){const m=Rs(i,t),[l,c]=x.useState({patientId:o,appointmentId:d,noteType:i,templateType:m,serviceDate:new Date().toISOString().split("T")[0],behaviorProblem:"",intervention:"",response:"",plan:"",riskPresent:!1,riskAssessment:"",interventionsSelected:[],clientPresentation:[],goalsAddressed:[],status:"draft"}),[b,g]=x.useState(!1),[n,p]=x.useState(!1),[r,v]=x.useState(!1),[N,f]=x.useState(null),[_,k]=x.useState(null),[h,y]=x.useState(null),[R,j]=x.useState(null),[J,G]=x.useState(null),[W,ee]=x.useState(null),[I,P]=x.useState(null),T=x.useRef(null),L=x.useRef(s);x.useEffect(()=>{A(),E(),z()},[s,d,o]),x.useEffect(()=>(T.current&&clearTimeout(T.current),T.current=setTimeout(()=>{M()},3e3),()=>{T.current&&clearTimeout(T.current)}),[l]);const A=async()=>{g(!0),k(null);try{if(s){const D=await Ae(s);c({...l,...D.note}),L.current=s}else{const D={};d?D.appointment_id=d:o&&(D.patient_id=o);try{const K=await os(D);if(K.draft){const oe=K.draft.draft_content;oe.noteType===i?(c({...l,...oe}),console.log("Restored draft from server")):console.log("Server draft note type mismatch, skipping restore. Expected:",i,"Got:",oe.noteType)}}catch{console.log("No draft found, starting fresh")}const Q=localStorage.getItem(`note_draft_${o}_${d||"new"}_${i}`);if(Q)try{const K=JSON.parse(Q);K.noteType===i?(c({...l,...K}),console.log("Restored draft from localStorage")):(console.log("Draft note type mismatch, skipping restore"),localStorage.removeItem(`note_draft_${o}_${d||"new"}_${i}`))}catch{console.error("Failed to parse localStorage draft")}}}catch(D){console.error("Error loading note:",D),k(D.message)}finally{g(!1)}},E=async()=>{try{const D=await hs();y(D.settings),!l.templateType&&D.settings.default_note_template&&c(Q=>({...Q,templateType:D.settings.default_note_template}))}catch(D){console.error("Error loading settings:",D)}},z=async()=>{try{if(o)try{const D=await De(o);if(console.log("âœ… Patient data loaded:",D),j(D.patient),D.problems&&D.problems.length>0){const Q=D.problems[0],K=Q.title||Q.diagnosis||null;P(K),console.log("âœ… Primary diagnosis loaded:",K)}}catch(D){console.error("âŒ Error loading patient data:",D)}try{const D=await Se();console.log("âœ… Provider data loaded:",D),G(D)}catch(D){console.error("âŒ Error loading provider data:",D)}ee({type:"Individual Therapy",location:"Office",duration:null})}catch(D){console.error("âŒ Error loading metadata:",D)}},M=x.useCallback(async()=>{if(!(l.status==="signed"||l.is_locked)){v(!0);try{localStorage.setItem(`note_draft_${o}_${d||"new"}_${l.noteType}`,JSON.stringify(l));const D={noteId:L.current,patientId:l.patientId,appointmentId:l.appointmentId,noteType:l.noteType,serviceDate:l.serviceDate,draftContent:l};await ns(D),f(new Date)}catch(D){console.error("Auto-save failed:",D)}finally{v(!1)}}},[l,o,d]),H=(D,Q)=>{c(K=>({...K,[D]:Q}))},V=async()=>{p(!0),k(null);try{if(L.current)await ye(L.current,l);else{const D=await pe(l);L.current=D.noteId}f(new Date),a&&a({noteId:L.current,status:"draft"})}catch(D){console.error("Error saving draft:",D),k(D.message)}finally{p(!1)}},C=async()=>{p(!0),k(null);try{if(L.current)await ye(L.current,l);else{const D=await pe({...l,status:"draft"});L.current=D.noteId}await Ee(L.current),localStorage.removeItem(`note_draft_${o}_${d||"new"}_${l.noteType}`),a&&a({noteId:L.current,status:"signed"}),u&&u()}catch(D){console.error("Error signing note:",D),k(D.message)}finally{p(!1)}},O=()=>{u&&u()},F=async()=>{if(window.confirm("Are you sure you want to delete this draft? This cannot be undone.")){p(!0),k(null);try{await is(L.current),localStorage.removeItem(`note_draft_${o}_${d||"new"}_${l.noteType}`),u&&u()}catch(D){console.error("Error deleting note:",D),k("Failed to delete note: "+D.message)}finally{p(!1)}}};return i==="noshow"||i==="cancel"?e.jsx(As,{noteType:i,patientId:o,appointmentId:d,serviceDate:l.serviceDate,onSave:a,onCancel:u}):b?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx("div",{className:"text-gray-600",children:"Loading note..."})}):e.jsxs("div",{className:"max-w-5xl mx-auto p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h1",{className:"text-2xl font-semibold text-gray-800",children:[i==="progress"&&`ðŸ“ Progress Note (${l.templateType})`,i==="intake"&&"ðŸ‘‹ Intake Assessment",i==="crisis"&&"âš ï¸ Crisis Note",i==="discharge"&&"âœ… Discharge Summary",i==="mse"&&"ðŸ§  Mental Status Exam",i==="risk_assessment"&&"ðŸ›¡ï¸ Risk Assessment",i==="diagnosis"&&"ðŸ¥ Diagnosis Note",i==="case_management"&&"ðŸ¤ Case Management Note",i==="treatment_plan"&&"ðŸ“‹ Treatment Plan",i==="appointment_status"&&"ðŸ“… Appointment Status",i==="client_communication"&&"ðŸ“ž Client Communication",i==="admin"&&"ðŸ“‹ Administrative Note"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[r&&e.jsx("span",{className:"text-sm text-blue-600",children:"Saving..."}),N&&!r&&e.jsxs("span",{className:"text-sm text-gray-600",children:["Saved ",N.toLocaleTimeString()]})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Service Date:"}),e.jsx("input",{type:"date",value:l.serviceDate,onChange:D=>H("serviceDate",D.target.value),className:"px-3 py-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})})]}),_&&e.jsx(ne,{children:_}),(R||J)&&e.jsx(Es,{patient:R,provider:J,serviceInfo:W,diagnosis:I,serviceDate:l.serviceDate}),e.jsxs("div",{className:"mb-6",children:[l.templateType==="BIRP"&&e.jsx(xs,{note:l,onChange:H,patientId:o,autoSave:M}),l.templateType==="PIRP"&&e.jsx(us,{note:l,onChange:H,patientId:o,autoSave:M}),l.templateType==="SOAP"&&e.jsx(gs,{note:l,onChange:H,patientId:o,autoSave:M}),l.templateType==="CaseManagement"&&e.jsx(ps,{note:l,onChange:H,autoSave:M}),l.templateType==="MSE"&&e.jsx(bs,{note:l,onChange:H,autoSave:M}),l.templateType==="Intake"&&e.jsx(vs,{note:l,onChange:H,autoSave:M}),l.templateType==="Discharge"&&e.jsx(js,{note:l,onChange:H,autoSave:M}),l.templateType==="Crisis"&&e.jsx(Ns,{note:l,onChange:H,autoSave:M}),l.templateType==="RiskAssessment"&&e.jsx(ys,{note:l,onChange:H,autoSave:M}),l.templateType==="Diagnosis"&&e.jsx(ks,{note:l,onChange:H,disabled:l.is_locked}),l.templateType==="TreatmentPlan"&&e.jsx(Ss,{note:l,onChange:H,autoSave:M}),l.templateType==="AppointmentStatus"&&e.jsx(Ds,{note:l,onChange:H,autoSave:M}),l.templateType==="ClientCommunication"&&e.jsx(Ps,{note:l,onChange:H,autoSave:M}),l.templateType==="Administrative"&&e.jsx(ws,{note:l,onChange:H,autoSave:M})]}),e.jsx("div",{className:"sticky bottom-6 mt-8",children:e.jsx("div",{className:"card-main shadow-2xl",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:O,disabled:n,className:"px-6 py-3 bg-gray-500 text-white font-semibold rounded-xl hover:bg-gray-600 transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),L.current&&!l.is_locked&&l.status!=="signed"&&e.jsx("button",{type:"button",onClick:F,disabled:n,className:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white font-semibold rounded-xl hover:from-red-600 hover:to-red-700 transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"ðŸ—‘ï¸ Delete Draft"}),e.jsx("button",{type:"button",onClick:V,disabled:n||r,className:"flex-1 px-6 py-3 bg-gradient-to-r from-purple-500 to-purple-600 text-white font-semibold rounded-xl hover:from-purple-600 hover:to-purple-700 transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Saving...":"Save Draft"}),e.jsx("button",{type:"button",onClick:C,disabled:n||r,className:"flex-1 px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-500 text-white font-semibold rounded-xl hover:from-green-600 hover:to-emerald-600 transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Signing...":"âœ“ Sign & Lock Note"})]})})})]})}function Re({noteId:s,onClose:o,onEdit:d,onAddendum:i}){const[t,u]=x.useState(null),[a,m]=x.useState(!0),[l,c]=x.useState(null);x.useEffect(()=>{b()},[s]);const b=async()=>{m(!0),c(null);try{const N=await Ae(s);u(N.note)}catch(N){console.error("Error loading note:",N),c(N.message)}finally{m(!1)}},g=N=>{if(!N)return"N/A";const[f,_,k]=N.split(/[-T]/);return new Date(f,_-1,k).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})},n=N=>N?new Date(N).toLocaleString("en-US",{month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"}):"N/A",p=N=>{if(!N)return"";const f=N.split(/\s{3,}/);return f.length>1?f[1].trim():N.trim()};if(a)return e.jsx("div",{className:"max-w-4xl mx-auto p-6",children:e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx("div",{className:"text-gray-600",children:"Loading note..."})})});if(l)return e.jsx("div",{className:"max-w-4xl mx-auto p-6",children:e.jsxs("div",{className:"card-main text-center p-12",children:[e.jsxs(ce,{children:["Error: ",l]}),e.jsx("button",{onClick:o,className:"btn-secondary",children:"Close"})]})});if(!t)return null;const r=t.is_locked||t.status==="signed",v=t.status==="draft";return e.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h1",{className:"text-2xl font-semibold text-gray-800",children:[t.note_type==="progress"&&"ðŸ“ Progress Note",t.note_type==="intake"&&"ðŸ‘‹ Intake Assessment",t.note_type==="crisis"&&"âš ï¸ Crisis Note",t.note_type==="discharge"&&"âœ… Discharge Summary",t.note_type==="mse"&&"ðŸ§  Mental Status Exam",t.note_type==="diagnosis"&&"ðŸ¥ Diagnosis Note",t.note_type==="admin"&&"ðŸ“‹ Administrative Note"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[r&&e.jsx("span",{className:"badge-sm badge-light-success",children:"ðŸ”’ Signed & Locked"}),v&&e.jsx("span",{className:"badge-sm badge-light-warning",children:"Draft"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 font-semibold",children:"Service Date:"}),e.jsx("div",{className:"text-gray-800",children:g(t.service_date)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 font-semibold",children:"Provider:"}),e.jsx("div",{className:"text-gray-800",children:t.provider_name||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 font-semibold",children:"Created:"}),e.jsx("div",{className:"text-gray-800",children:n(t.created_at)})]}),t.signed_at&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 font-semibold",children:"Signed:"}),e.jsx("div",{className:"text-gray-800",children:n(t.signed_at)})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[t.template_type==="Diagnosis"&&e.jsxs(e.Fragment,{children:[t.diagnosis_codes&&t.diagnosis_codes.length>0&&e.jsxs("div",{className:"card-main",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"ðŸ¥ ICD-10 Diagnosis Codes"}),e.jsx("div",{className:"space-y-2",children:t.diagnosis_codes.map((N,f)=>{const _=N.code||N,k=N.description||"",h=N.isPrimary||!1,y=N.billable||!1,R=N.severity||null,j=_.length>=4?_.slice(0,3)+"."+_.slice(3):_;return e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg border-l-4 border-blue-400",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-mono text-sm font-semibold text-blue-700 bg-blue-100 px-2 py-0.5 rounded",children:j}),e.jsxs("div",{className:"flex gap-2",children:[h&&e.jsx("span",{className:"badge-sm badge-light-primary",children:"Primary"}),y&&e.jsx("span",{className:"badge-sm badge-light-success",children:"Billable"}),R&&e.jsx("span",{className:"badge-sm badge-light-warning",children:R})]})]}),k&&e.jsx("div",{className:"text-gray-800",children:p(k)})]})},f)})})]}),(t.symptoms_reported||t.symptoms_observed||t.duration_of_symptoms)&&e.jsxs("div",{className:"card-main",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-4",children:"Clinical Assessment"}),e.jsxs("div",{className:"space-y-4",children:[t.symptoms_reported&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-gray-600 mb-1",children:"Symptoms Reported by Client"}),e.jsx("div",{className:"text-gray-700 whitespace-pre-wrap",children:t.symptoms_reported})]}),t.symptoms_observed&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-gray-600 mb-1",children:"Symptoms Observed by Clinician"}),e.jsx("div",{className:"text-gray-700 whitespace-pre-wrap",children:t.symptoms_observed})]}),t.duration_of_symptoms&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-gray-600 mb-1",children:"Duration of Symptoms"}),e.jsx("div",{className:"text-gray-700 whitespace-pre-wrap",children:t.duration_of_symptoms})]})]})]}),(t.clinical_justification||t.differential_diagnosis||t.severity_specifiers)&&e.jsxs("div",{className:"card-main",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-4",children:"Diagnostic Reasoning"}),e.jsxs("div",{className:"space-y-4",children:[t.clinical_justification&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-gray-600 mb-1",children:"Clinical Justification"}),e.jsx("div",{className:"text-gray-700 whitespace-pre-wrap",children:t.clinical_justification})]}),t.differential_diagnosis&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-gray-600 mb-1",children:"Differential Diagnosis"}),e.jsx("div",{className:"text-gray-700 whitespace-pre-wrap",children:t.differential_diagnosis})]}),t.severity_specifiers&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-gray-600 mb-1",children:"Severity Specifiers"}),e.jsx("div",{className:"text-gray-700 whitespace-pre-wrap",children:t.severity_specifiers})]})]})]}),t.functional_impairment&&e.jsxs("div",{className:"card-main",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"Functional Impairment"}),e.jsx("div",{className:"text-gray-700 whitespace-pre-wrap",children:t.functional_impairment})]}),t.previous_diagnoses&&e.jsxs("div",{className:"card-main",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"Previous Diagnoses"}),e.jsx("div",{className:"text-gray-700 whitespace-pre-wrap",children:t.previous_diagnoses})]})]}),t.template_type==="BIRP"&&e.jsxs(e.Fragment,{children:[t.behavior_problem&&e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 mb-3",children:[e.jsx("span",{className:"text-blue-600 mr-2",children:"B"}),"Behavior / Observations"]}),e.jsx("div",{className:"text-gray-700 whitespace-pre-wrap",children:t.behavior_problem}),t.client_presentation&&t.client_presentation.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:t.client_presentation.map((N,f)=>e.jsx("span",{className:"badge-sm badge-light-info",children:N},f))})]}),(t.intervention||t.interventions_selected&&t.interventions_selected.length>0)&&e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 mb-3",children:[e.jsx("span",{className:"text-blue-600 mr-2",children:"I"}),"Interventions Used"]}),t.intervention&&e.jsx("div",{className:"text-gray-700 whitespace-pre-wrap mb-3",children:t.intervention}),t.interventions_selected&&t.interventions_selected.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-gray-600 mb-2",children:"Selected Interventions:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.interventions_selected.map((N,f)=>e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:N},f))})]})]}),t.response&&e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 mb-3",children:[e.jsx("span",{className:"text-blue-600 mr-2",children:"R"}),"Client Response"]}),e.jsx("div",{className:"text-gray-700 whitespace-pre-wrap",children:t.response})]}),t.plan&&e.jsxs("div",{className:"card-main",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 mb-3",children:[e.jsx("span",{className:"text-blue-600 mr-2",children:"P"}),"Plan / Next Steps"]}),e.jsx("div",{className:"text-gray-700 whitespace-pre-wrap",children:t.plan})]})]}),t.risk_present&&t.risk_assessment&&e.jsxs("div",{className:"card-main bg-orange-50 border-2 border-orange-300",children:[e.jsx("h3",{className:"font-semibold text-orange-800 mb-3",children:"âš ï¸ Risk Assessment"}),e.jsx("div",{className:"text-gray-800 whitespace-pre-wrap",children:t.risk_assessment})]}),t.addenda&&t.addenda.length>0&&e.jsxs("div",{className:"card-main bg-blue-50 border-2 border-blue-300",children:[e.jsxs("h3",{className:"font-semibold text-blue-800 mb-3",children:["ðŸ“Ž Addenda (",t.addenda.length,")"]}),e.jsx("div",{className:"space-y-3",children:t.addenda.map((N,f)=>e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-lg p-4 border border-blue-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-semibold text-gray-800",children:["Addendum ",f+1]}),e.jsxs("span",{className:"text-xs text-gray-600",children:[n(N.created_at)," â€¢ ",N.provider_name]})]}),e.jsxs("div",{className:"text-sm text-gray-700 mb-2",children:[e.jsx("span",{className:"font-semibold",children:"Reason:"})," ",N.addendum_reason]})]},N.id))})]}),r&&e.jsx("div",{className:"card-main bg-green-50 border-2 border-green-300",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:"âœ…"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-green-800",children:"Digitally Signed"}),e.jsxs("div",{className:"checkbox-label",children:[t.signed_by_name," â€¢ ",n(t.signed_at)]})]})]})})]}),e.jsxs("div",{className:"flex gap-3 mt-8 pt-6 border-t border-gray-200",children:[e.jsx("button",{onClick:o,className:"px-6 py-3 bg-gray-500 text-white font-semibold rounded-xl hover:bg-gray-600 transition-all shadow-lg",children:"Close"}),v&&d&&e.jsx("button",{onClick:()=>d(t.id),className:"flex-1 px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white font-semibold rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all shadow-lg",children:"Edit Draft"}),r&&i&&e.jsx("button",{onClick:()=>i(t.id),className:"flex-1 px-6 py-3 bg-gradient-to-r from-purple-500 to-purple-600 text-white font-semibold rounded-xl hover:from-purple-600 hover:to-purple-700 transition-all shadow-lg",children:"Add Addendum"})]})]})}function Fs({data:s}){const[o,d]=x.useState(!1),[i,t]=x.useState(!1),[u,a]=x.useState({}),[m,l]=x.useState({}),[c,b]=x.useState("list"),[g,n]=x.useState(null);if(!s)return e.jsx("div",{className:"text-gray-700 text-center py-8",children:"Loading admin notes..."});const{patient:p}=s,r=()=>{a({language:p.language||"",ethnicity:p.ethnicity||"",race:p.race||"",nationality:p.nationality||"",religion:p.religion||"",referral_source:p.referral_source||"",tribal_affiliations:p.tribal_affiliations||""}),d(!0)},v=()=>{l({homeless_status:p.homeless_status||"",financial_review_date:p.financial_review_date||"",family_size:p.family_size||"",monthly_income:p.monthly_income||""}),t(!0)},N=async()=>{console.log("Saving demographics:",u),alert("Demographics save not yet implemented - needs API endpoint"),d(!1)},f=async()=>{console.log("Saving financial data:",m),alert("Financial data save not yet implemented - needs API endpoint"),t(!1)},_=()=>{d(!1),a({})},k=()=>{t(!1),l({})},h=()=>{b("create")},y=()=>{b("list"),n(null)},R=()=>{b("list"),n(null)};return c==="create"?e.jsx(he,{patientId:p.pid,noteType:"admin",onSave:y,onClose:R}):c==="edit"?e.jsx(he,{noteId:g,patientId:p.pid,noteType:"admin",onSave:y,onClose:R}):c==="view"?e.jsx(Re,{noteId:g,onClose:R}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card-main",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Demographics & Statistics"}),!o&&e.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-blue-700 hover:text-blue-900 hover:bg-blue-50 rounded-lg transition-colors",children:"âœï¸ Edit"})]}),e.jsxs("div",{className:"card-inner",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"Language"}),o?e.jsx("input",{type:"text",value:u.language,onChange:j=>a({...u,language:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):e.jsx("div",{className:"form-field-value",children:p.language||""})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"Ethnicity"}),o?e.jsx("input",{type:"text",value:u.ethnicity,onChange:j=>a({...u,ethnicity:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):e.jsx("div",{className:"form-field-value",children:p.ethnicity||""})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"Race"}),o?e.jsx("input",{type:"text",value:u.race,onChange:j=>a({...u,race:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):e.jsx("div",{className:"form-field-value",children:p.race||""})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"Nationality"}),o?e.jsx("input",{type:"text",value:u.nationality,onChange:j=>a({...u,nationality:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):e.jsx("div",{className:"form-field-value",children:p.nationality||""})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"Religion"}),o?e.jsx("input",{type:"text",value:u.religion,onChange:j=>a({...u,religion:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):e.jsx("div",{className:"form-field-value",children:p.religion||""})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"Referral Source"}),o?e.jsx("input",{type:"text",value:u.referral_source,onChange:j=>a({...u,referral_source:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):e.jsx("div",{className:"form-field-value",children:p.referral_source||""})]}),e.jsxs("div",{className:"col-span-2 form-field",children:[e.jsx("div",{className:"form-field-label",children:"Tribal Affiliations"}),o?e.jsx("input",{type:"text",value:u.tribal_affiliations,onChange:j=>a({...u,tribal_affiliations:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):e.jsx("div",{className:"form-field-value",children:p.tribal_affiliations||""})]})]}),o&&e.jsxs("div",{className:"flex gap-3 mt-4 pt-4 border-t border-gray-200",children:[e.jsx(le,{onClick:N,children:"ðŸ’¾ Save Changes"}),e.jsx("button",{onClick:_,className:"px-4 py-2 bg-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"})]})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Financial & Housing Status"}),!i&&e.jsx("button",{onClick:v,className:"px-4 py-2 text-sm font-medium text-blue-700 hover:text-blue-900 hover:bg-blue-50 rounded-lg transition-colors",children:"âœï¸ Edit"})]}),e.jsxs("div",{className:"card-inner",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"Homeless"}),i?e.jsxs("select",{value:m.homeless_status,onChange:j=>l({...m,homeless_status:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select..."}),e.jsx("option",{value:"No",children:"No"}),e.jsx("option",{value:"Yes",children:"Yes"}),e.jsx("option",{value:"At Risk",children:"At Risk"})]}):e.jsx("div",{className:"form-field-value",children:p.homeless_status||""})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"Financial Review"}),i?e.jsx("input",{type:"date",value:m.financial_review_date,onChange:j=>l({...m,financial_review_date:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):e.jsx("div",{className:"form-field-value",children:p.financial_review_date?new Date(p.financial_review_date).toLocaleDateString():""})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"Family Size"}),i?e.jsx("input",{type:"number",value:m.family_size,onChange:j=>l({...m,family_size:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):e.jsx("div",{className:"form-field-value",children:p.family_size||""})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"Monthly Income"}),i?e.jsx("input",{type:"number",value:m.monthly_income,onChange:j=>l({...m,monthly_income:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00"}):e.jsx("div",{className:"form-field-value",children:p.monthly_income?`$${p.monthly_income}`:""})]})]}),i&&e.jsxs("div",{className:"flex gap-3 mt-4 pt-4 border-t border-gray-200",children:[e.jsx(le,{onClick:f,children:"ðŸ’¾ Save Changes"}),e.jsx("button",{onClick:k,className:"px-4 py-2 bg-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"})]})]})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card-main",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Administrative Notes"}),e.jsx(le,{onClick:h,children:"+ New Admin Note"})]}),e.jsx("div",{className:"text-gray-600 text-sm",children:"Create administrative notes for this client's record"})]})})]})}function Ts({data:s,onDataUpdate:o}){const[d,i]=x.useState(!1),[t,u]=x.useState(!1),[a,m]=x.useState(!1),[l,c]=x.useState(!1),[b,g]=x.useState(!1),[n,p]=x.useState(!1),[r,v]=x.useState({}),[N,f]=x.useState({}),[_,k]=x.useState({}),[h,y]=x.useState(!1),[R,j]=x.useState(null),[J,G]=x.useState([]),[W,ee]=x.useState({});if(x.useEffect(()=>{(async()=>{try{const U=(await $e())?.companies||[];G(U.map(te=>({value:te.id,label:te.name})));const[q,Y,B,$]=await Promise.all([re("sub_relation"),re("sex"),re("state"),re("yesno")]);ee({relationship:q.options||[],sex:Y.options||[],state:B.options||[],accept_assignment:$.options||[]})}catch(S){console.error("Failed to load dropdown options:",S)}})()},[]),!s)return e.jsx("div",{className:"text-gray-700 text-center py-8",children:"Loading insurance data..."});const{patient:I,insurances:P}=s,T=I.payment_type==="self-pay"||I.payment_type==="pro-bono",{primaryInsurance:L,secondaryInsurance:A,tertiaryInsurance:E}=x.useMemo(()=>{const w=Y=>({id:null,type:Y,provider:"",plan_name:"",effective_date:"",effective_date_end:"",policy_number:"",group_number:"",subscriber_relationship:"",subscriber_fname:"",subscriber_mname:"",subscriber_lname:"",subscriber_DOB:"",subscriber_sex:"",subscriber_ss:"",subscriber_street:"",subscriber_street_line_2:"",subscriber_city:"",subscriber_state:"",subscriber_postal_code:"",subscriber_employer:"",subscriber_employer_street:"",subscriber_employer_street_line_2:"",subscriber_employer_city:"",subscriber_employer_state:"",subscriber_employer_postal_code:"",copay:"",accept_assignment:""});let S=P?.find(Y=>Y.type==="primary"),U=P?.find(Y=>Y.type==="secondary"),q=P?.find(Y=>Y.type==="tertiary");return S||(S=w("primary")),T||(U||(U=w("secondary")),q||(q=w("tertiary"))),{primaryInsurance:S,secondaryInsurance:U,tertiaryInsurance:q}},[P,T]),z=w=>w?{provider:w.provider||"",plan_name:w.plan_name||"",date:w.effective_date||"",date_end:w.effective_date_end||"",policy_number:w.policy_number||"",group_number:w.group_number||"",subscriber_relationship:w.subscriber_relationship||"",subscriber_fname:w.subscriber_fname||"",subscriber_mname:w.subscriber_mname||"",subscriber_lname:w.subscriber_lname||"",subscriber_DOB:w.subscriber_DOB||"",subscriber_sex:w.subscriber_sex||"",subscriber_ss:w.subscriber_ss||"",subscriber_street:w.subscriber_street||"",subscriber_street_line_2:w.subscriber_street_line_2||"",subscriber_city:w.subscriber_city||"",subscriber_state:w.subscriber_state||"",subscriber_postal_code:w.subscriber_postal_code||"",subscriber_employer:w.subscriber_employer||"",subscriber_employer_street:w.subscriber_employer_street||"",subscriber_employer_street_line_2:w.subscriber_employer_street_line_2||"",subscriber_employer_city:w.subscriber_employer_city||"",subscriber_employer_state:w.subscriber_employer_state||"",subscriber_employer_postal_code:w.subscriber_employer_postal_code||"",copay:w.copay||"",accept_assignment:w.accept_assignment||"",policy_type:w.policy_type||"",type:w.type}:{},M=w=>{let S;w==="primary"?(S=L,v(z(S)),c(!0)):w==="secondary"?(S=A,f(z(S)),g(!0)):w==="tertiary"&&(S=E,k(z(S)),p(!0)),j(null)},H=w=>{w==="primary"?(c(!1),v({})):w==="secondary"?(g(!1),f({})):w==="tertiary"&&(p(!1),k({})),j(null)},V=(w,S,U)=>{if(S==="subscriber_relationship"&&U.toLowerCase()==="self"){const q={[S]:U,subscriber_fname:I.fname||"",subscriber_mname:I.mname||"",subscriber_lname:I.lname||"",subscriber_DOB:I.DOB||"",subscriber_sex:I.sex||"",subscriber_ss:I.ss||"",subscriber_street:I.street||"",subscriber_street_line_2:I.street_line_2||"",subscriber_city:I.city||"",subscriber_state:I.state||"",subscriber_postal_code:I.postal_code||""};w==="primary"?v(Y=>({...Y,...q})):w==="secondary"?f(Y=>({...Y,...q})):w==="tertiary"&&k(Y=>({...Y,...q}))}else w==="primary"?v(q=>({...q,[S]:U})):w==="secondary"?f(q=>({...q,[S]:U})):w==="tertiary"&&k(q=>({...q,[S]:U}))},C=w=>{const U=[{field:"provider",label:"Insurance Company"},{field:"date",label:"Effective Date"},{field:"policy_number",label:"Policy Number"},{field:"subscriber_relationship",label:"Relationship"},{field:"subscriber_fname",label:"Subscriber First Name"},{field:"subscriber_lname",label:"Subscriber Last Name"},{field:"subscriber_DOB",label:"D.O.B."},{field:"subscriber_sex",label:"Sex"},{field:"subscriber_ss",label:"S.S."},{field:"subscriber_street",label:"Subscriber Address"},{field:"subscriber_city",label:"City"},{field:"subscriber_state",label:"State"},{field:"subscriber_postal_code",label:"Zip Code"}].filter(({field:q})=>!w[q]||w[q].trim()==="");if(U.length>0)throw new Error(`Required fields missing: ${U.map(q=>q.label).join(", ")}`)},O=async w=>{y(!0),j(null);try{let S,U;w==="primary"?(S=r,U=L):w==="secondary"?(S=N,U=A):w==="tertiary"&&(S=_,U=E),C(S);const q={...S};U.id||(q.patient_id=I.pid,q.type=w),await We(U.id,q),o&&await o(),H(w)}catch(S){j(S.message||"Failed to save insurance changes")}finally{y(!1)}},F=(w,S,U,q,Y,B,$=null,te="text",ae=!1)=>{const xe=ae?"form-field-label required-field-label":"form-field-label";if(Y&&U)return $?e.jsxs("div",{className:"form-field",children:[e.jsxs("div",{className:xe,children:[w,ae&&" *"]}),e.jsxs("select",{value:B[U]||"",onChange:se=>V(q,U,se.target.value),className:"input-md",required:ae,children:[e.jsx("option",{value:"",children:"Select..."}),$.map(se=>e.jsx("option",{value:se.value,children:se.label},se.value))]})]}):e.jsxs("div",{className:"form-field",children:[e.jsxs("div",{className:xe,children:[w,ae&&" *"]}),e.jsx("input",{type:te,value:B[U]||"",onChange:se=>V(q,U,se.target.value),className:"input-md",required:ae})]});{let se=S||"";if($&&S){const je=$.find(Le=>Le.value===S);je&&(se=je.label)}return e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:w}),e.jsx("div",{className:"form-field-value",children:se})]})}},D=(w,S,U=!1,q=!0,Y=null)=>{if(!w)return null;const B=S==="primary"&&l||S==="secondary"&&b||S==="tertiary"&&n,$=S==="primary"?r:S==="secondary"?N:_,te=ae=>({primary:"Primary Insurance",secondary:"Secondary Insurance",tertiary:"Tertiary Insurance"})[ae]||`Insurance ${ae}`;return e.jsxs("div",{className:"card-main mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:`flex items-center gap-4 ${U?"cursor-pointer":""}`,onClick:U?Y:void 0,children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:te(w.type)}),U&&e.jsx("button",{className:"text-gray-600 hover:text-gray-800 transition-colors",children:q?e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}):e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),e.jsx("div",{className:"flex space-x-2",children:B?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>H(S),disabled:h,className:"btn-solid btn-solid-gray disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:()=>O(S),disabled:h,className:"btn-solid btn-solid-green disabled:opacity-50",children:h?"Saving...":"Save Changes"})]}):e.jsx("button",{onClick:()=>M(S),className:"btn-solid btn-solid-blue",children:"Edit Insurance"})})]}),q&&B&&e.jsx("div",{className:"mb-4 px-4 py-2 bg-purple-50 border-l-4 border-purple-700 rounded",children:e.jsxs("p",{className:"text-sm text-purple-900",children:[e.jsx("span",{className:"required-field-label",children:"*"})," Required fields are marked with an asterisk and displayed in ",e.jsx("span",{className:"required-field-label",children:"purple"})]})}),q&&e.jsx("div",{className:"card-inner",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide mb-3",children:"Insurance Details"}),F("Insurance Company",w.insurance_company_name||w.provider,"provider",S,B,$,J,"text",!0),F("Plan Name",w.plan_name,"plan_name",S,B,$),F("Effective Date",w.effective_date,"date",S,B,$,null,"date",!0),F("Effective Date End",w.effective_date_end,"date_end",S,B,$,null,"date"),F("Policy Number",w.policy_number,"policy_number",S,B,$,null,"text",!0),F("Group Number",w.group_number,"group_number",S,B,$),F("CoPay",w.copay,"copay",S,B,$,null,"text"),F("Accept Assignment",w.accept_assignment,"accept_assignment",S,B,$,W.accept_assignment||[]),w.type==="secondary"&&F("Secondary Medicare Type",w.policy_type,"policy_type",S,B,$)]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide mb-3",children:"Subscriber Information"}),F("Relationship",w.subscriber_relationship,"subscriber_relationship",S,B,$,W.relationship||[],"text",!0),F("Subscriber First Name",w.subscriber_fname,"subscriber_fname",S,B,$,null,"text",!0),F("Subscriber Middle Name",w.subscriber_mname,"subscriber_mname",S,B,$),F("Subscriber Last Name",w.subscriber_lname,"subscriber_lname",S,B,$,null,"text",!0),F("D.O.B.",w.subscriber_DOB,"subscriber_DOB",S,B,$,null,"date",!0),F("Sex",w.subscriber_sex,"subscriber_sex",S,B,$,W.sex||[],"text",!0),B?F("S.S.",$.subscriber_ss,"subscriber_ss",S,B,$,null,"text",!0):e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"S.S."}),e.jsx("div",{className:"form-field-value",children:w.subscriber_ss?"***-**-"+w.subscriber_ss.slice(-4):""})]}),F("Subscriber Address",w.subscriber_street,"subscriber_street",S,B,$,null,"text",!0),F("Address Line 2",w.subscriber_street_line_2,"subscriber_street_line_2",S,B,$),F("City",w.subscriber_city,"subscriber_city",S,B,$,null,"text",!0),F("State",w.subscriber_state,"subscriber_state",S,B,$,W.state||[],"text",!0),F("Zip Code",w.subscriber_postal_code,"subscriber_postal_code",S,B,$,null,"text",!0)]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide mb-3",children:"Subscriber Employer"}),F("Subscriber Employer (SE)",w.subscriber_employer,"subscriber_employer",S,B,$),F("SE Address",w.subscriber_employer_street,"subscriber_employer_street",S,B,$),F("SE Address Line 2",w.subscriber_employer_street_line_2,"subscriber_employer_street_line_2",S,B,$),F("SE City",w.subscriber_employer_city,"subscriber_employer_city",S,B,$),F("SE State",w.subscriber_employer_state,"subscriber_employer_state",S,B,$,W.state||[]),F("SE Zip Code",w.subscriber_employer_postal_code,"subscriber_employer_postal_code",S,B,$)]})]})})]},w.id||`placeholder-${S}`)},Q=I.employer||I.employer_street||I.employer_city||I.employer_state||I.employer_postal_code||I.employer_occupation,oe={insurance:"Insurance","self-pay":"Self-Pay","pro-bono":"Pro Bono"}[I.payment_type]||I.payment_type,Ie=!T||a;return x.useEffect(()=>{A&&i(!0),E&&u(!0)},[A,E]),e.jsxs("div",{className:"space-y-6",children:[R&&e.jsx("div",{className:"error-message",children:R}),e.jsx("div",{className:"card-main",children:e.jsx("div",{className:"card-inner",children:e.jsxs("div",{className:"flex items-center justify-between py-3 px-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide",children:"Payment Type:"}),e.jsx("div",{className:`text-lg font-bold ${T?"text-orange-600":"text-blue-600"}`,children:oe})]}),T&&P&&P.length>0&&e.jsx("button",{onClick:()=>m(!a),className:"px-4 py-2 text-sm font-medium text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-lg transition-colors",children:a?"Hide Insurance Records":"Show Insurance Records"})]})})}),Ie&&e.jsxs(e.Fragment,{children:[Q&&e.jsxs("div",{className:"card-main",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Client Employer Information"}),e.jsx("div",{className:"card-inner",children:e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"col-span-2 form-field",children:[e.jsx("div",{className:"form-field-label",children:"Employer Name"}),e.jsx("div",{className:"form-field-value",children:I.employer||""})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"Start Date"}),e.jsx("div",{className:"form-field-value",children:I.employer_start_date?new Date(I.employer_start_date).toLocaleDateString():""})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"End Date"}),e.jsx("div",{className:"form-field-value",children:I.employer_end_date?new Date(I.employer_end_date).toLocaleDateString():""})]}),e.jsxs("div",{className:"col-span-2 form-field",children:[e.jsx("div",{className:"form-field-label",children:"Address"}),e.jsxs("div",{className:"form-field-value",children:[I.employer_street||"",I.employer_street_line_2&&`, ${I.employer_street_line_2}`]})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"City"}),e.jsx("div",{className:"form-field-value",children:I.employer_city||""})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"State"}),e.jsx("div",{className:"form-field-value",children:I.employer_state||""})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"Postal Code"}),e.jsx("div",{className:"form-field-value",children:I.employer_postal_code||""})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"Country"}),e.jsx("div",{className:"form-field-value",children:I.employer_country||""})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"Occupation"}),e.jsx("div",{className:"form-field-value",children:I.employer_occupation||""})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"Industry"}),e.jsx("div",{className:"form-field-value",children:I.employer_industry||""})]})]})})]}),L&&D(L,"primary",!1,!0,null),A&&D(A,"secondary",!0,d,()=>i(!d)),E&&D(E,"tertiary",!0,t,()=>u(!t))]})]})}function Fe({encounterId:s,onClose:o}){const[d,i]=x.useState(!0),[t,u]=x.useState(null),[a,m]=x.useState(null),[l,c]=x.useState("notes");x.useEffect(()=>{s&&(async()=>{try{i(!0),m(null);const p=await qe(s);u(p)}catch(p){console.error("Error fetching encounter detail:",p),m(p.message||"Failed to load encounter details")}finally{i(!1)}})()},[s]);const b=n=>{if(!n)return"N/A";const[p,r,v]=n.split(/[-T]/);return new Date(p,r-1,v).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},g=n=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(n||0);return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Encounter Details"}),t&&e.jsxs("p",{className:"text-blue-100 text-sm mt-1",children:[b(t.encounter.date)," â€¢ ",t.encounter.patient_name]})]}),e.jsx("button",{onClick:o,className:"text-white hover:bg-white/20 rounded-full p-2 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"overflow-y-auto max-h-[calc(90vh-120px)]",children:d?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),e.jsx("p",{className:"text-gray-700 mt-4",children:"Loading encounter details..."})]}):a?e.jsx("div",{className:"p-12 text-center",children:e.jsxs("div",{className:"text-red-600 font-semibold",children:["Error: ",a]})}):t?e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"card-main mb-6",children:[e.jsx("h3",{className:"section-header-gray",children:"Session Information"}),e.jsx("div",{className:"card-inner",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"Date"}),e.jsx("div",{className:"form-field-value",children:b(t.encounter.date)})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"Provider"}),e.jsx("div",{className:"form-field-value",children:t.encounter.provider_name||"N/A"})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"Facility"}),e.jsx("div",{className:"form-field-value",children:t.encounter.facility_name||"N/A"})]}),e.jsxs("div",{className:"col-span-2 md:col-span-3 form-field",children:[e.jsx("div",{className:"form-field-label",children:"Reason for Visit"}),e.jsx("div",{className:"form-field-value",children:t.encounter.reason||"Not specified"})]}),t.encounter.encounter_type_description&&e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"Encounter Type"}),e.jsx("div",{className:"form-field-value",children:t.encounter.encounter_type_description})]})]})})]}),e.jsxs(Ye,{className:"mb-6",children:[e.jsxs(de,{active:l==="notes",onClick:()=>c("notes"),children:["Clinical Notes (",t.forms.length,")"]}),e.jsxs(de,{active:l==="billing",onClick:()=>c("billing"),children:["Billing (",t.billing.length,")"]}),e.jsxs(de,{active:l==="vitals",onClick:()=>c("vitals"),children:["Vitals (",t.vitals.length,")"]}),e.jsxs(de,{active:l==="diagnoses",onClick:()=>c("diagnoses"),children:["Diagnoses (",t.diagnoses.length,")"]})]}),l==="notes"&&e.jsx("div",{className:"space-y-3",children:t.forms.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No clinical notes recorded"}):t.forms.map(n=>e.jsx("div",{className:"card-inner",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-gray-800",children:n.form_name||n.formdir}),e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[b(n.date)," â€¢ ",n.user_name||"Unknown user"]})]}),n.authorized==="1"&&e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs font-semibold rounded",children:"Authorized"})]})},n.id))}),l==="billing"&&e.jsx("div",{className:"space-y-4",children:t.billing.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No billing charges recorded"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700",children:"Total Charges"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:g(t.total_charges)})]}),e.jsx("div",{className:"space-y-2",children:t.billing.map(n=>e.jsx("div",{className:"card-inner",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-semibold text-gray-800",children:[n.code_type,": ",n.code]}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:n.code_text}),n.modifier&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Modifier: ",n.modifier]})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsx("div",{className:"font-bold text-gray-800",children:g(n.fee*n.units)}),e.jsxs("div",{className:"text-xs text-gray-500",children:[n.units," unit",n.units!=="1"?"s":""," Ã— ",g(n.fee)]}),n.billed==="1"&&e.jsx("span",{className:"inline-block mt-1 px-2 py-0.5 bg-green-100 text-green-700 text-xs font-semibold rounded",children:"Billed"})]})]})},n.id))})]})}),l==="vitals"&&e.jsx("div",{className:"space-y-3",children:t.vitals.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No vitals recorded"}):t.vitals.map(n=>e.jsx("div",{className:"card-inner",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"col-span-2 md:col-span-4 form-field",children:[e.jsx("div",{className:"form-field-label",children:"Recorded"}),e.jsxs("div",{className:"form-field-value",children:[b(n.date)," â€¢ ",n.user_name||"Unknown user"]})]}),n.bps&&n.bpd&&e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"Blood Pressure"}),e.jsxs("div",{className:"form-field-value",children:[n.bps,"/",n.bpd]})]}),n.pulse&&e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"Pulse"}),e.jsxs("div",{className:"form-field-value",children:[n.pulse," bpm"]})]}),n.temperature&&e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"Temperature"}),e.jsxs("div",{className:"form-field-value",children:[n.temperature,"Â°F"]})]}),n.weight&&e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"Weight"}),e.jsxs("div",{className:"form-field-value",children:[n.weight," lbs"]})]}),n.height&&e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"Height"}),e.jsxs("div",{className:"form-field-value",children:[n.height," in"]})]}),n.BMI&&e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"BMI"}),e.jsx("div",{className:"form-field-value",children:n.BMI})]}),n.oxygen_saturation&&e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"O2 Saturation"}),e.jsxs("div",{className:"form-field-value",children:[n.oxygen_saturation,"%"]})]}),n.respiration&&e.jsxs("div",{className:"form-field",children:[e.jsx("div",{className:"form-field-label",children:"Respiration"}),e.jsxs("div",{className:"form-field-value",children:[n.respiration," /min"]})]})]})},n.id))}),l==="diagnoses"&&e.jsx("div",{className:"space-y-3",children:t.diagnoses.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No diagnoses recorded for this encounter"}):t.diagnoses.map(n=>e.jsxs("div",{className:"card-inner",children:[e.jsx("div",{className:"font-semibold text-gray-800",children:n.title}),n.diagnosis&&e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["Code: ",n.diagnosis]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:["Started: ",b(n.begdate),n.enddate&&` â€¢ Ended: ${b(n.enddate)}`]}),n.outcome&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Outcome: ",n.outcome]})]},n.id))})]}):null}),e.jsx("div",{className:"border-t border-gray-200 p-4 bg-gray-50 flex justify-end gap-3",children:e.jsx("button",{onClick:o,className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg transition-colors font-medium",children:"Close"})})]})}):null}function Is({data:s}){const[o,d]=x.useState("all"),[i,t]=x.useState("date-desc"),[u,a]=x.useState(null);if(!s)return e.jsx("div",{className:"empty-state",children:"Loading encounter history..."});const{encounters:m,patient:l}=s,c=n=>{if(!n)return"N/A";const[p,r,v]=n.split(/[-T]/);return new Date(p,r-1,v).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},b=x.useMemo(()=>{if(!m||m.length===0)return[];let n=[...m];const p=new Date;if(o==="recent"){const r=new Date(p.getTime()-2592e6);n=n.filter(v=>new Date(v.date)>=r)}else if(o==="past-year"){const r=new Date(p.getTime()-31536e6);n=n.filter(v=>new Date(v.date)>=r)}return i==="date-desc"?n.sort((r,v)=>new Date(v.date)-new Date(r.date)):i==="date-asc"?n.sort((r,v)=>new Date(r.date)-new Date(v.date)):i==="provider"&&n.sort((r,v)=>{const N=r.provider_name||"",f=v.provider_name||"";return N.localeCompare(f)}),n},[m,o,i]),g=x.useMemo(()=>{if(!m||m.length===0)return{total:0,lastVisit:null,avgPerMonth:0,thisYear:0};const n=new Date,p=new Date(n.getTime()-365*24*60*60*1e3),r=new Date(n.getFullYear(),0,1),v=m.map(h=>new Date(h.date)),N=v.length>0?new Date(Math.max(...v.map(h=>h.getTime()))):null,_=m.filter(h=>new Date(h.date)>=p).length/12,k=m.filter(h=>new Date(h.date)>=r);return{total:m.length,lastVisit:N?c(N):"N/A",avgPerMonth:_.toFixed(1),thisYear:k.length}},[m]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("div",{className:"card-main",children:[e.jsx("h2",{className:"card-header",children:"Visit Statistics"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"stat-box",children:[e.jsx("div",{className:"text-caption text-gray-600 font-semibold mb-1",children:"Total Visits"}),e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:g.total})]}),e.jsxs("div",{className:"stat-box",children:[e.jsx("div",{className:"text-caption text-gray-600 font-semibold mb-1",children:"This Year"}),e.jsx("div",{className:"text-3xl font-bold text-green-600",children:g.thisYear})]}),e.jsxs("div",{className:"stat-box",children:[e.jsx("div",{className:"text-caption text-gray-600 font-semibold mb-1",children:"Avg/Month (Past Year)"}),e.jsx("div",{className:"text-3xl font-bold text-purple-600",children:g.avgPerMonth})]}),e.jsxs("div",{className:"stat-box",children:[e.jsx("div",{className:"text-caption text-gray-600 font-semibold mb-1",children:"Last Visit"}),e.jsx("div",{className:"text-lg font-bold text-gray-700",children:g.lastVisit})]})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsx("h3",{className:"section-header",children:"Filter By"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:()=>d("all"),className:`w-full text-left filter-btn-enhanced ${o==="all"?"filter-btn-active-base bg-blue-500":"filter-btn-inactive"}`,children:"All Encounters"}),e.jsx("button",{onClick:()=>d("recent"),className:`w-full text-left filter-btn-enhanced ${o==="recent"?"filter-btn-active-base bg-blue-500":"filter-btn-inactive"}`,children:"Last 30 Days"}),e.jsx("button",{onClick:()=>d("past-year"),className:`w-full text-left filter-btn-enhanced ${o==="past-year"?"filter-btn-active-base bg-blue-500":"filter-btn-inactive"}`,children:"Past Year"})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsx("h3",{className:"section-header",children:"Sort By"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:()=>t("date-desc"),className:`w-full text-left filter-btn-enhanced ${i==="date-desc"?"filter-btn-active-base bg-blue-500":"filter-btn-inactive"}`,children:"Newest First"}),e.jsx("button",{onClick:()=>t("date-asc"),className:`w-full text-left filter-btn-enhanced ${i==="date-asc"?"filter-btn-active-base bg-blue-500":"filter-btn-inactive"}`,children:"Oldest First"}),e.jsx("button",{onClick:()=>t("provider"),className:`w-full text-left filter-btn-enhanced ${i==="provider"?"filter-btn-active-base bg-blue-500":"filter-btn-inactive"}`,children:"By Provider"})]})]})]}),e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("div",{className:"card-main",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h2",{className:"text-xl font-semibold text-gray-800",children:["Encounter History",e.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-600",children:["(",b.length," ",b.length===1?"visit":"visits",")"]})]})}),b.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"w-16 h-16 mx-auto text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-gray-600 text-lg",children:"No encounters found"}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:o!=="all"?"Try adjusting your filters":"No visit history recorded"})]}):e.jsx("div",{className:"space-y-3",children:b.map(n=>e.jsx("div",{className:"card-inner hover:bg-white/90 transition-colors cursor-pointer",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"text-lg font-bold text-gray-800",children:c(n.date)}),e.jsxs("span",{className:"badge-sm badge-light-info",children:["ID: ",n.encounter]})]}),n.reason&&e.jsx("div",{className:"text-gray-900 font-medium mb-2",children:n.reason}),e.jsxs("div",{className:"flex gap-6 text-sm text-gray-600",children:[n.provider_name&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Provider:"})," ",n.provider_name]}),n.facility_name&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Facility:"})," ",n.facility_name]})]})]}),e.jsx("button",{onClick:p=>{p.stopPropagation(),a(n.encounter)},className:"ml-4 btn-mini",children:"View Details"})]})},n.encounter))})]})})]}),u&&e.jsx(Fe,{encounterId:u,onClose:()=>a(null)})]})}function Ls({patientId:s,onNoteClick:o,onCreateNote:d}){const[i,t]=x.useState([]),[u,a]=x.useState(!0),[m,l]=x.useState(null),[c,b]=x.useState({note_type:null,status:null,start_date:null,end_date:null});x.useEffect(()=>{g()},[s,c]);const g=async()=>{a(!0),l(null);try{const f=await ls(s,c);t(f.notes||[])}catch(f){console.error("Error loading notes:",f),l(f.message)}finally{a(!1)}},n=f=>{if(!f)return"N/A";const[_,k,h]=f.split(/[-T]/);return new Date(_,k-1,h).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},p=f=>f?new Date(f).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"}):"N/A",r=f=>({progress:"ðŸ“",intake:"ðŸ‘‹",crisis:"âš ï¸",discharge:"âœ…",mse:"ðŸ§ ",admin:"ðŸ“‹",noshow:"âŒ",cancel:"ðŸš«"})[f]||"ðŸ“„",v=f=>({progress:"Progress",intake:"Intake",crisis:"Crisis",discharge:"Discharge",mse:"Mental Status",admin:"Administrative",noshow:"No-Show",cancel:"Cancellation"})[f]||f,N=f=>f.is_locked||f.status==="signed"?e.jsx("span",{className:"badge-sm badge-light-success",children:"Signed"}):f.status==="draft"?e.jsx("span",{className:"badge-sm badge-light-warning",children:"Draft"}):f.supervisor_review_required&&f.supervisor_review_status==="pending"?e.jsx("span",{className:"badge-sm badge-light-info",children:"Pending Review"}):null;return u?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx("div",{className:"text-gray-600",children:"Loading notes..."})}):m?e.jsxs("div",{className:"p-6 text-center",children:[e.jsxs(ce,{children:["Error loading notes: ",m]}),e.jsx("button",{onClick:g,className:"px-6 py-2 bg-gradient-to-r from-purple-500 to-purple-600 text-white font-semibold rounded-xl hover:from-purple-600 hover:to-purple-700 transition-all shadow-lg",children:"Retry"})]}):e.jsxs("div",{className:"flex gap-6",children:[e.jsx("div",{className:"w-64 flex-shrink-0",children:e.jsxs("div",{className:"card-main sticky top-6",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-4",children:"Filter Notes"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-600 mb-2 block",children:"Note Type"}),e.jsxs("select",{value:c.note_type||"",onChange:f=>b({...c,note_type:f.target.value||null}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white",children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"progress",children:"Progress"}),e.jsx("option",{value:"intake",children:"Intake"}),e.jsx("option",{value:"crisis",children:"Crisis"}),e.jsx("option",{value:"discharge",children:"Discharge"}),e.jsx("option",{value:"mse",children:"Mental Status"}),e.jsx("option",{value:"admin",children:"Administrative"})]})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-600 mb-2 block",children:"Status"}),e.jsxs("select",{value:c.status||"",onChange:f=>b({...c,status:f.target.value||null}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"draft",children:"Drafts"}),e.jsx("option",{value:"signed",children:"Signed"})]})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-600 mb-2 block",children:"From Date"}),e.jsx("input",{type:"date",value:c.start_date||"",onChange:f=>b({...c,start_date:f.target.value||null}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white"})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-600 mb-2 block",children:"To Date"}),e.jsx("input",{type:"date",value:c.end_date||"",onChange:f=>b({...c,end_date:f.target.value||null}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white"})]})})]})]})}),e.jsxs("div",{className:"flex-1 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-800",children:["Clinical Notes",e.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-600",children:["(",i.length," ",i.length===1?"note":"notes",")"]})]}),d&&e.jsx("button",{onClick:d,className:"px-6 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white font-semibold rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all shadow-lg",children:"+ New Note"})]}),i.length===0?e.jsxs("div",{className:"card-main text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“"}),e.jsx("p",{className:"text-lg text-gray-600 mb-2",children:"No clinical notes found"}),e.jsx("p",{className:"text-sm text-gray-500",children:c.note_type||c.status?"Try adjusting your filters":"Create your first note to get started"})]}):e.jsx("div",{className:"space-y-3",children:i.map(f=>{const _=f.status==="draft";return e.jsx("div",{onClick:()=>o&&o(f.id,_,f.note_type),className:"card-main hover:shadow-2xl hover:scale-[1.01] hover:border-blue-400 cursor-pointer transition-all duration-200",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"text-2xl",children:r(f.note_type)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:"font-semibold text-gray-800",children:[v(f.note_type)," Note"]}),N(f),f.is_addendum&&e.jsx("span",{className:"badge-sm badge-light-info",children:"Addendum"})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Service Date: ",n(f.service_date)," â€¢ ",f.provider_name||"Unknown provider"]})]})]}),f.behavior_problem&&e.jsxs("div",{className:"text-sm text-gray-700 line-clamp-2 mt-2",children:[f.behavior_problem.substring(0,150),"..."]}),e.jsxs("div",{className:"flex gap-4 text-xs text-gray-500 mt-2",children:[e.jsxs("span",{children:["Created: ",p(f.created_at)]}),f.signed_at&&e.jsxs("span",{children:["Signed: ",p(f.signed_at)]}),f.addenda&&f.addenda.length>0&&e.jsxs("span",{className:"text-blue-600 font-medium",children:[f.addenda.length," ",f.addenda.length===1?"addendum":"addenda"]})]})]}),e.jsx("button",{className:"px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white text-sm font-semibold rounded-lg hover:from-blue-600 hover:to-blue-700 transition-all shadow-md",children:_?"Edit":"View"})]})},f.id)})})]})]})}function Os({onSelect:s,preselected:o=null,appointment:d=null}){const{user:i}=Pe(),[t,u]=x.useState(!1),a=i?.isSocialWorker||!1,m=i?.isProvider||!1,l=[{id:"intake",label:"Intake Assessment",description:"First session with client",icon:"ðŸ¤",row:1,cols:3},{id:"diagnosis",label:"Diagnosis Note",description:"ICD-10 diagnosis assessment and documentation",icon:"ðŸ¥",row:1,cols:3},{id:"treatment_plan",label:"Treatment Plan",description:"Goals, objectives, interventions",icon:"ðŸ“‹",row:1,cols:3},{id:"progress",label:"Progress Note",description:"Regular therapy session",icon:"ðŸ“Š",row:1,cols:3},{id:"mse",label:"Mental Status Exam",description:"Standalone MSE assessment",icon:"ðŸ§ ",row:2,cols:6},{id:"discharge",label:"Discharge Summary",description:"Final session, treatment conclusion",icon:"âœ…",row:2,cols:6},{id:"crisis",label:"Crisis Note",description:"Emergency or high-risk session",icon:"âš ï¸",row:3,cols:6},{id:"risk_assessment",label:"Risk Assessment",description:"SI/HI safety evaluation",icon:"ðŸ›¡ï¸",row:3,cols:6},{id:"appointment_status",label:"Appointment Status",description:"No show, late cancel, cancellation",icon:"ðŸ“…",row:4,cols:6,quick:!0},{id:"client_communication",label:"Client Communication",description:"Phone calls, emails, client contact",icon:"ðŸ“ž",row:4,cols:6,quick:!0},{id:"case_management",label:"Case Management Note",description:"Resource coordination, referrals, advocacy",icon:"ðŸ¤",row:5,cols:12,socialWorkerOnly:!0}],c=[{id:"BIRP",label:"BIRP",description:"Behavior, Intervention, Response, Plan",color:"blue"},{id:"PIRP",label:"PIRP",description:"Problem, Intervention, Response, Plan",color:"purple"},{id:"SOAP",label:"SOAP",description:"Subjective, Objective, Assessment, Plan",color:"green"}],g=o||"progress",n=h=>{if(h==="progress"&&m){u(!0);return}s(h)},p=h=>{s("progress",h)},r=()=>{u(!1)},v=l.filter(h=>h.row===1&&!h.socialWorkerOnly),N=l.filter(h=>h.row===2&&!h.socialWorkerOnly),f=l.filter(h=>h.row===3&&!h.socialWorkerOnly),_=l.filter(h=>h.row===4&&!h.socialWorkerOnly),k=l.filter(h=>h.row===5&&h.socialWorkerOnly&&a);return t?e.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[e.jsxs("button",{onClick:r,className:"flex items-center gap-2 text-gray-600 hover:text-gray-800 mb-6",children:[e.jsx("span",{children:"â†"}),e.jsx("span",{children:"Back to note types"})]}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-2",children:"Choose Your Progress Note Format"}),e.jsx("p",{className:"text-gray-600",children:"Select the documentation format you prefer"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:c.map(h=>e.jsx("button",{onClick:()=>p(h.id),className:`card-main text-left p-6 hover:bg-${h.color}-50 hover:border-${h.color}-300 transition-all`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-3xl font-bold text-${h.color}-600 mb-3`,children:h.id}),e.jsx("div",{className:"text-sm text-gray-600",children:h.description})]})},h.id))}),e.jsxs("div",{className:"mt-8 card-main bg-gray-50",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"Format Guide"}),e.jsxs("div",{className:"space-y-3 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-blue-600",children:"BIRP:"})," Focuses on client behavior observed during session, interventions used, client response, and future plan."]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-purple-600",children:"PIRP:"})," Starts with presenting problem/issue, then documents interventions, response, and plan."]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-green-600",children:"SOAP:"})," Medical model format - subjective reports, objective observations, clinical assessment, and treatment plan."]})]})]})]}):e.jsxs("div",{className:"max-w-6xl mx-auto p-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-2",children:"What kind of note are you writing?"}),e.jsx("p",{className:"text-gray-600",children:"Select the type of clinical documentation"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-600 uppercase tracking-wide",children:"Clinical Notes"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:v.map(h=>e.jsx("button",{onClick:()=>n(h.id),className:`card-main text-left p-4 hover:bg-blue-50 hover:border-blue-300 transition-all ${g===h.id?"ring-2 ring-blue-500 bg-blue-50":""}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-3xl",children:h.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"text-base font-semibold text-gray-800 mb-1",children:[h.label,h.suggested&&e.jsx("span",{className:"ml-2 badge-sm badge-light-success",children:"Suggested"})]}),e.jsx("div",{className:"text-xs text-gray-600",children:h.description})]})]})},h.id))}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:N.map(h=>e.jsx("button",{onClick:()=>n(h.id),className:"card-main text-left p-4 hover:bg-blue-50 hover:border-blue-300 transition-all",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-3xl",children:h.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-base font-semibold text-gray-800 mb-1",children:h.label}),e.jsx("div",{className:"text-xs text-gray-600",children:h.description})]})]})},h.id))}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:f.map(h=>e.jsx("button",{onClick:()=>n(h.id),className:"card-main text-left p-4 hover:bg-orange-50 hover:border-orange-300 transition-all",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-3xl",children:h.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-base font-semibold text-gray-800 mb-1",children:h.label}),e.jsx("div",{className:"text-xs text-gray-600",children:h.description})]})]})},h.id))}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:_.map(h=>e.jsx("button",{onClick:()=>n(h.id),className:"card-main text-left p-4 hover:bg-gray-50 hover:border-gray-400 transition-all",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-3xl",children:h.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-base font-semibold text-gray-800 mb-1",children:h.label}),e.jsx("div",{className:"text-xs text-gray-600",children:h.description}),h.quick&&e.jsx("div",{className:"mt-1 text-xs text-blue-600 font-medium",children:"âš¡ Quick note"})]})]})},h.id))}),k.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-sm font-semibold text-teal-600 uppercase tracking-wide mt-6",children:"Case Management"}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:k.map(h=>e.jsx("button",{onClick:()=>n(h.id),className:"card-main text-left p-4 hover:bg-teal-50 hover:border-teal-300 transition-all",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-3xl",children:h.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-base font-semibold text-gray-800 mb-1",children:h.label}),e.jsx("div",{className:"text-xs text-gray-600",children:h.description})]})]})},h.id))})]})]})]})}function Ms({data:s}){const[o,d]=x.useState("list"),[i,t]=x.useState(null),[u,a]=x.useState(null),[m,l]=x.useState(null),c=()=>{d("selectType"),a(null),l(null)},b=(v,N=null)=>{a(v),l(N),d("create")},g=(v,N,f)=>{t(v),a(f),d(N?"edit":"view")},n=v=>{t(v),d("edit")},p=()=>{d("list"),t(null),a(null),l(null)},r=()=>{d("list"),t(null),a(null),l(null)};return o==="selectType"?e.jsx(Os,{onSelect:b,patientId:s?.patient?.pid}):o==="create"?e.jsx(he,{patientId:s?.patient?.pid,noteType:u,templateFormat:m,onSave:p,onClose:r}):o==="edit"?e.jsx(he,{noteId:i,patientId:s?.patient?.pid,noteType:u,onSave:p,onClose:r}):o==="view"?e.jsx(Re,{noteId:i,onClose:r,onEdit:n}):e.jsx(Ls,{patientId:s?.patient?.pid,onNoteClick:g,onCreateNote:c})}function Te({tabName:s}){return e.jsxs("div",{className:"card-main text-center",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:[s," Coming Soon"]}),e.jsx("p",{className:"text-gray-600",children:"This feature is under development and will be available in a future update."})]})}function zs({data:s}){const[o,d]=x.useState(null),[i,t]=x.useState(!0),[u,a]=x.useState(null),[m,l]=x.useState("all"),[c,b]=x.useState(null);x.useEffect(()=>{(async()=>{if(s?.patient?.pid)try{t(!0),a(null);const v=await Ue(s.patient.pid);d(v)}catch(v){console.error("Error fetching billing:",v),a(v.message||"Failed to load billing information")}finally{t(!1)}})()},[s]);const g=r=>{if(!r)return"N/A";const[v,N,f]=r.split(/[-T]/);return new Date(v,N-1,f).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},n=r=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(r||0),p=x.useMemo(()=>{if(!o?.charges)return[];let r=[...o.charges];return m==="billed"?r=r.filter(v=>v.billed==="1"):m==="unbilled"&&(r=r.filter(v=>v.billed!=="1")),r},[o,m]);return i?e.jsx("div",{className:"text-gray-700 text-center py-8",children:"Loading billing information..."}):u?e.jsx(Te,{tabName:"Billing"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("div",{className:"card-main",children:[e.jsx("h2",{className:"card-header",children:"Financial Summary"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"stat-box stat-box-blue",children:[e.jsx("div",{className:"text-gray-600 text-xs font-semibold mb-1",children:"Total Charges"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n(o?.summary?.total_charges||0)})]}),e.jsxs("div",{className:"stat-box stat-box-green",children:[e.jsx("div",{className:"text-gray-600 text-xs font-semibold mb-1",children:"Total Payments"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:n(o?.summary?.total_payments||0)})]}),e.jsxs("div",{className:`stat-box ${(o?.summary?.balance||0)>0?"stat-box-red":"stat-box"}`,children:[e.jsx("div",{className:"text-gray-600 text-xs font-semibold mb-1",children:"Balance Due"}),e.jsx("div",{className:`text-2xl font-bold ${(o?.summary?.balance||0)>0?"text-red-600":"text-gray-600"}`,children:n(o?.summary?.balance||0)})]})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsx("h3",{className:"section-header",children:"Filter By"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:()=>l("all"),className:`w-full text-left filter-btn-enhanced ${m==="all"?"filter-btn-active-base bg-blue-500":"filter-btn-inactive"}`,children:"All Charges"}),e.jsx("button",{onClick:()=>l("unbilled"),className:`w-full text-left filter-btn-enhanced ${m==="unbilled"?"filter-btn-active-base bg-blue-500":"filter-btn-inactive"}`,children:"Unbilled"}),e.jsx("button",{onClick:()=>l("billed"),className:`w-full text-left filter-btn-enhanced ${m==="billed"?"filter-btn-active-base bg-blue-500":"filter-btn-inactive"}`,children:"Billed"})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsx("h2",{className:"card-header",children:"Recent Payments"}),o?.payments&&o.payments.length>0?e.jsx("div",{className:"space-y-2",children:o.payments.slice(0,5).map(r=>e.jsxs("div",{className:"stat-box",children:[e.jsx("div",{className:"font-semibold text-gray-800",children:n(r.pay_amount)}),e.jsx("div",{className:"text-xs text-gray-600 mt-1",children:g(r.dtime)}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:r.method||"Payment"})]},r.session_id))}):e.jsx("div",{className:"text-sm text-gray-500",children:"No payments recorded"})]})]}),e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("div",{className:"card-main",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h2",{className:"text-xl font-semibold text-gray-800",children:["Billing Charges",e.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-600",children:["(",p.length," ",p.length===1?"charge":"charges",")"]})]})}),p.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"w-16 h-16 mx-auto text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 14l6-6m-5.5.5h.01m4.99 5h.01M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16l3.5-2 3.5 2 3.5-2 3.5 2zM10 8.5a.5.5 0 11-1 0 .5.5 0 011 0zm5 5a.5.5 0 11-1 0 .5.5 0 011 0z"})}),e.jsx("p",{className:"text-gray-600 text-lg",children:"No charges found"}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:m!=="all"?"Try adjusting your filters":"No billing charges recorded"})]}):e.jsx("div",{className:"space-y-3",children:p.map(r=>e.jsx("div",{className:"card-inner hover:bg-white/90 transition-colors cursor-pointer",onClick:()=>b(r.encounter),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("div",{className:"font-bold text-gray-800",children:[r.code_type,": ",r.code]}),r.billed==="1"?e.jsx("span",{className:"badge-sm badge-light-success",children:"Billed"}):e.jsx("span",{className:"badge-sm badge-light-warning",children:"Unbilled"}),r.authorized==="1"&&e.jsx("span",{className:"badge-sm badge-light-info",children:"Authorized"})]}),e.jsx("div",{className:"text-sm text-gray-700 mb-2",children:r.code_text}),r.encounter_reason&&e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("span",{className:"font-semibold",children:"Encounter:"})," ",r.encounter_reason]}),e.jsxs("div",{className:"flex gap-6 text-xs text-gray-500",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",g(r.encounter_date)]}),r.provider_name&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Provider:"})," ",r.provider_name]}),r.facility_name&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Facility:"})," ",r.facility_name]}),r.modifier&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Modifier:"})," ",r.modifier]})]})]}),e.jsxs("div",{className:"ml-4 text-right",children:[e.jsx("div",{className:"font-bold text-gray-800 text-lg",children:n(parseFloat(r.fee)*parseFloat(r.units))}),e.jsxs("div",{className:"text-xs text-gray-500",children:[r.units," unit",r.units!=="1"?"s":""," Ã— ",n(r.fee)]}),e.jsx("button",{className:"mt-2 btn-mini",children:"View Encounter"})]})]})},r.id))})]})})]}),c&&e.jsx(Fe,{encounterId:c,onClose:()=>b(null)})]})}function Bs({data:s}){const[o,d]=x.useState([]),[i,t]=x.useState([]),[u,a]=x.useState([]),[m,l]=x.useState({}),[c,b]=x.useState(!0),[g,n]=x.useState(null),[p,r]=x.useState(!1),[v,N]=x.useState(!1),[f,_]=x.useState(null),[k,h]=x.useState(null),[y,R]=x.useState({name:"",category_id:""}),j=s?.patient?.pid;x.useEffect(()=>{j&&(J(),G())},[j]);const J=async()=>{try{b(!0);const C=await fetch(`/custom/api/client_documents.php?id=${j}`,{credentials:"include"});if(!C.ok)throw new Error("Failed to fetch documents");const O=await C.json();d(O.documents||[]),t(O.categories||[]);const F={};O.categories?.forEach(D=>{F[D.id]=!0}),l(F)}catch(C){console.error("Error fetching documents:",C),n(C.message)}finally{b(!1)}},G=async()=>{try{const C=await fetch("/custom/api/client_documents.php?action=categories",{credentials:"include"});if(!C.ok)throw new Error("Failed to fetch categories");const O=await C.json();a(O.categories||[])}catch(C){console.error("Error fetching categories:",C)}},W=C=>{l(O=>({...O,[C]:!O[C]}))},ee=C=>{const O=C.target.files[0];O&&(h(O),y.name||R(F=>({...F,name:O.name})))},I=(C,O)=>{R(F=>({...F,[C]:O}))},P=()=>{r(!0),_(null),h(null),R({name:"",category_id:""})},T=()=>{r(!1),_(null),h(null),R({name:"",category_id:""})},L=async()=>{if(!k){_("Please select a file to upload");return}try{N(!0),_(null);const C=new FormData;C.append("file",k),C.append("patient_id",j),C.append("name",y.name||k.name),y.category_id&&C.append("category_id",y.category_id);const O=await fetch("/custom/api/client_documents.php",{method:"POST",credentials:"include",body:C}),F=await O.json();if(!O.ok)throw new Error(F.error||"Failed to upload document");await J(),T()}catch(C){console.error("Error uploading document:",C),_(C.message)}finally{N(!1)}},A=C=>C?C.includes("pdf")?"ðŸ“•":C.includes("image")?"ðŸ–¼ï¸":C.includes("word")||C.includes("document")?"ðŸ“˜":C.includes("excel")||C.includes("spreadsheet")?"ðŸ“Š":"ðŸ“„":"ðŸ“„",E=C=>{if(!C)return"";const O=C/1024;return O<1024?`${O.toFixed(1)} KB`:`${(O/1024).toFixed(1)} MB`},z=C=>{if(C.name)return C.name;if(!C.url)return"Untitled Document";const F=C.url.replace(/^file:\/\//,"").split("/");return F[F.length-1]||"Untitled Document"},M=C=>{C.file_path?window.open(C.file_path,"_blank"):console.error("Document file path not available")},H=C=>{const O=`/custom/api/client_documents.php?action=download&document_id=${C.id}`;window.open(O,"_blank")},V={};return o.forEach(C=>{const O=C.category_id||"uncategorized";V[O]||(V[O]=[]),V[O].push(C)}),c?e.jsx("div",{className:"card-main",children:e.jsx("div",{className:"card-inner text-center py-8",children:e.jsx("div",{className:"text-gray-700",children:"Loading documents..."})})}):g?e.jsx("div",{className:"card-main",children:e.jsx("div",{className:"card-inner text-center py-8",children:e.jsxs("div",{className:"text-red-600",children:["Error loading documents: ",g]})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(le,{onClick:P,children:"ðŸ“¤ Upload Document"})}),o.length===0&&e.jsx("div",{className:"card-main",children:e.jsx("div",{className:"card-inner text-center py-8",children:e.jsx("div",{className:"text-gray-500",children:"No documents on file"})})}),i.map(C=>{const O=V[C.id]||[],F=m[C.id];return O.length===0?null:e.jsxs("div",{className:"card-main",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 cursor-pointer",onClick:()=>W(C.id),children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-800",children:[C.name," (",O.length,")"]}),e.jsx("button",{className:"text-gray-600 hover:text-gray-800 transition-colors",children:F?e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}):e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),F&&e.jsx("div",{className:"card-inner",children:e.jsx("div",{className:"space-y-3",children:O.map(D=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("span",{className:"text-2xl",children:A(D.mimetype)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:z(D)}),e.jsxs("div",{className:"text-sm text-gray-500",children:[D.date&&new Date(D.date).toLocaleDateString()," â€¢ ",E(D.size)]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>M(D),className:"px-3 py-1.5 text-sm font-medium text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-lg transition-colors",children:"View"}),e.jsx("button",{onClick:()=>H(D),className:"px-3 py-1.5 text-sm font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",children:"Download"})]})]},D.id))})})]},C.id)}),V.uncategorized&&V.uncategorized.length>0&&e.jsxs("div",{className:"card-main",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 cursor-pointer",onClick:()=>W("uncategorized"),children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-800",children:["Uncategorized (",V.uncategorized.length,")"]}),e.jsx("button",{className:"text-gray-600 hover:text-gray-800 transition-colors",children:m.uncategorized?e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}):e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),m.uncategorized&&e.jsx("div",{className:"card-inner",children:e.jsx("div",{className:"space-y-3",children:V.uncategorized.map(C=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("span",{className:"text-2xl",children:A(C.mimetype)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:z(C)}),e.jsxs("div",{className:"text-sm text-gray-500",children:[C.date&&new Date(C.date).toLocaleDateString()," â€¢ ",E(C.size)]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>M(C),className:"px-3 py-1.5 text-sm font-medium text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-lg transition-colors",children:"View"}),e.jsx("button",{onClick:()=>H(C),className:"px-3 py-1.5 text-sm font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",children:"Download"})]})]},C.id))})})]}),e.jsx(me,{isOpen:p,onClose:T,title:"Upload Document",size:"sm",children:e.jsxs("div",{className:"space-y-4",children:[f&&e.jsx(ne,{children:f}),e.jsxs("div",{children:[e.jsxs(X,{children:["Select File ",e.jsx(ie,{})]}),e.jsx("input",{type:"file",onChange:ee,className:"input-field"}),k&&e.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:["Selected: ",k.name," (",(k.size/1024).toFixed(1)," KB)"]})]}),e.jsxs("div",{children:[e.jsx(X,{children:"Document Name"}),e.jsx("input",{type:"text",value:y.name,onChange:C=>I("name",C.target.value),placeholder:"Enter document name",className:"input-field"}),e.jsx("div",{className:"mt-1 text-xs text-gray-500",children:"Leave blank to use filename"})]}),e.jsxs("div",{children:[e.jsx(X,{children:"Category (Optional)"}),e.jsxs("select",{value:y.category_id,onChange:C=>I("category_id",C.target.value),className:"input-field",children:[e.jsx("option",{value:"",children:"Select a category..."}),u.map(C=>e.jsx("option",{value:C.id,children:C.name},C.id))]})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"text-red-600",children:"*"})," Required"]}),e.jsxs(me.Footer,{children:[e.jsx(Ce,{onClick:T,disabled:v,children:"Cancel"}),e.jsx(le,{onClick:L,disabled:v||!k,children:v?"Uploading...":"Upload"})]})]})})]})}function Us(){const{id:s}=He(),o=_e(),{user:d,loading:i}=Pe(),[t,u]=x.useState(null),[a,m]=x.useState(null),[l,c]=x.useState("summary"),[b,g]=x.useState("clients"),[n,p]=x.useState(!0),[r,v]=x.useState(null),N=new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),f=async()=>{await Ve()},_=async()=>{try{p(!0),v(null),m(null),console.log("Fetching client data for ID:",s);const h=await De(s);console.log("Client data received:",h),h.accessDenied?(m(h.accessInfo),u(null)):u(h)}catch(h){console.error("Error fetching client data:",h),v(h.message||"Failed to load client data")}finally{p(!1)}};x.useEffect(()=>{s&&_()},[s]);const k=()=>{if(n)return e.jsx("div",{className:"card-main p-12 text-center",children:e.jsx("div",{className:"text-gray-700",children:"Loading client data..."})});if(a)return e.jsx("div",{className:"card-main p-8",children:e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6 max-w-2xl mx-auto",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:a.title||"Client Not on Your Caseload"}),e.jsx("p",{className:"text-blue-800 mb-4",children:a.message||"This client is not currently on your caseload. If you need access to work with this client, please contact your supervisor or an administrator to be added to their care team."}),e.jsxs("button",{onClick:()=>o("/app/clients"),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),a.actionText||"Return to Client List"]})]})]})})});if(r)return e.jsx("div",{className:"card-main p-12 text-center",children:e.jsxs(ce,{children:["Error: ",r]})});switch(l){case"summary":return e.jsx(ss,{data:t});case"demographics":return e.jsx(rs,{data:t,onDataUpdate:_});case"insurance":return e.jsx(Ts,{data:t});case"encounters":return e.jsx(Is,{data:t});case"clinical":return e.jsx(Ms,{data:t});case"documents":return e.jsx(Bs,{data:t});case"billing":return e.jsx(zs,{data:t});case"admin":return e.jsx(Fs,{data:t});default:return e.jsx(Te,{tabName:"This Tab"})}};return i||!d?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-mental",children:e.jsxs("div",{className:"backdrop-blur-2xl bg-white/90 rounded-3xl shadow-2xl p-8 border border-white/50",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-500 mx-auto"}),e.jsx("p",{className:"text-label mt-4 text-center",children:"Loading..."})]})}):e.jsxs(Ge,{user:d,activeNav:b,setActiveNav:g,today:N,onLogout:f,children:[e.jsx(Ke,{client:t?.patient}),e.jsx(Ze,{activeTab:l,onTabChange:c,permissions:t?.permissions||{}}),k()]})}export{Us as default};
