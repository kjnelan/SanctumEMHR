import{c as x,h as f,r as d,j as e,U as _}from"./index-DSJ8qQsI.js";const L=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],v=x("calendar",L);const A=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],F=x("circle-check-big",A);const $=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],T=x("clock",$);const U=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],b=x("file-text",U);const B=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],E=x("trending-up",B);const I=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],z=x("user-plus",I);async function H(r,p){console.log("ReportService: Fetching all reports from",r,"to",p);const t=new URLSearchParams({action:"all",start_date:r,end_date:p});return f(`/custom/api/reports.php?${t.toString()}`)}async function P(){return console.log("ReportService: Fetching demographic breakdown"),f("/custom/api/client_demographics.php")}function O(){const[r,p]=d.useState({age:[],gender:[],race:[],ethnicity:[]}),[t,w]=d.useState(null),[k,C]=d.useState(!0),[o,N]=d.useState(!0),[j,R]=d.useState("30"),S=()=>{const s=new Date().toISOString().split("T")[0];return{startDate:new Date(Date.now()-parseInt(j)*24*60*60*1e3).toISOString().split("T")[0],endDate:s}};d.useEffect(()=>{(async()=>{try{const l=await P();p(l)}catch(l){console.error("Failed to fetch demographics:",l)}finally{C(!1)}})()},[]),d.useEffect(()=>{(async()=>{try{N(!0);const{startDate:l,endDate:n}=S(),a=await H(l,n);w(a)}catch(l){console.error("Failed to fetch reports:",l)}finally{N(!1)}})()},[j]);const g=(s,l)=>{if(!s||s.length===0)return e.jsx("div",{className:"text-gray-500 text-sm text-center py-4",children:"No data available"});const n=s.reduce((a,c)=>a+c.count,0);return e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:l}),e.jsx("div",{className:"space-y-2",children:s.map((a,c)=>{const h=n>0?a.count/n*100:0;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-gray-600",children:a.category}),e.jsx("span",{className:"text-gray-500 font-semibold",children:a.count})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${h}%`}})})]},c)})})]})},y=(s,l,n,a="blue",c=null)=>{const h=s,i={blue:"bg-blue-50 text-blue-600",green:"bg-green-50 text-green-600",yellow:"bg-yellow-50 text-yellow-600",red:"bg-red-50 text-red-600",purple:"bg-purple-50 text-purple-600"};return e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${i[a]}`,children:e.jsx(h,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:n}),e.jsx("div",{className:"text-xs text-gray-500",children:l}),c&&e.jsx("div",{className:"text-xs text-gray-400",children:c})]})]})})},u=(s,l,n,a="blue")=>{if(!s||s.length===0)return e.jsx("div",{className:"text-gray-500 text-sm text-center py-4",children:"No data available"});const c=Math.max(...s.map(i=>i[n])),h={blue:"bg-blue-500",green:"bg-green-500",purple:"bg-purple-500",yellow:"bg-yellow-500"};return e.jsx("div",{className:"space-y-2",children:s.slice(0,8).map((i,D)=>{const M=c>0?i[n]/c*100:0;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-gray-600 truncate max-w-[70%]",children:i[l]}),e.jsx("span",{className:"text-gray-700 font-semibold",children:i[n]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`${h[a]} h-2 rounded-full transition-all duration-300`,style:{width:`${M}%`}})})]},D)})})},m=()=>e.jsx("div",{className:"space-y-3",children:[1,2,3,4].map(s=>e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-3 bg-gray-300 rounded w-20 mb-2"}),e.jsx("div",{className:"h-2 bg-gray-300 rounded"})]},s))});return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"card-main",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-1",children:"Reports"}),e.jsx("p",{className:"text-gray-600 text-xs",children:"Analytics and insights for your practice"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Date Range:"}),e.jsxs("select",{value:j,onChange:s=>R(s.target.value),className:"input-field py-1.5 px-3 text-sm w-auto",children:[e.jsx("option",{value:"7",children:"Last 7 days"}),e.jsx("option",{value:"30",children:"Last 30 days"}),e.jsx("option",{value:"90",children:"Last 90 days"}),e.jsx("option",{value:"180",children:"Last 6 months"}),e.jsx("option",{value:"365",children:"Last year"})]})]})]})}),!o&&t&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[y(v,"Appointments",t.appointments?.totals?.scheduled+t.appointments?.totals?.completed||0,"blue"),y(F,"Completed",t.appointments?.totals?.completed||0,"green"),y(b,"Notes Created",t.notes?.totals?.total||0,"purple"),y(z,"New Clients",t.clientFlow?.newClients||0,"yellow")]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card-main",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(v,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"text-sm font-bold text-gray-700",children:"Appointment Statistics"})]}),o?e.jsx(m,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-green-50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-xl font-bold text-green-700",children:t?.appointments?.totals?.completed||0}),e.jsx("div",{className:"text-xs text-green-600",children:"Completed"})]}),e.jsxs("div",{className:"bg-yellow-50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-xl font-bold text-yellow-700",children:t?.appointments?.totals?.scheduled||0}),e.jsx("div",{className:"text-xs text-yellow-600",children:"Scheduled"})]}),e.jsxs("div",{className:"bg-red-50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-xl font-bold text-red-700",children:t?.appointments?.totals?.noShow||0}),e.jsx("div",{className:"text-xs text-red-600",children:"No Shows"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-xl font-bold text-gray-700",children:t?.appointments?.totals?.cancelled||0}),e.jsx("div",{className:"text-xs text-gray-600",children:"Cancelled"})]})]}),t?.appointments?.byCategory?.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-600 mb-2 uppercase",children:"By Type"}),u(t.appointments.byCategory,"category","count","blue")]})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(b,{className:"w-5 h-5 text-purple-600"}),e.jsx("h3",{className:"text-sm font-bold text-gray-700",children:"Clinical Notes"})]}),o?e.jsx(m,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-purple-50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-xl font-bold text-purple-700",children:t?.notes?.totals?.total||0}),e.jsx("div",{className:"text-xs text-purple-600",children:"Total"})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-xl font-bold text-green-700",children:t?.notes?.totals?.signed||0}),e.jsx("div",{className:"text-xs text-green-600",children:"Signed"})]}),e.jsxs("div",{className:"bg-yellow-50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-xl font-bold text-yellow-700",children:t?.notes?.totals?.unsigned||0}),e.jsx("div",{className:"text-xs text-yellow-600",children:"Unsigned"})]})]}),t?.notes?.totals?.pendingReview>0&&e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3 flex items-center gap-3",children:[e.jsx(T,{className:"w-5 h-5 text-orange-600"}),e.jsx("div",{children:e.jsxs("div",{className:"text-sm font-medium text-orange-800",children:[t.notes.totals.pendingReview," notes pending supervisor review"]})})]}),t?.notes?.byType?.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-600 mb-2 uppercase",children:"By Type"}),u(t.notes.byType,"label","count","purple")]})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(E,{className:"w-5 h-5 text-green-600"}),e.jsx("h3",{className:"text-sm font-bold text-gray-700",children:"Provider Activity"})]}),o?e.jsx(m,{}):t?.productivity?.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-2 text-xs font-semibold text-gray-600",children:"Provider"}),e.jsx("th",{className:"text-center py-2 text-xs font-semibold text-gray-600",children:"Appts"}),e.jsx("th",{className:"text-center py-2 text-xs font-semibold text-gray-600",children:"Notes"}),e.jsx("th",{className:"text-center py-2 text-xs font-semibold text-gray-600",children:"Unsigned"})]})}),e.jsx("tbody",{children:t.productivity.slice(0,10).map((s,l)=>e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsxs("td",{className:"py-2",children:[e.jsx("div",{className:"font-medium text-gray-800",children:s.provider}),s.title&&e.jsx("div",{className:"text-xs text-gray-500",children:s.title})]}),e.jsx("td",{className:"text-center py-2",children:e.jsx("span",{className:"inline-flex items-center justify-center min-w-[2rem] px-2 py-0.5 bg-blue-100 text-blue-700 rounded-full text-xs font-medium",children:s.appointments})}),e.jsx("td",{className:"text-center py-2",children:e.jsx("span",{className:"inline-flex items-center justify-center min-w-[2rem] px-2 py-0.5 bg-purple-100 text-purple-700 rounded-full text-xs font-medium",children:s.notes})}),e.jsx("td",{className:"text-center py-2",children:s.unsignedNotes>0?e.jsx("span",{className:"inline-flex items-center justify-center min-w-[2rem] px-2 py-0.5 bg-yellow-100 text-yellow-700 rounded-full text-xs font-medium",children:s.unsignedNotes}):e.jsx("span",{className:"text-gray-400",children:"-"})})]},l))})]})}):e.jsx("div",{className:"text-gray-500 text-sm text-center py-4",children:"No provider data available"})]}),e.jsxs("div",{className:"card-main",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(_,{className:"w-5 h-5 text-yellow-600"}),e.jsx("h3",{className:"text-sm font-bold text-gray-700",children:"Client Activity"})]}),o?e.jsx(m,{}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-700",children:t?.clientFlow?.activeClients||0}),e.jsx("div",{className:"text-xs text-blue-600",children:"Active Clients"}),e.jsx("div",{className:"text-xs text-blue-400",children:"with activity in period"})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-700",children:t?.clientFlow?.newClients||0}),e.jsx("div",{className:"text-xs text-green-600",children:"New Clients"}),e.jsx("div",{className:"text-xs text-green-400",children:"added in period"})]})]}),t?.clientFlow?.byMonth?.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-600 mb-2 uppercase",children:"New Clients by Month"}),u(t.clientFlow.byMonth,"month","count","green")]})]})]})]}),e.jsxs("div",{className:"card-main",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-700 mb-4",children:"Active Client Demographics"}),k?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[1,2,3,4].map(s=>e.jsx(m,{},s))}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{children:g(r.age,"Age Range")}),e.jsx("div",{children:g(r.gender,"Gender")}),e.jsx("div",{children:g(r.race,"Race")}),e.jsx("div",{children:g(r.ethnicity,"Ethnicity")})]})]})]})}export{O as default};
